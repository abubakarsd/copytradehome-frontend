(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[44365,80939],{605678:(e,t,n)=>{"use strict";n.d(t,{DECEMBER:()=>E,FIRST_DAY_OF_WEEK:()=>f,FRIDAY:()=>d,JANUARY:()=>p,JULY:()=>g,LAST_DAY_OF_WEEK:()=>v,MARCH:()=>m,MAY:()=>_,MONDAY:()=>a,NOVEMBER:()=>b,SATURDAY:()=>h,SEPTEMBER:()=>T,SUNDAY:()=>r,THURSDAY:()=>c,TUESDAY:()=>u,WEDNESDAY:()=>l,add_date:()=>O,add_days_considering_dst:()=>A,add_minutes:()=>V,cal_to_utc:()=>G,clone:()=>B,days_per_year:()=>H,get_cal:()=>q,get_cal_from_unix_timestamp_ms:()=>z,get_cal_utc:()=>X,get_day_of_month:()=>C,get_day_of_week:()=>D,get_day_of_year:()=>k,get_days_in_month:()=>U,get_hours:()=>I,get_minutes:()=>L,get_minutes_from_midnight:()=>N,get_minutes_with_hours:()=>R,get_month:()=>w,get_timezone:()=>J,get_year:()=>P,is_leap_year:()=>W,millisecondsPerDay:()=>M,minutesPerDay:()=>S,minutesPerWeek:()=>y,set_hms:()=>x,set_seconds:()=>F,time_seconds:()=>Y,time_seconds_diff:()=>$,utc_to_cal:()=>K,utc_to_cal_ts:()=>j});var i=n(140482);const s={0:0,1:31,2:59,3:90,4:120,5:151,6:181,7:212,8:243,9:273,10:304,11:334};class o{constructor(e){this._invalid=!1,this._name=e;let t=i.tzData[e];!t&&Q&&(t=Q.instance().getTimezoneData(e)),t||(t={time:[],offset:[]},this._invalid=!0),t.time.length!==t.offset.length&&(t={time:[],offset:[]},this._invalid=!0);const n=t;if(!n.time_utc){const e=t.time,i=t.offset,s=e.length,o=new Array(s);for(let t=0;t<s;t++)e[t]*=1e3,i[t]*=1e3,o[t]=e[t]-i[t];n.time_utc=o}this.tz=n}offset_utc(e){return o.offset(this.tz.time_utc,this.tz.offset,e)}offset_loc(e){return o.offset(this.tz.time,this.tz.offset,e)}name(){return this._name}is_valid(){return!this._invalid}correction_loc(e){const t=this.tz.time,n=this.tz.offset,i=Z(t,e);if(i<1)return 0;const s=n[i]-n[i-1];if(s>0){if(e-t[i-1]<=s)return s}return 0}static offset(e,t,n){const i=Z(e,n);return-1===i?0:t[i]}}const r=1,a=2,u=3,l=4,c=5,d=6,h=7,f=r,v=h,p=0,m=2,_=4,g=6,T=8,b=10,E=11,S=1440,y=10080,M=864e5;function P(e){return e.getUTCFullYear()}function w(e){return e.getUTCMonth()}function I(e){return e.getUTCHours()}function L(e){return e.getUTCMinutes()}function C(e){return e.getUTCDate()}function D(e){return e.getUTCDay()+1}function k(e){const t=e.getUTCMonth();let n=s[t];return t>p+1&&W(e.getUTCFullYear())&&(n+=1),n+e.getUTCDate()}function N(e){return 60*I(e)+L(e)}function R(e){return N(e)}function x(e,t,n,i,s,o){e.setUTCHours(t),e.setUTCMinutes(n),e.setUTCSeconds(i),e.setUTCMilliseconds(s),void 0!==o&&function(e,t){const n=e.getTime(),i=t.correction_loc(n);e.setTime(n+i)}(e,o)}function A(e,t,n){const i=e.offset_utc(t.getTime()),s=B(t);O(s,n);const o=e.offset_utc(s.getTime());return s.setTime(s.getTime()+i-o),s}function O(e,t){e.setTime(e.getTime()+t*M)}function V(e,t){e.setTime(e.getTime()+60*t*1e3)}function F(e,t){const n=86400,i=t%n<0?-1:0,s=Math.trunc(t/n)+i,o=t-s*n,r=Math.trunc(o/3600),a=Math.trunc(o%3600/60);x(e,r,a,o-3600*r-60*a,0),O(e,s)}function B(e){return new Date(e.getTime())}function U(e,t){let n;switch(e){case 0:case 2:case 4:case 6:case 7:case 9:case 11:n=31;break;case 1:n=28,W(t)&&n++;break
;default:n=30}return n}function H(e){return W(e)?366:365}function W(e){return e%4==0&&(e%100!=0||e%400==0)}function Y(e){return 1e3*e}function $(e,t){return te(e)-te(t)}function K(e,t){return new Date(j(e,t))}function j(e,t){return t+e.offset_utc(t)}function q(e,t,n,i,s,o,r){const a=new Date(Date.UTC(t,n,i,s||0,o||0,r||0)),u=e.offset_utc(+a);return new Date(a.valueOf()-u)}function z(e,t){return new Date(t+e.offset_utc(t))}function X(e,t,n,i=0,s=0,o=0){return new Date(Date.UTC(e,t,n,i,s,o))}function G(e,t,n){let i=t.getTime();n&&(i+=e.correction_loc(i));return i-e.offset_loc(i)}function J(e){return new o(e)}let Q;function Z(e,t){const n=e.length;if(0===n)return-1;if(isNaN(t))throw Error("Key is NaN");let i=0,s=n-1,o=ee((i+s)/2);for(;;){if(e[o]>t){if(s=o-1,s<i)return o}else if(i=o+1,s<i)return o<n-1?o+1:-1;o=ee((i+s)/2)}}function ee(e){return Math.trunc(e)}function te(e){return e<0?ee(e/1e3)-(e%1e3!=0?1:0):ee(e/1e3)}},30706:(e,t,n)=>{"use strict";var i;function s(e){return"scriptTitle"in e&&"modified"in e}function o(e){return"userId"in e&&"scriptAccess"in e}function r(e){return"strategy"===e.kind}function a(e){return"library"===e.kind}n.d(t,{Severity:()=>i,isPubPineInfo:()=>o,isSavedPineInfo:()=>s,isScriptLibrary:()=>a,isScriptStrategy:()=>r}),function(e){e.ERROR="error",e.WARNING="warning"}(i||(i={}))},964798:(e,t,n)=>{"use strict";n.d(t,{convertScript:()=>T,deletePine:()=>D,getLastVersion:()=>R,getPineFacadeUrl:()=>r.getPineFacadeUrl,getPineSourceCode:()=>I,getVersions:()=>N,isAuthToGetPineSourceCode:()=>w,isAuthToWritePineScript:()=>P,isPubPineInfo:()=>d.isPubPineInfo,isSavedPineInfo:()=>d.isSavedPineInfo,isScriptLibrary:()=>d.isScriptLibrary,isScriptStrategy:()=>d.isScriptStrategy,parseScriptTitleAsync:()=>M,renamePine:()=>k,renameVersion:()=>x,requestBuiltinScripts:()=>C,requestUserScripts:()=>L,saveNew:()=>S,saveNewDraft:()=>E,saveNext:()=>y,saveNextDraft:()=>b,translateScriptAsync:()=>g,translateScriptAsync2:()=>_});var i=n(77357),s=n(858328),o=n(426554),r=n(786025),a=n(784438),u=n(676466),l=n(567613),c=n(972707),d=n(30706);n(141118);const h=(0,i.getLogger)("Chart.Study.Versioning"),f=new o.RequestCache,v=new o.RequestCache,p=new o.SingleRequestCache;(0,r.applyGlobalScriptListeners)(f,v,p);const m={};function _(e,t){const n=`${e}-${t}`;let i=m[n];return i||(i=async function(e,t){(0,s.trackEvent)("Pine","ScriptLib.translateScript");const n={},i=(0,a.isCustomPineId)(e);i||(n.user_name=(0,r.getUserName)());try{const i=await(0,l.pineFacadeFetch)({urlPath:`translate/${e}/${t}`,urlParams:n}),s=(0,r.handleTranslateResult)(i);(0,c.logPineMetaInfoIssues)("Pine.translateScriptAsync2",s.metaInfo);return+t<0&&(f.delete(e),v.delete(e),p.clear(),(0,r.onLegacyScriptProceed)(s.metaInfo)),s}catch(e){throw e}}(e,t).catch((e=>{throw delete m[n],e})),m[n]=i),i}async function g(e,t,n={},i=!1){return(0,s.trackEvent)("Pine","ScriptLib.translateScript"),(0,l.pineFacadeFetch)({method:"POST",urlPath:`translate_source/${t}`,urlParams:{is_pine_ex:i},data:{user_name:(0,r.getUserName)(),source:e,inputs:JSON.stringify(n)}}).then((e=>{
const t=(0,r.handleTranslateResult)(e);return(0,c.logPineMetaInfoIssues)("Pine.translateScriptAsync",t.metaInfo),t}))}function T(e,t){return(0,l.pineFacadeFetch)({method:"POST",urlPath:"convert",data:{source:e,version_to:String(t)}}).then((e=>{if(e.reason2?.errors.length)throw e.reason2;if(e.reason)throw e.reason;return(0,r.handleResult)(e)}))}function b(e,t,n,i=!1){if((0,s.trackEvent)("Pine","ScriptLib.saveNextDraft"),!t)return Promise.reject(u.EMPTY_SOURCE_CODE);(0,r.onModifyScriptActiveChanged)(e,n,!0);const o=(0,l.pineFacadeFetch)({method:"POST",urlPath:`save/next_draft/${e}`,urlParams:{user_name:(0,r.getUserName)(),allow_create_new:i},data:{source:t}}).then((e=>{const t=(0,r.handleSaveResult)(e);return(0,c.logPineMetaInfoIssues)("Pine.saveNextDraft",t.metaInfo),t}));return o.finally((()=>(0,r.onModifyScriptActiveChanged)(e,n,!1))),o}function E(e){return(0,s.trackEvent)("Pine","ScriptLib.saveNewDraft"),e?(0,l.pineFacadeFetch)({method:"POST",urlPath:"save/new_draft",urlParams:{user_name:(0,r.getUserName)(),allow_use_existing_draft:!0},data:{source:e}}).then((e=>{const t=(0,r.handleSaveResult)(e);return(0,c.logPineMetaInfoIssues)("Pine.saveNewDraft",t.metaInfo),t})):Promise.reject(u.EMPTY_SOURCE_CODE)}function S({scriptSource:e,scriptName:t,allowOverwrite:n,currentVersion:i}){if((0,s.trackEvent)("Pine","ScriptLib.saveNew"),!e)return Promise.reject(u.EMPTY_SOURCE_CODE);const o={name:t,user_name:(0,r.getUserName)()};return n&&(o.allow_overwrite=!0),(0,l.pineFacadeFetch)({method:"POST",urlPath:"save/new",urlParams:o,data:{source:e}}).then((e=>{p.clear();const t=(0,r.handleSaveResult)(e);return(0,c.logPineMetaInfoIssues)("Pine.saveNew",t.metaInfo),(0,r.onModifyScript)(t.metaInfo,i,!t.success,t.compileErrors.errors),t}))}function y({scriptIdPart:e,scriptSource:t,currScriptVersion:n,isLegacyScript:i,scriptName:o}){if((0,s.trackEvent)("Pine","ScriptLib.saveNext"),!t)return Promise.reject(u.EMPTY_SOURCE_CODE);const a={user_name:(0,r.getUserName)(),allow_create_new:i},d={source:t};return void 0!==o&&(a.name=o),(0,r.onModifyScriptActiveChanged)(e,n,!0),(0,l.pineFacadeFetch)({method:"POST",urlPath:`save/next/${e}`,urlParams:a,data:d}).then((e=>{p.clear();const t=(0,r.handleSaveResult)(e);return(0,c.logPineMetaInfoIssues)("Pine.saveNext",t.metaInfo),(0,r.onModifyScript)(t.metaInfo,n,!t.success,t.compileErrors.errors),t})).finally((()=>(0,r.onModifyScriptActiveChanged)(e,n,!1)))}function M(e){return(0,s.trackEvent)("Pine","ScriptLib.parseScriptTitle"),e?(0,l.pineFacadeFetch)({method:"POST",urlPath:"parse_title",data:{user_name:(0,r.getUserName)(),source:e}}).then((e=>(0,r.handleResult)(e))):Promise.reject(u.EMPTY_SOURCE_CODE)}function P(e){if((0,a.isCustomPineId)(e))return Promise.resolve(!0);const t=v.get(e);if(t)return t;(0,s.trackEvent)("Pine","ScriptLib.isAuthToWritePineScript");const n=(0,l.pineFacadeFetch)({urlPath:`is_auth_to_write/${e}`});return v.set(e,n),n}function w(e,t){const n=f.get(e);if(n)return n;(0,s.trackEvent)("Pine","ScriptLib.isAuthToGetPineSourceCode");const i=(0,l.pineFacadeFetch)({
urlPath:`is_auth_to_get/${e}/${t}`});return f.set(e,i),i}function I(e,t,n){return(0,s.trackEvent)("Pine","ScriptLib.getPineSourceCode"),(0,l.pineFacadeFetch)({urlPath:`get/${e}/${t}`,urlParams:{no_4xx:n}})}function L(){if((0,s.trackEvent)("Pine","ScriptLib.requestUserScripts"),!window.is_authenticated)return Promise.resolve([]);const e=p.get();if(e)return e;const t=(0,l.pineFacadeFetch)({urlPath:"list",urlParams:{filter:"saved"}});return p.reset(t),t}async function C(){(0,s.trackEvent)("Pine","ScriptLib.requestBuiltinScripts");try{h.logNormal("Request built-in scripts");const e=await(0,l.pineFacadeFetch)({urlPath:"list",urlParams:{filter:"standard"}});return h.logNormal("Request built-in scripts finished"),e}catch(e){throw h.logWarn("Request built-in scripts finished with fail"),e}}function D(e){return(0,s.trackEvent)("Pine","ScriptLib.deletePine"),(0,l.pineFacadeFetch)({method:"POST",urlPath:`delete/${e}`,urlParams:{user_name:(0,r.getUserName)()}}).then((t=>(f.delete(e),v.delete(e),p.clear(),(0,r.onDeleteScript)(e),t)))}function k(e,t,n=!1){return(0,s.trackEvent)("Pine","ScriptLib.renamePine"),(0,l.pineFacadeFetch)({method:"POST",urlPath:`rename/${t}`,urlParams:{name:e,user_name:(0,r.getUserName)(),force:n}}).then((n=>(p.clear(),(0,r.onRenameScript)(t,e),n)))}async function N(e,t){(0,s.trackEvent)("Pine","ScriptLib.getVersions");try{h.logNormal("Request script versions");return await(0,l.pineFacadeFetch)({method:"GET",urlPath:`versions/${e}`,urlParams:{limit:t?String(t):void 0}})}catch(e){return h.logWarn("Request script versions finished with fail"),[]}}async function R(e){(0,s.trackEvent)("Pine","ScriptLib.getLastVersions");try{h.logNormal("Request the last script versions");return(await(0,l.pineFacadeFetch)({method:"GET",urlPath:`versions/${e}/last`}))[0]??null}catch(e){return h.logWarn("Request script versions finished with fail"),null}}async function x(e,t,n){try{h.logNormal(`Rename script version ${t}`);return await(0,l.pineFacadeFetch)({method:"PUT",urlPath:`name/${e}/${t}`,urlParams:{name:n??""}})}catch(e){return h.logWarn("Rename script version finished with fail"),null}}},835228:(e,t,n)=>{"use strict";n.d(t,{hasService:()=>u,registerService:()=>r,service:()=>l,unregisterService:()=>a,waitServiceRegistered:()=>c});var i=n(222993);const s={},o=new Map;function r(e,t){if(u(e))throw new Error("Service already registered");s[e.id]=t;const n=o.get(e.id);void 0!==n&&(o.delete(e.id),n.resolve(t))}function a(e){if(!u(e))throw new Error("Service not found");s[e.id]=void 0}function u(e){return void 0!==s[e.id]}function l(e){const t=s[e.id];if(void 0===t)throw new Error("ServiceLocator: Service "+e.id+" not found");return t}function c(e){if(u(e))return Promise.resolve(l(e));let t=o.get(e.id);return void 0===t&&(t=(0,i.createDeferredPromise)(),o.set(e.id,t)),t.promise}},106401:(e,t,n)=>{"use strict";n.d(t,{canShowNewSymbolSearch:()=>u,getCurrentLocaleInfoCountry:()=>l,isMobile:()=>r,isPlatformMobile:()=>a});var i=n(702203),s=n(266150),o=n(376596);function r(){
const e=window.matchMedia("(min-width: 602px) and (min-height: 445px)").matches;return o.CheckMobile.any()&&!e}function a(){return!(0,i.isOnMobileAppPage)("any")&&r()}function u(){return!(0,s.isFeaturesetEnabled)("widget")&&!(0,i.isOnMobileAppPage)("any")}function l(){return window.initData?.currentLocaleInfo?.flag.toUpperCase()}},371757:(e,t,n)=>{"use strict";n.d(t,{MINDS_GROUP_PATH_PATTERN:()=>i,createMindsPath:()=>s});const i="/minds/groups/:symbol/";function s(e,t,n){let s=i.replace(":symbol",encodeURIComponent(e));if(!t)return s;const o=new URLSearchParams;return o.set("mind",t),n&&o.set("editable","true"),s+=`?${o.toString()}`,s}},992552:(e,t,n)=>{"use strict";n.d(t,{getHideOptions:()=>d,getSavedHideMode:()=>v,toggleHideMode:()=>f,toggleHideOptions:()=>h});var i=n(185842),s=n(486075),o=n(729193),r=n(950808),a=n(49833),u=n(20686);let l=null;function c(e,t){let n=!1;return()=>{if(n)return;n=!0;const s=v(),o=function(e){if("all"===e)return p();const t=(0,i.ensureDefined)(d().get(e)),n=(0,i.ensureDefined)(t.getBoxedValue)().value();return t.inverted?!n:n}(e);if("all"===s||s===e){if("all"===s)for(const e of(0,i.ensureNotNull)(l).values())e!==t&&e.getBoxedValue&&e.getBoxedValue().setValue(e.inverted?!o:o);u.hideStateChange.fire({hideMode:s,isActive:o})}n=!1}}function d(){if(null!==l)return l;const e={label:o.t(null,void 0,n(157210)),dataName:"hide-drawing-tools",tooltip:{active:o.t(null,void 0,n(649373)),inactive:o.t(null,void 0,n(809939))},getBoxedValue:()=>(0,a.hideAllDrawings)(),trackLabel:"hide drawings"},t={label:o.t(null,void 0,n(807880)),dataName:"hide-indicators",tooltip:{active:o.t(null,void 0,n(206379)),inactive:o.t(null,void 0,n(539349))},getBoxedValue:()=>(0,a.hideAllIndicators)(),trackLabel:"hide indicators"};l=new Map([["drawings",e],["indicators",t]]),(0,a.hideAllDrawings)().subscribe(null,c("drawings",e)),(0,a.hideAllIndicators)().subscribe(null,c("indicators",t));const i=(0,s.tradingService)();if(i){const e={label:o.t(null,void 0,n(472017)),dataName:"hide-positions-and-orders",tooltip:{active:o.t(null,void 0,n(270887)),inactive:o.t(null,void 0,n(943485))},getBoxedValue:()=>i.showTradedSources,inverted:!0,trackLabel:"hide positions"};l.set("positions",e),i.showTradedSources.subscribe(c("positions",e))}const r={label:o.t(null,void 0,n(824993)),dataName:"hide-all",tooltip:{active:i?o.t(null,void 0,n(154100)):o.t(null,void 0,n(818763)),inactive:i?o.t(null,void 0,n(46854)):o.t(null,void 0,n(800349))},trackLabel:"hide all"};return l.set("all",r),l}function h(e){m(((t,n,i)=>{const s=i.getBoxedValue?.();s&&s.setValue(i.inverted?!e:e)}))}function f(e){e?r.setValue("ChartToolsHideMode",e):e=v();const t=p();let n=!t;return"all"===e?(m(((e,t,i)=>{e.setValue(i.inverted?!n:n)})),u.hideStateChange.fire({hideMode:e,isActive:n}),n):(m(((i,s,o)=>{const r=o.inverted;if(s===e){const e=t?!r:!i.value();i.setValue(e),n=r?!e:e}else i.setValue(Boolean(r))})),u.hideStateChange.fire({hideMode:e,isActive:n}),n)}function v(){const e=r.getValue("ChartToolsHideMode","drawings");return d().has(e)?e:"drawings"}function p(){let e=!0
;return m(((t,n,i)=>{const s=t.value();e=e&&(i.inverted?!s:s)})),e}function m(e){d().forEach(((t,n)=>{const i=t.getBoxedValue?.();i&&e(i,n,t)}))}},495841:(e,t,n)=>{"use strict";n.d(t,{getChartTimezoneOffsetMs:()=>o,getChartTimezoneOffsetSec:()=>r,getTimezoneName:()=>s});var i=n(605678);function s(e){const t=e.model().timezone();if("exchange"!==t)return t;const n=e.model().mainSeries().symbolInfo();return n?.timezone}function o(e,t){if(void 0===t)return 0;return(0,i.get_timezone)(t).offset_utc(e)}function r(e,t){return o(1e3*e,t)/1e3}},765732:(e,t,n)=>{"use strict";n.d(t,{getChartWidgetApiTimeConverter:()=>u});var i=n(185842),s=n(266150),o=n(892772);const r=(0,s.isFeaturesetEnabled)("end_of_period_timescale_marks"),a=(0,s.isFeaturesetEnabled)("secondary_series_extend_time_scale");function u(e,t,n){return new c(function(e,t){const n=function(e,t){return e+t.session+t.timezone+(t.corrections||"")+(t.session_holidays||"")}(e,t);let i=l.get(n);void 0===i&&(i=(0,o.createDwmAligner)(e,t),l.set(n,i));return i}(e,t),n)}const l=new Map;class c{constructor(e,t){this._dwmAligner=e,this._chartModel=t}convertPublicTimeToInternalTime(e){return null!==this._dwmAligner?this._dwmAligner.timeToSessionStart(1e3*e)/1e3:e}convertInternalTimeToPublicTime(e){return null!==this._dwmAligner?this._dwmAligner.timeToExchangeTradingDay(1e3*e)/1e3:e}convertTimePointIndexToPublicTime(e){const t=this._chartModel.timeScale();if(t.isEmpty())return null;let n=r?function(e,t){const n=e.indexToUserTime(t);if(null===n)return null;return n.getTime()/1e3}(t,e):this.convertTimePointIndexToInternalTime(e);if(null!==n){const t=this._chartModel.mainSeries().bars(),i=t.contains(e),s=t.firstIndex(),o=t.lastIndex();!i&&(null!==s&&null!==o&&s<=e&&e<=o)&&a||(n=this.convertInternalTimeToPublicTime(n))}return n}convertTimePointIndexToInternalTime(e){const t=this._chartModel.timeScale();if(t.isEmpty())return null;const n=t.points(),{firstIndex:s,lastIndex:o}=(0,i.ensureNotNull)(n.range().value());let r=null;if(s<=e&&e<=o)r=n.valueAt(e);else if(e>o){const n=this._chartModel.mainSeries().syncModel();if(null!==n){const s=(0,i.ensureNotNull)(t.indexToTimePoint(o));r=n.projectTime(s,e-o)}}return r}}},725318:(e,t,n)=>{"use strict";n.r(t),n.d(t,{MouseEventHandler:()=>m,defaultPreventedHandler:()=>v,getClickPosition:()=>h,ignoreClickOrTapOnDblClickOrDblTapHandlers:()=>p,isTouchMouseEvent:()=>f});var i=n(578519),s=n(185842),o=n(385955),r=n(376596),a=n(789810),u=n(980002);let l=2;const c=r.isSafari?"click":"auxclick",d={treatVertTouchDragAsPageScroll:!1,treatHorzTouchDragAsPageScroll:!1,ignoreClickAndTapOnDblClickOrDblTap:!1};function h(e){if(f(e))return{x:e.clientX,y:e.clientY};if("touches"in(t=e)&&void 0!==t.touches){if(1===e.touches.length){const t=(0,s.ensureNotNull)(e.target).getBoundingClientRect(),n=e.touches[0];return{x:n.clientX-t.left,y:n.clientY-t.top}}return null}var t;return{x:e.offsetX,y:e.offsetY}}function f(e){return"isTouch"in e&&"stylus"in e}function v(e){return t=>{t.preventDefault(),e(t)}}function p(e,t){let n=!1;return{clickOrTap:(...i)=>{
t?.()?e.clickOrTap(...i):(n=!1,setTimeout((()=>!n&&e.clickOrTap(...i)),501))},doubleClickOrDoubleTap:(...t)=>{n=!0,e.doubleClickOrDoubleTap?.(...t)}}}class m{constructor(e,t,n){if(this._clickCount=0,this._clickTimeoutId=null,this._clickPosition={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY},this._tapCount=0,this._tapTimeoutId=null,this._tapPosition={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY},this._longTapTimeoutId=null,this._longTapActive=!1,this._mouseMoveStartPosition=null,this._touchMoveStartPosition=null,this._touchMoveExceededManhattanDistance=!1,this._cancelClick=!1,this._cancelTap=!1,this._unsubscribeOutsideMouseEvents=null,this._unsubscribeOutsideTouchEvents=null,this._unsubscribeMobileSafariEvents=null,this._unsubscribeMousemove=null,this._unsubscribeRootMouseEvents=null,this._unsubscribeRootTouchEvents=null,this._unsubscribePinchEvents=null,this._unsubscribeTargetElementEvents=null,this._pinchInfo=null,this._pinchPrevented=!1,this._preventTouchDragProcess=!1,this._mousePressed=!1,this._lastTouchEventTimeStamp=0,this._activeTouchId=null,this._acceptMouseLeave=!r.CheckMobile.iOS(),this._onFirefoxOutsideMouseUp=e=>{this._mouseUpHandler(e)},this._onMobileSafariDoubleClick=e=>{if(this._firesTouchEvents(e)){const t=this._makeCompatEvent(e);if(++this._tapCount,this._tapTimeoutId&&this._tapCount>1){const{manhattanDistance:n}=this._touchMouseMoveWithDownInfo(g(e),this._tapPosition);n<30&&!this._cancelTap&&this._processTouchEvent(t,this._handlers.doubleTapEvent),this._resetTapTimeout()}}else{const t=this._makeCompatEvent(e);if(++this._clickCount,this._clickTimeoutId&&this._clickCount>1){const{manhattanDistance:n}=this._touchMouseMoveWithDownInfo(g(e),this._clickPosition);n<5&&!this._cancelClick&&this._processMouseEvent(t,this._handlers.mouseDoubleClickEvent),this._resetClickTimeout()}}},this._target=e,this._options=(0,o.merge)((0,o.clone)(d),n||{}),this._options.ignoreClickAndTapOnDblClickOrDblTap){if(t.mouseClickEvent&&t.mouseDoubleClickEvent){const e=p({clickOrTap:t.mouseClickEvent.bind(t),doubleClickOrDoubleTap:t.mouseDoubleClickEvent.bind(t)});t.mouseClickEvent=e.clickOrTap,t.mouseDoubleClickEvent=e.doubleClickOrDoubleTap}if(t.tapEvent&&t.doubleTapEvent){const e=p({clickOrTap:t.tapEvent.bind(t),doubleClickOrDoubleTap:t.doubleTapEvent.bind(t)});t.tapEvent=e.clickOrTap,t.doubleTapEvent=e.doubleClickOrDoubleTap}}this._handlers=t,this._init()}destroy(){null!==this._unsubscribeOutsideMouseEvents&&(this._unsubscribeOutsideMouseEvents(),this._unsubscribeOutsideMouseEvents=null),null!==this._unsubscribeOutsideTouchEvents&&(this._unsubscribeOutsideTouchEvents(),this._unsubscribeOutsideTouchEvents=null),null!==this._unsubscribeMousemove&&(this._unsubscribeMousemove(),this._unsubscribeMousemove=null),null!==this._unsubscribeRootMouseEvents&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null),null!==this._unsubscribeRootTouchEvents&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null),
null!==this._unsubscribeMobileSafariEvents&&(this._unsubscribeMobileSafariEvents(),this._unsubscribeMobileSafariEvents=null),null!==this._unsubscribePinchEvents&&(this._unsubscribePinchEvents(),this._unsubscribePinchEvents=null),null!==this._unsubscribeTargetElementEvents&&(this._unsubscribeTargetElementEvents(),this._unsubscribeTargetElementEvents=null),this._clearLongTapTimeout(),this._resetClickTimeout()}_mouseEnterHandler(e){this._unsubscribeMousemove&&this._unsubscribeMousemove();const t=this._mouseMoveHandler.bind(this);if(this._unsubscribeMousemove=()=>{this._target.removeEventListener("mousemove",t)},this._target.addEventListener("mousemove",t),this._firesTouchEvents(e))return;const n=this._makeCompatEvent(e);this._processMouseEvent(n,this._handlers.mouseEnterEvent),this._acceptMouseLeave=!0}_resetClickTimeout(){null!==this._clickTimeoutId&&clearTimeout(this._clickTimeoutId),this._clickCount=0,this._clickTimeoutId=null,this._clickPosition={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY}}_resetTapTimeout(){null!==this._tapTimeoutId&&clearTimeout(this._tapTimeoutId),this._tapCount=0,this._tapTimeoutId=null,this._tapPosition={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY}}_mouseMoveHandler(e){if(this._mousePressed||null!==this._touchMoveStartPosition)return;if(this._firesTouchEvents(e))return;const t=this._makeCompatEvent(e);this._processMouseEvent(t,this._handlers.mouseMoveEvent),this._acceptMouseLeave=!0}_touchMoveHandler(e){const t=E(e.changedTouches,(0,s.ensureNotNull)(this._activeTouchId));if(null===t)return;if(this._lastTouchEventTimeStamp=b(e),null!==this._pinchInfo)return;if(this._preventTouchDragProcess)return;this._pinchPrevented=!0;const n=this._touchMouseMoveWithDownInfo(g(t),(0,s.ensureNotNull)(this._touchMoveStartPosition)),{xOffset:i,yOffset:o,manhattanDistance:r}=n;if(this._touchMoveExceededManhattanDistance||!(r<5)){if(!this._touchMoveExceededManhattanDistance){const e=.5*i,t=this._options.shouldAllowTouchDrag?.()??!1,n=o>=e&&(!this._options.treatVertTouchDragAsPageScroll||t),s=e>o&&(!this._options.treatHorzTouchDragAsPageScroll||t);n||s||(this._preventTouchDragProcess=!0),this._touchMoveExceededManhattanDistance=!0,this._cancelTap=!0,this._clearLongTapTimeout(),this._resetTapTimeout()}if(!this._preventTouchDragProcess){const n=this._makeCompatEvent(e,t);this._processTouchEvent(n,this._handlers.touchMoveEvent),(0,a.preventDefault)(e)}}}_mouseMoveWithDownHandler(e){if(0!==e.button)return;const t=this._touchMouseMoveWithDownInfo(g(e),(0,s.ensureNotNull)(this._mouseMoveStartPosition)),{manhattanDistance:n}=t;if(n>=5&&(this._cancelClick=!0,this._resetClickTimeout()),this._cancelClick){const t=this._makeCompatEvent(e);this._processMouseEvent(t,this._handlers.pressedMouseMoveEvent)}}_touchMouseMoveWithDownInfo(e,t){const n=Math.abs(t.x-e.x),i=Math.abs(t.y-e.y);return{xOffset:n,yOffset:i,manhattanDistance:n+i}}_touchEndHandler(e){let t=E(e.changedTouches,(0,s.ensureNotNull)(this._activeTouchId));if(null===t&&0===e.touches.length&&(t=e.changedTouches[0]),null===t)return
;this._activeTouchId=null,this._lastTouchEventTimeStamp=b(e),this._clearLongTapTimeout(),this._touchMoveStartPosition=null,this._unsubscribeRootTouchEvents&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null);const n=this._makeCompatEvent(e,t);if(this._processTouchEvent(n,this._handlers.touchEndEvent),++this._tapCount,this._tapTimeoutId&&this._tapCount>1){const{manhattanDistance:e}=this._touchMouseMoveWithDownInfo(g(t),this._tapPosition);e<30&&!this._cancelTap&&this._processTouchEvent(n,this._handlers.doubleTapEvent),this._resetTapTimeout()}else this._cancelTap||(this._processTouchEvent(n,this._handlers.tapEvent),this._handlers.tapEvent&&(0,a.preventDefault)(e));0===this._tapCount&&(0,a.preventDefault)(e),0===e.touches.length&&this._longTapActive&&(this._longTapActive=!1,(0,a.preventDefault)(e))}_touchCancelHandler(e){this._touchEndHandler(e)}_mouseUpHandler(e){if(0!==e.button)return;const t=this._makeCompatEvent(e);if(this._mouseMoveStartPosition=null,this._mousePressed=!1,this._unsubscribeRootMouseEvents&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null),r.isFF){this._target.ownerDocument.documentElement.removeEventListener("mouseleave",this._onFirefoxOutsideMouseUp)}if(!this._firesTouchEvents(e))if(this._processMouseEvent(t,this._handlers.mouseUpEvent),++this._clickCount,this._clickTimeoutId&&this._clickCount>1){const{manhattanDistance:n}=this._touchMouseMoveWithDownInfo(g(e),this._clickPosition);n<5&&!this._cancelClick&&this._processMouseEvent(t,this._handlers.mouseDoubleClickEvent),this._resetClickTimeout()}else this._cancelClick||this._processMouseEvent(t,this._handlers.mouseClickEvent)}_clearLongTapTimeout(){null!==this._longTapTimeoutId&&(clearTimeout(this._longTapTimeoutId),this._longTapTimeoutId=null)}_touchStartHandler(e){if(null!==this._activeTouchId)return this._clearLongTapTimeout(),void this._resetTapTimeout();const t=e.changedTouches[0];this._activeTouchId=t.identifier,this._lastTouchEventTimeStamp=b(e);const n=this._target.ownerDocument.documentElement;this._cancelTap=!1,this._touchMoveExceededManhattanDistance=!1,this._preventTouchDragProcess=!1,this._touchMoveStartPosition=g(t),this._unsubscribeRootTouchEvents&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null);{const t=this._touchMoveHandler.bind(this),i=this._touchEndHandler.bind(this);this._unsubscribeRootTouchEvents=()=>{n.removeEventListener("touchmove",t),n.removeEventListener("touchend",i)},n.addEventListener("touchmove",t,{passive:!1}),n.addEventListener("touchend",i,{passive:!1}),this._clearLongTapTimeout(),this._longTapTimeoutId=setTimeout(this._longTapHandler.bind(this,e),333)}const i=this._makeCompatEvent(e,t);this._processTouchEvent(i,this._handlers.touchStartEvent),this._tapTimeoutId||(this._tapCount=0,this._tapTimeoutId=setTimeout(this._resetTapTimeout.bind(this),500),this._tapPosition=g(t))}_wheelClickHandler(e){if(1!==e.button)return;if(this._firesTouchEvents(e))return;const t=this._makeCompatEvent(e);this._processMouseEvent(t,this._handlers.wheelClickEvent)}
_mouseDownHandler(e){if(0!==e.button)return;const t=this._target.ownerDocument.documentElement;r.isFF&&t.addEventListener("mouseleave",this._onFirefoxOutsideMouseUp),this._cancelClick=!1,this._mouseMoveStartPosition=g(e),this._unsubscribeRootMouseEvents&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null);{const e=this._mouseMoveWithDownHandler.bind(this),n=this._mouseUpHandler.bind(this);this._unsubscribeRootMouseEvents=()=>{t.removeEventListener("mousemove",e),t.removeEventListener("mouseup",n)},t.addEventListener("mousemove",e),t.addEventListener("mouseup",n)}if(this._mousePressed=!0,this._firesTouchEvents(e))return;const n=this._makeCompatEvent(e);this._processMouseEvent(n,this._handlers.mouseDownEvent),this._clickTimeoutId||(this._clickCount=0,this._clickTimeoutId=setTimeout(this._resetClickTimeout.bind(this),500),this._clickPosition=g(e))}_init(){const e=this._mouseEnterHandler.bind(this);this._target.addEventListener("mouseenter",e);const t=this._touchCancelHandler.bind(this);this._target.addEventListener("touchcancel",t);{const e=this._target.ownerDocument,t=e=>!e.target||!this._target.contains(e.target),n=e=>{if(!t(e))return;const n=e.changedTouches[0];this._lastTouchEventTimeStamp=b(e),this._processTouchEvent(this._makeCompatEvent(e,n),this._handlers.touchStartOutsideEvent)},i=e=>{t(e)&&!this._firesTouchEvents(e)&&this._processMouseEvent(this._makeCompatEvent(e),this._handlers.mouseDownOutsideEvent)};this._unsubscribeOutsideTouchEvents=()=>{e.removeEventListener("touchstart",n)},this._unsubscribeOutsideMouseEvents=()=>{e.removeEventListener("mousedown",i)},e.addEventListener("mousedown",i),e.addEventListener("touchstart",n,{passive:!0})}r.CheckMobile.iOS()&&(this._unsubscribeMobileSafariEvents=()=>{this._target.removeEventListener("dblclick",this._onMobileSafariDoubleClick)},this._target.addEventListener("dblclick",this._onMobileSafariDoubleClick));const n=this._mouseLeaveHandler.bind(this);this._target.addEventListener("mouseleave",n);const i=this._contextMenuHandler.bind(this);this._target.addEventListener("contextmenu",i);const s=this._touchStartHandler.bind(this);let o;this._target.addEventListener("touchstart",s,{passive:!0}),r.isChrome&&(o=e=>{if(1===e.button)return e.preventDefault(),!1},this._target.addEventListener("mousedown",o));const a=this._mouseDownHandler.bind(this);this._target.addEventListener("mousedown",a);const u=this._wheelClickHandler.bind(this);this._target.addEventListener(c,u);const l=()=>{};this._target.addEventListener("touchmove",l,{passive:!1}),this._unsubscribeTargetElementEvents=()=>{this._target.removeEventListener("mouseleave",n),this._target.removeEventListener("contextmenu",i),this._target.removeEventListener("touchstart",s),o&&this._target.removeEventListener("mousedown",o),this._target.removeEventListener("mousedown",a),this._target.removeEventListener(c,u),this._target.removeEventListener("touchmove",l)},this._initPinch()}_initPinch(){
if(void 0===this._handlers.pinchStartEvent&&void 0===this._handlers.pinchEvent&&void 0===this._handlers.pinchEndEvent)return;const e=e=>this._checkPinchState(e.touches);this._target.addEventListener("touchstart",e,{passive:!0});const t=e=>{if(null===this._pinchInfo)return;const t=E(e.touches,(0,s.ensureNotNull)(this._activeTouchId)),n=E(e.touches,this._pinchInfo.secondTouchId);if(t&&n&&void 0!==this._handlers.pinchEvent){const{startPinchDistance:i,startPinchMiddlePoint:s}=this._pinchInfo,o=T(t,n)/i,r=_(this._target);this._handlers.pinchEvent(s,{x:t.clientX-r.left,y:t.clientY-r.top},{x:n.clientX-r.left,y:n.clientY-r.top},o),(0,a.preventDefault)(e)}};this._target.addEventListener("touchmove",t,{passive:!1});const n=e=>this._checkPinchState(e.touches);this._target.addEventListener("touchend",n),this._unsubscribePinchEvents=()=>{this._target.removeEventListener("touchstart",e),this._target.removeEventListener("touchmove",t),this._target.addEventListener("touchend",n)}}_checkPinchState(e){1===e.length&&(this._pinchPrevented=!1),2!==e.length||this._pinchPrevented||this._longTapActive?this._stopPinch():this._startPinch(e)}_startPinch(e){if(void 0!==this._handlers.pinchStartEvent&&null===this._pinchInfo){const t=_(this._target);let n,i;e[0].identifier===this._activeTouchId?(n=e[0],i=e[1]):(n=e[1],i=e[0]);const s={x:n.clientX-t.left,y:n.clientY-t.top},o={x:i.clientX-t.left,y:i.clientY-t.top},r={x:(s.x+o.x)/2,y:(s.y+o.y)/2};this._handlers.pinchStartEvent(r,s,o,{bothPointsOnTargetElement:this._target.contains(i.target)})&&(this._pinchInfo={startPinchDistance:T(n,i),startPinchMiddlePoint:r,secondTouchId:i.identifier})}this._clearLongTapTimeout()}_stopPinch(){null!==this._pinchInfo&&(this._pinchInfo=null,this._handlers.pinchEndEvent?.())}_mouseLeaveHandler(e){if(this._unsubscribeMousemove&&this._unsubscribeMousemove(),this._firesTouchEvents(e))return;if(!this._acceptMouseLeave)return;const t=this._makeCompatEvent(e);this._processMouseEvent(t,this._handlers.mouseLeaveEvent),this._acceptMouseLeave=!r.CheckMobile.iOS()}_longTapHandler(e){const t=E(e.touches,(0,s.ensureNotNull)(this._activeTouchId));if(null===t)return;const n=this._makeCompatEvent(e,t);this._processTouchEvent(n,this._handlers.longTapEvent),this._processTouchEvent(n,this._handlers.touchContextMenuEvent),this._cancelTap=!0,this._longTapActive=!0}_contextMenuHandler(e){if((0,a.preventDefault)(e),null!==this._touchMoveStartPosition)return;if(this._firesTouchEvents(e))return;const t=this._makeCompatEvent(e);this._processMouseEvent(t,this._handlers.contextMenuEvent),this._cancelClick=!0}_firesTouchEvents(e){return e.sourceCapabilities&&void 0!==e.sourceCapabilities.firesTouchEvents?e.sourceCapabilities.firesTouchEvents:b(e)<this._lastTouchEventTimeStamp+500}_processTouchEvent(e,t){(0,u.setLastMouseOrTouchEventInfo)(e),t&&t.call(this._handlers,e)}_processMouseEvent(e,t){window.TVD&&("mouseenter"===e.srcType||"mousemove"===e.srcType)&&l>0?l--:("mouseleave"!==e.srcType&&(0,u.setLastMouseOrTouchEventInfo)(e),t&&t.call(this._handlers,e))}_makeCompatEvent(e,t){
const n=t||e,s=t?void 0:e.buttons,o=(0,i.default)((()=>this._target.getBoundingClientRect()||{left:0,top:0}));return{clientX:n.clientX,clientY:n.clientY,pageX:n.pageX,pageY:n.pageY,screenX:n.screenX,screenY:n.screenY,get localX(){return n.clientX-o().left},get localY(){return n.clientY-o().top},ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,metaKey:e.metaKey,buttons:s,isTouch:!e.type.startsWith("mouse")&&"contextmenu"!==e.type&&"click"!==e.type,stylus:"stylus"===t?.touchType,srcType:e.type,target:n.target,view:e.view,preventDefault:()=>{"touchstart"!==e.type&&(0,a.preventDefault)(e)}}}}function _(e){return e.getBoundingClientRect()||{left:0,top:0}}function g(e){return{x:e.pageX,y:e.pageY}}function T(e,t){const n=e.clientX-t.clientX,i=e.clientY-t.clientY;return Math.sqrt(n*n+i*i)}function b(e){return e.timeStamp||performance.now()}function E(e,t){for(let n=0;n<e.length;++n)if(e[n].identifier===t)return e[n];return null}},742778:(e,t,n)=>{"use strict";n.r(t),n.d(t,{addSymbolDialogHasOpenedKey:()=>r,showAddSymbolDialog:()=>a});var i=n(302358),s=n(784437),o=n(246445);const r="addSymbolDialogHasOpenedKey";function a(e){(0,i.runOrSigninWithFeature)((()=>{(0,s.showWatchListsDialog)({addSymbols:e,onOpen:u})}),{feature:"watchList",source:"add symbol to watchlist"})}function u(){o.emit(r)}},892772:(e,t,n)=>{"use strict";n.d(t,{createDwmAligner:()=>r,createTimeToBarTimeAligner:()=>a});var i=n(995354),s=n(266150);function o(){return!(0,s.isFeaturesetEnabled)("disable_resolution_rebuild")}const r=i.createDwmAligner.bind(null,o()),a=i.createTimeToBarTimeAligner.bind(null,o())},49833:(e,t,n)=>{"use strict";n.r(t),n.d(t,{SelectPointMode:()=>i,activePointSelectionMode:()=>J,alignTo45Degrees:()=>Ie,barTimesUnderCursor:()=>Z,beenSetLineToolLastPoint:()=>F,cancelLineTool:()=>se,cancelledLineTool:()=>V,changeLineStyle:()=>ve,changeLineTool:()=>ce,changedLineStyle:()=>q,changedLineTool:()=>Y,continueLineTool:()=>ie,continuedLineTool:()=>O,copiedLineTool:()=>z,copyLineTool:()=>pe,createLineTool:()=>ne,createdLineTool:()=>A,crosshairLock:()=>P,cursorTool:()=>D,drawOnAllCharts:()=>Le,drawOnAllChartsMode:()=>Ce,emojiTool:()=>L,finishChangingLineTool:()=>de,finishLineTool:()=>fe,finishMovingLineTool:()=>ue,finishedChangingLineTool:()=>$,finishedLineTool:()=>j,finishedMovingLineTool:()=>H,hideAllDrawings:()=>ye,hideAllIndicators:()=>Me,hideMarksOnBars:()=>we,iconTool:()=>I,init:()=>be,isDirectionalMovementActive:()=>x,isStudyEditingNow:()=>Q,isToolCreatingNow:()=>k,isToolEditingNow:()=>N,isToolMovingNow:()=>R,lockDrawings:()=>Pe,moveLineTool:()=>ae,movedLineTool:()=>U,properties:()=>Se,removeLineTool:()=>he,removedLineTool:()=>K,resetToCursor:()=>g,restoreLineTool:()=>me,restoreLineToolState:()=>_e,restoredLineTool:()=>X,restoredLineToolState:()=>G,runOnDrawingStateReady:()=>Ee,setLineToolLastPoint:()=>oe,startChangingLineTool:()=>le,startMovingLineTool:()=>re,startedChangingLineTool:()=>W,startedMovingLineTool:()=>B,stickerTool:()=>C,tool:()=>w,toolIsCursor:()=>v,toolIsDemonstration:()=>m,toolIsEraser:()=>p,toolIsMeasure:()=>_})
;var i,s=n(185842),o=n(8914),r=n(193867),a=n(168509),u=n(690522),l=n(875500),c=n(950808),d=n(246445),h=n(858328);!function(e){e[e.None=0]="None",e[e.Replay=1]="Replay",e[e.Study=2]="Study"}(i||(i={}));const f=new Set(["cursor","arrow","dot","performance","demonstration"]);function v(e){return f.has(e)}function p(e){return"eraser"===e}function m(e){return"demonstration"===e}function _(e){return"measure"===e}function g(e=!1){if(!e&&T){if(T.childs().stayInDrawingMode.value())return}w.setValue(D.value())}let T=null,b=null,E=null,S=null,y=null,M=null;const P=new u.WatchedObject(null),w=new a.WatchedValue,I=new a.WatchedValue,L=new a.WatchedValue,C=new a.WatchedValue,D=new a.WatchedValue,k=new a.WatchedValue(!1),N=new a.WatchedValue(!1),R=new a.WatchedValue(!1),x=new a.WatchedValue(!1),A=new l.Delegate,O=new l.Delegate,V=new l.Delegate,F=new l.Delegate,B=new l.Delegate,U=new l.Delegate,H=new l.Delegate,W=new l.Delegate,Y=new l.Delegate,$=new l.Delegate,K=new l.Delegate,j=new l.Delegate,q=new l.Delegate,z=new l.Delegate,X=new l.Delegate,G=new l.Delegate,J=new a.WatchedValue(i.None),Q=new a.WatchedValue(!1),Z=new Map;function ee(e,t){const n=t||{value:!1};return t=>{n.value||(n.value=!0,e.fire(t),n.value=!1)}}const te={value:!1},ne=ee(A,te),ie=ee(O,te),se=ee(V,te),oe=ee(F,te),re=ee(B),ae=ee(U),ue=ee(H),le=ee(W),ce=ee(Y),de=ee($),he=ee(K),fe=ee(j),ve=ee(q,te),pe=ee(z,te),me=ee(X),_e=ee(G);let ge=!1,Te=[];function be(){if(ge)return;const e=c.getValue("chart.cursorPreference","cursor");w.setValue(v(e)?e:"cursor"),w.subscribe((e=>{v(e)?D.setValue(e):p(e)&&(0,h.trackEvent)("Chart cursors",e)}),{callWithLast:!0}),D.subscribe((e=>{(0,h.trackEvent)("Chart cursors",e),e&&"performance"!==e&&!m(e)&&c.setValue("chart.cursorPreference",e)})),T=new r.DefaultProperty({defaultName:"drawings"}),b=(0,o.createPrimitiveProperty)(!1),E=(0,o.createPrimitiveProperty)(!1),S=(0,o.createPrimitiveProperty)(!1),y=(0,o.createPrimitiveProperty)(!c.getBool("BarsMarksContainer.visibile",!0)),M=(0,o.createPrimitiveProperty)(!1),w.subscribe((e=>{(0,d.emit)("onSelectedLineToolChanged")})),ge=!0,Te.forEach((e=>e())),Te=[]}function Ee(e){ge?e():Te.push(e)}function Se(){return(0,s.ensureNotNull)(T)}function ye(){return(0,s.ensureNotNull)(b)}function Me(){return(0,s.ensureNotNull)(E)}function Pe(){return(0,s.ensureNotNull)(S)}function we(){return(0,s.ensureNotNull)(y)}function Ie(){return(0,s.ensureNotNull)(M)}function Le(){return Se().childs().drawOnAllCharts}function Ce(){return Se().childs().drawOnAllChartsMode}},874651:(e,t,n)=>{"use strict";n.d(t,{DEFAULT_ADJUSTMENT:()=>o,DEFAULT_SESSION:()=>s,DEFAULT_SETTLEMENT_AS_CLOSE:()=>r,compareSymbols:()=>b,decodeExtendedSymbol:()=>m,encodeExtendedSymbolOrGetSimpleSymbolString:()=>f,extractExtendedSymbol:()=>g,getExtendedSymbol:()=>p,isEncodedExtendedSymbol:()=>v,isReplaySymbol:()=>h,isStudySymbol:()=>c,replaceExtendedSymbol:()=>E,symbolWithoutPrefix:()=>S,unwrapSimpleSymbol:()=>_});var i=n(385955);const s="regular",o="splits",r=!0;function a(e){return"="+JSON.stringify(u(e))}function u(e){
return Object.keys(e).sort().reduce(((t,n)=>("[object Object]"===Object.prototype.toString.call(e[n])?t[n]=u(e[n]):t[n]=e[n],t)),{})}function l(e){return(0,i.isString)(e)}function c(e){return!l(e)&&"inputs"in e}function d(e){return!l(e)&&"replay"in e}function h(e){return d(e)||function(e){return!l(e)&&d(e.symbol)}(e)}function f(e){return c(e)||h(e)||e.session||e.adjustment||e["currency-id"]||e["unit-id"]||e.metric?a(e):e.symbol}function v(e){return"="===e[0]}function p(e){return l(e)?m(e):e}function m(e){if(!v(e))return{symbol:e};try{return JSON.parse(e.slice(1))}catch(t){return{symbol:e}}}function _(e){return l(e)?e:_(e.symbol)}function g(e){if(l(e))return{symbol:e};let t=e;for(;!l(t.symbol);)t=t.symbol;return t}const T=["symbol","session","unit-id","currency-id","metric","adjustment","backadjustment","settlement-as-close"];function b(e,t){return T.every((n=>e[n]===t[n]))}function E(e,t){let n=e;for(;!l(n.symbol);)n=n.symbol;n.symbol=t}function S(e){return e.split(":").slice(-1).pop()??e}},23439:(e,t,n)=>{"use strict";n.d(t,{LineToolCollectedProperty:()=>l,LineToolColorsProperty:()=>d,LineToolWidthsProperty:()=>c,MultipleLineColorsProperty:()=>v,MultipleLineWidthsProperty:()=>f});var i=n(77357),s=n(641422),o=n(813006);const r=(0,i.getLogger)("Chart.LineToolCollectedProperty");class a{applyValue(e,t){e.setValue(t)}}class u extends o.PropertyBase{constructor(e,t){super(),this._properties=e,e.forEach(((e,t)=>e.subscribe(this,((e,n)=>{this._listeners.fire(this,`${t}.${n}`)})))),this._showIfProperty=t}visible(){return!this._showIfProperty||this._showIfProperty?.value()}value(){if(0===this._properties.length)return r.logError("Incorrect call, should not request value of 0 properties"),"mixed";const e=this._properties[0].value();return 1===this._properties.length||this._properties.every((t=>t.value()===e))?e:"mixed"}setValueSilently(e){"mixed"!==e&&this._properties.forEach((t=>t.setValueSilently(e)))}hasChild(e){const t=parseInt(e,10);return!isNaN(t)&&t>=0&&t<this._properties.length}childCount(){return this._properties.length}childNames(){return this._properties.map(((e,t)=>t.toString()))}child(e){const t=parseInt(e,10);return!isNaN(t)&&t>=0&&t<this._properties.length?this._properties[t]:void 0}destroy(){this._properties.forEach((e=>e.unsubscribeAll(this))),this._listeners.destroy()}storeStateIfUndefined(){return!0}weakReference(){return(0,s.weakReference)(this)}ownership(){return(0,s.ownership)(this)}}class l extends u{setValue(e,t,n){if("mixed"===e)return;const i=n??new a;this._properties.forEach((t=>i.applyValue(t,e)))}}class c extends l{}class d extends l{firstColor(){return this._properties[0].value()}}class h extends(79795==n.j?u:null){setValue(e,t,n){if("mixed"===e)return;const i=n??new a;this._properties.forEach((t=>t.setValue(e,void 0,i)))}}class f extends(79795==n.j?h:null){}class v extends(79795==n.j?h:null){}},101458:(e,t,n)=>{"use strict";n.d(t,{cloneLineTool:()=>F,createLineTool:()=>L,createLineToolProperties:()=>D,createStudyLineToolProperties:()=>k,ensureAllLineToolsLoadedForLayout:()=>w,
initAllLineToolsFromContent:()=>I,initLineTool:()=>S,isBrushBasedLineTool:()=>R,isEditableTextLineTool:()=>O,isLineTool:()=>_.isLineTool,isTrading:()=>x,prepareLineToolPropertiesByOwnerSource:()=>C,setNewToolProperties:()=>b,supportsPhantomMode:()=>N,tryFindStudyLineToolNameByStudyId:()=>V,unsetNewToolProperties:()=>E});var i=n(849084),s=n(185842),o=n(657415),r=n(77357),a=n(553722),u=n(495539),l=n(70346),c=n(187614),d=n(489793),h=n(818472),f=n(276978),v=n(654049),p=n(598237),m=n(241181),_=n(727724);const g="DrawingCreations";let T=null;function b(e,t,n){return null!==T&&T.tool===e&&T.toolData===t||(E(!0),T={properties:D(n.backgroundTheme().spawnOwnership(),e,!n.readOnly()),tool:e,toolData:t}),T.properties}function E(e){e&&T?.properties.destroy(),T=null}async function S(e){await(0,m.loadMetaInfoForLinetoolIfRequired)(e);const t=(0,m.asLineToolName)(e);(0,m.isLineToolLoaded)(t)||(0,c.isLineToolName)(t)&&await(0,m.loadLineTool)(t)}function y(e,t){const n="charts"in e?e.charts:[e];for(const e of n){for(const n of e.panes)for(const e of n.sources)t(e.type);e.lineToolsGroups?.groups.forEach((e=>{e.tools.forEach((e=>t(e)))}))}}class M extends Error{constructor(e,t){super(`Failed to load line tool: ${e}`),this.name="LineToolLoadError",this.toolName=e,this.originalError=t}}const P=(0,r.getLogger)("LineToolsSynchronizer");async function w(e){const t=new Set,n=e=>{(0,m.isAsyncGenericLineToolName)(e)&&t.add(e)};for(const t of e)y(t,n);const i=[...t],s=(await Promise.allSettled(i.map((e=>(0,m.ensureLineToolLoaded)(e).catch((t=>{throw new M(e,t)})))))).filter((e=>"rejected"===e.status));s.length>0&&s.forEach((e=>{const t=e.reason;P.logError(`Failed to load line tool: ${t.toolName}`)}))}async function I(e){if(!e)return;const t=new Set;y(e,(e=>{(0,c.isLineToolName)(e)&&t.add(e)})),await Promise.all(Array.from(t).map((e=>S(e))))}function L(e,t,n,i,o,r,a){(0,s.assert)((0,c.isLineToolName)(e),"Unknown line tool: "+e);const u=(0,m.asLineToolName)(e);let l;if((0,s.assert)((0,m.isLineToolLoaded)(u),`Line tool ${u} is not loaded`),o||n||null===T||T.tool!==e||(n=T.properties,E(!1)),(0,m.isAsyncStudyLineToolName)(u)){l=new((0,m.getLoadedLineTool)(u))(t,n,(0,s.ensureDefined)(i),o,r)}else{l=new((0,m.getLoadedLineTool)(u))(t,n,o,r)}return l.toolname=e,E(!0),void 0!==a&&(0,f.shouldAffectUser)(g,v.sparseUsersTrackingCoefficient)&&(0,h.trackChartDrawingCreation)(e,a),l}function C(e,t){const n=(0,s.ensureNotNull)(t.symbolSource()),i=n.symbolInfo(),o=i?(0,l.extractLineToolSymbolFromSymbolInfo)(i,n.symbol()):n.symbol();e.childs().symbol.setValue(o),n.model().currencyConversionEnabled()&&n.isConvertedToOtherCurrency()&&e.childs().currencyId.setValue(n.currency()),n.model().unitConversionEnabled()&&n.isConvertedToOtherUnit()&&e.childs().unitId.setValue(n.unit()),n.model().metricConversionEnabled()&&e.childs().metricId.setValue(n.model().mainSeries().metric()??"price"),e.childs().symbolStateVersion.setValue(2),e.childs().zOrderVersion.setValue(2)}function D(e,t,n,i){(0,s.assert)((0,c.isLineToolName)(t),`${t} should be name of the line tool`);const o=(0,
m.asLineToolName)(t);if((0,s.assert)((0,m.isLineToolLoaded)(o),`Line tool ${o} is not loaded`),(0,m.isAsyncStudyLineToolName)(o)){return(0,m.getLoadedLineTool)(o).createProperties(e,i)}return(0,m.getLoadedLineTool)(o).createProperties(e,i,n)}function k(e,t,n,i,o,r){(0,s.assert)((0,c.isStudyLineToolName)(t),`${t} should be name of the study line tool`);const a=(0,m.asLineToolName)(t);if((0,m.isAsyncStudyLineToolName)(a)){return(0,m.getLoadedLineTool)(a).createPropertiesFromStudyMetaInfoAndState(n,i,o,r,e)}throw new Error(`Property creation is not implemented for study line tool ${t}`)}function N(e){(0,s.assert)((0,c.isLineToolName)(e),`${e} should be name of the line tool`);const t=(0,m.asLineToolName)(e);(0,s.assert)((0,m.isLineToolLoaded)(t),`Line tool ${t} is not loaded`);const n=(0,m.getLoadedLineTool)(t);return void 0!==n&&Boolean(n.supportPhantomMode)}function R(e){return e instanceof p.LineToolBrushBase}function x(e){return e instanceof u.LineToolTrading}const A=["editableTextStyle","editableText","editableTextProperties"];function O(e){return(0,i.default)(e)&&A.every((t=>t in e))}function V(e){let t=null;return e===d.lineToolsStudyIds.LineToolRegressionTrend?t="LineToolRegressionTrend":e===d.lineToolsStudyIds.LineToolVbPFixed?t="LineToolVbPFixed":e===d.lineToolsStudyIds.LineToolFixedRangeVolumeProfile&&(t="LineToolFixedRangeVolumeProfile"),t}function F(e,t,n,i,r){const u=t.toolname,l=t.properties().state();l.intervalsVisibilities=(0,a.mergeIntervalVisibilitiesDefaults)(l?.intervalsVisibilities);const c=D(e.backgroundTheme().spawnOwnership(),t.toolname,!e.readOnly(),l);c.childs().visible.setValue(!0);const d=(0,s.ensureNotNull)(t.ownerSource()),h=L(u,e,c,null,void 0,void 0,r);void 0!==i&&h.setId(i),h.supportsTargetSignature()&&null!==d.signature().value()?h.setTargetSignature(d.signature().value()):h.setOwnerSource(d),h.toolname=u;const f=h.clonePositionOffset();if(t.isFixed()){const e=(0,s.ensureDefined)(t.fixedPoint()),i=n?e.add(new o.Point(f.xCoordOffset,f.yCoordOffset)):e;h.addFixedPoint(i)}const v=t.normalizedPoints(),p=n?function(e,t,n){const i=(0,s.ensureNotNull)(t.priceScale()),o=(0,s.ensureNotNull)(t.firstValue());return e.map((e=>{const t=e.price,s=i.priceToCoordinate(t,o)+n.yCoordOffset,r=i.coordinateToPrice(s,o),a=e.interval;return{time_t:e.time_t,price:r,offset:e.offset+n.barOffset,interval:a}}))}(v,d,f):v,m=t.points();return h.restorePoints(p,m),h.cloneData&&h.cloneData(t),h.recalculateStateByData&&h.recalculateStateByData(),h}},382485:(e,t,n)=>{"use strict";n.d(t,{magnetEnabled:()=>m,magnetMode:()=>_,magnetSnapsToIndicators:()=>g,setIsMagnetEnabled:()=>T,setMagnetMode:()=>b,setMagnetSnapsToIndicators:()=>E});var i=n(193867),s=n(168509),o=n(470841),r=n(49833),a=n(187614),u=n(247553);const l=new s.WatchedValue(!1),c=new s.WatchedValue(o.MagnetMode.WeakMagnet),d=new s.WatchedValue(!1),h=(0,u.modifierPressed)(),f=(0,u.shiftPressed)();function v(){const e=h.value();if(f.value()&&(r.isToolEditingNow.value()||r.isToolCreatingNow.value()))return void l.setValue(!1);let t,n
;if(r.activePointSelectionMode.value()===r.SelectPointMode.Replay)t=n=!1;else{const i=r.tool.value(),s=r.isStudyEditingNow.value()||r.activePointSelectionMode.value()===r.SelectPointMode.Study;t=e&&((0,a.isLineToolName)(i)||r.isToolEditingNow.value()||(0,r.toolIsMeasure)(i)||s),n=(0,r.properties)().childs().magnet.value()}c.setValue(!n&&t?o.MagnetMode.StrongMagnet:(0,r.properties)().childs().magnetMode.value()),l.setValue(t?!n:n)}function p(){d.setValue((0,r.properties)().childs().magnetSnapsToIndicators.value())}function m(){return l}function _(){return c}function g(){return d}function T(e){(0,i.allowSavingDefaults)(!0),(0,r.properties)().childs().magnet.setValue(e),(0,i.allowSavingDefaults)(!1)}function b(e){(0,i.allowSavingDefaults)(!0),(0,r.properties)().childs().magnetMode.setValue(e),(0,r.properties)().childs().magnet.setValue(!0),(0,i.allowSavingDefaults)(!1)}function E(e){(0,i.allowSavingDefaults)(!0),(0,r.properties)().childs().magnetSnapsToIndicators.setValue(e),(0,i.allowSavingDefaults)(!1)}(0,r.runOnDrawingStateReady)((()=>{(0,r.properties)().childs().magnet.subscribe(null,v),(0,r.properties)().childs().magnetMode.subscribe(null,v),(0,r.properties)().childs().magnetSnapsToIndicators.subscribe(null,p),h.subscribe(v),f.subscribe(v),r.tool.subscribe(v),r.isToolEditingNow.subscribe(v),v(),p()}))},466269:(e,t,n)=>{"use strict";n.d(t,{compareResolutions:()=>v.compareResolutions,convertResolutionsFromSettings:()=>w,formatDirectionalResolution:()=>O,getApplicableIntervalForFrequency:()=>v.getApplicableIntervalForFrequency,getDefaultResolution:()=>E,getMaxResolutionValue:()=>P,getResolutionByChartStyle:()=>S,getTranslatedResolution:()=>C,getTranslatedResolutionModel:()=>D,intervalIsSupported:()=>A,isAvailable:()=>T,isIntervalEnabled:()=>x,isResolutionMultiplierValid:()=>y,isSecondsEnabled:()=>N,mergeResolutions:()=>I,normalizeIntervalString:()=>g,setLastUsedResolution:()=>b,sortResolutions:()=>L});var i=n(385955),s=n(266150),o=n(729193),r=n(357966),a=n(70346),u=n(950808),l=n(788312),c=n(110443),d=n(199715),h=n(196768),f=n(205356),v=n(954863);const p=[1,5,10,15,30,45],m=[1,10,100,1e3],_=(0,l.isFeatureEnabled)("custom_ticks");function g(e){return r.Interval.parse(e).value()}function T(e){const t=r.Interval.parse(e);if(t.isRange())return c.linking.range.value();if(!(0,f.isTicksEnabled)()&&t.isTicks())return!1;const n=t.value(),i=c.linking.dataFrequencyResolution.value();if(void 0!==i&&(0,v.compareResolutions)(n,i)<0)return!1;const s=c.linking.supportedResolutions.value();return void 0!==s?void 0!==s.find((e=>g(e)===n)):t.isTicks()?Boolean(c.linking.ticks.value()):t.isIntraday()?Boolean(c.linking.intraday.value()):t.isDWM()}function b(e){r.Interval.isValid(e)&&(r.Interval.isRange(e)?u.setValue("chart.lastUsedRangeResolution",e):u.setValue("chart.lastUsedTimeBasedResolution",e))}function E(e){return e?"100R":"1D"}function S(e,t,n){const i=a.isRangeStyle(e),s=r.Interval.isRange(t);return!i&&s?function(e){const t=u.getValue("chart.lastUsedTimeBasedResolution");if(void 0!==t&&r.Interval.isTimeBased(t))return t;let n="1D"
;for(const t of e){const e=r.Interval.parse(t);if(e.isTimeBased()){const t=e.value();if("1D"===t)return t;n=t}}return n}(n):i&&!s?function(e){const t=u.getValue("chart.lastUsedRangeResolution");if(void 0!==t&&r.Interval.isRange(t))return t;let n="100R";for(const t of e){const e=r.Interval.parse(t);if(e.isRange()){const t=e.value();if("100R"===t)return t;n=t}}return n}(n):t}function y(e){const{interval:t,guiResolutionKind:n}=r.Interval.parseExt(e);if(!t.isValid())return!1;const i=t.multiplier();if(n===r.ResolutionKind.Seconds)return p.includes(i);if((0,f.isTicksEnabled)()&&n===r.ResolutionKind.Ticks)return!!_||m.includes(i);return(n===r.SpecialResolutionKind.Hours?i/60:i)<=M(n)}function M(e){const t=v.maxResolutionValues[e];return Number.isNaN(t)?1:t}function P(e){return M(r.Interval.parseExt(e).guiResolutionKind)}function w(e){return Array.isArray(e)?e:Object.keys(e).map(r.Interval.normalize).filter(i.notNull)}function I(...e){let t=[].concat(...e);return t=(0,d.uniq)(t.filter(y).map(g)),L(t)}function L(e){return e.sort(v.compareResolutions)}function C(e){const{multiplier:t,shortKind:n}=D(e);return`${t}${n}`}function D(e,t){const n=r.Interval.parse(e);let i=n.multiplier(),s=n.kind();if(!n.isValid()){if(t)return null;throw new TypeError(`Can't translate invalid interval: ${e}`)}return n.isMinuteHours()&&(i=Math.floor(i/60),s=r.SpecialResolutionKind.Hours),{multiplier:i.toString(),shortKind:k(s),hint:`${i} ${k(s,i)}`,mayOmitMultiplier:n.isDWM()&&1===i,mayOmitShortKind:n.isMinutes()&&!n.isMinuteHours()}}function k(e,t){if(!t)return{[r.ResolutionKind.Invalid]:"",[r.ResolutionKind.Ticks]:o.t(null,{context:"interval_short"},n(218036)),[r.ResolutionKind.Seconds]:o.t(null,{context:"interval_short"},n(390809)),[r.ResolutionKind.Minutes]:o.t(null,{context:"interval_short"},n(6184)),[r.SpecialResolutionKind.Hours]:o.t(null,{context:"interval_short"},n(24073)),[r.ResolutionKind.Days]:o.t(null,{context:"interval_short"},n(191432)),[r.ResolutionKind.Weeks]:o.t(null,{context:"interval_short"},n(323570)),[r.ResolutionKind.Months]:o.t(null,{context:"interval_short"},n(88910)),[r.ResolutionKind.Range]:o.t(null,{context:"interval_short"},n(281107))}[e];switch(e){case r.ResolutionKind.Ticks:return o.t(null,{plural:"ticks",count:t},n(506447));case r.ResolutionKind.Days:return o.t(null,{plural:"days",count:t},n(743002));case r.ResolutionKind.Weeks:return o.t(null,{plural:"weeks",count:t},n(388105));case r.ResolutionKind.Months:return o.t(null,{plural:"months",count:t},n(323485));case r.ResolutionKind.Seconds:return o.t(null,{plural:"seconds",count:t},n(665530));case r.ResolutionKind.Minutes:return o.t(null,{plural:"minutes",count:t},n(113642));case r.SpecialResolutionKind.Hours:return o.t(null,{plural:"hours",count:t},n(419114));case r.ResolutionKind.Range:return o.t(null,{plural:"ranges",count:t},n(61649));default:return e}}function N(){return!0}function R(e){return!(!(0,f.isTicksEnabled)()&&e.isTicks())}function x(e){return R(r.Interval.parse(e))}function A(e){if((0,s.isFeaturesetEnabled)("allow_supported_resolutions_set_only")){
const t=r.Interval.normalize(e);return null!==t&&T(t)}{const t=r.Interval.parse(e);if(!t.isValid()||!R(t))return!1;if(!(0,s.isFeaturesetEnabled)("custom_resolutions")){const t=r.Interval.normalize(e),n=window.ChartApiInstance.defaultResolutions().filter(x);if(!t||-1===n.indexOf(t))return!1}const n=c.linking.dataFrequencyResolution.value();if(void 0!==n&&(0,v.getApplicableIntervalForFrequency)(n,t.value())!==t.value())return!1;if(t.isRange())return c.linking.range.value();if(t.isTicks())return c.linking.ticks.value();if(t.isIntraday())return c.linking.intraday.value();{const e=c.linking.supportedResolutions.value();return!e||e.includes(t.value())}}}function O(e){return(0,h.isRtl)()?" "+(0,h.forceRTLStr)(" ,"+e):", "+e}},830213:(e,t,n)=>{"use strict";n.r(t),n.d(t,{StudyMetaInfoRepository:()=>_,emptyPineId:()=>p,isStudyDescriptor:()=>m,studyMetaInfoRepository:()=>b});var i=n(578519),s=n(729193),o=n(185842),r=n(127985),a=n(551745),u=n(739019),l=n(822783),c=n(964798),d=n(575510),h=n(77357),f=n(222993);const v=(0,h.getLogger)("Chart.Studies.StudyMetaInfoRepository",{color:"#606"}),p="";function m(e){return"object"==typeof e&&null!==e&&"type"in e&&("java"===e.type&&"studyId"in e||"pine"===e.type&&"pineId"in e)}class _{constructor(e){this._isReady=!1,this._studyVersioning=null,this._rawStudiesMetaInfo=[],this._rawStudiesMetaInfoDeferredPromise=null,this._javaStudiesMetaInfo=[],this._pineMetaInfoCache=[],this._compileErrors=new WeakMap,this._studiesMigrations=[],this._chartApi=e}async requestMetaInfo(){if(null===this._rawStudiesMetaInfoDeferredPromise){this._rawStudiesMetaInfoDeferredPromise=(0,f.createDeferredPromise)();const e=await this._chartApi.requestMetadata(),t=e.params[1].metainfo.slice();{const n=e.params[1].migrations.slice();this._processSiteMetaInfo(t,n)}this._studyVersioning=new l.StudyVersioning(this._javaStudiesMetaInfo,this._studiesMigrations),this._requestFinished(),this._rawStudiesMetaInfoDeferredPromise.resolve(this._rawStudiesMetaInfo)}return this._rawStudiesMetaInfoDeferredPromise.promise}async findById(e){this._isReady||await this.requestMetaInfo();const t=this._findStudyMetaInfo(e);if(null!==t){const e=this._compileErrors.get(t);return e?Promise.reject(e):Promise.resolve(t)}return"pine"===e.type?this._compilePine(e):Promise.reject(`unexpected study id=${e.studyId} with type=${e.type}`)}findByIdSync(e){return this._findStudyMetaInfo(e)}isReady(){return this._isReady}async findAllJavaStudies(){return this._isReady||await this.requestMetaInfo(),this._javaStudiesMetaInfo}studyVersioning(){return(0,o.ensureNotNull)(this._studyVersioning)}getInternalMetaInfoArray(){return this._javaStudiesMetaInfo}addPineMetaInfo(e,t){const n=T(this._pineMetaInfoCache,e);return t&&(!Array.isArray(t)||t.length>0)&&(t=Array.isArray(t)?new d.PineCompileFailErrorImpl({warnings:[],errors:t},e):t,this._compileErrors.set(n,t)),n}async getLatestMetaInfoForPineStudy(e,t){const n=await(0,c.requestUserScripts)();let i;if(n){const s=n.find((t=>t.scriptIdPart===e));if(s){const e=u.Version.parse(t),n=u.Version.parse(s.version)
;e.isLess(n)&&(i=s.version)}}if(void 0!==i){const t={type:"pine",pineId:e,pineVersion:i};return this.findById(t)}return null}_processMigrations(e){this._studiesMigrations=[];for(let t=0;e&&t<e.length;t++)this._studiesMigrations.push(e[t])}_processSiteMetaInfo(e,t){for(const t of e)l.StudyVersioning.verifyInputsMaxValue(t),g(t);this._rawStudiesMetaInfo=e,this._processMigrations(t);for(const e of this._rawStudiesMetaInfo)T(this._javaStudiesMetaInfo,e);r.StudyMetaInfo.overrideDefaults(this._javaStudiesMetaInfo)}_processLibraryMetaInfo(e){}_requestFinished(){this._isReady=!0}_findStudyMetaInfo(e){return"java"===e.type?((0,o.assert)(0!==this._javaStudiesMetaInfo.length,"Java studies metainfo should be define here"),this._javaStudiesMetaInfo.find((t=>t.id===e.studyId))||null):this._pineMetaInfoCache.find((t=>t.scriptIdPart===e.pineId&&(void 0===e.pineVersion||(0,o.ensureDefined)(t.pine).version===e.pineVersion)))||null}_compilePine(e){v.logNormal(`Compiling ${e.pineId} script`);const t=(0,c.translateScriptAsync2)(e.pineId,e.pineVersion||"last").then((({metaInfo:t,compileErrors:n})=>(v.logNormal(`Compiling ${e.pineId} is successful`),this.addPineMetaInfo((0,o.ensureDefined)(t),n.errors))));return t.catch((t=>{t instanceof d.PineCompileFailErrorImpl&&this.addPineMetaInfo(t.metaInfo,t),v.logNormal(`Compiling ${e.pineId} is failed`)})),t}}function g(e){e.description_localized=s.t(e.description,{context:"study"},n(884693))}function T(e,t){const n=new r.StudyMetaInfo(t).state();(0,a.migrateMetaInfoAndPropState)(n);const i=new r.StudyMetaInfo(n);let s=!0;const o=e.findIndex((e=>e.id===i.id));if(-1===o)e.push(i);else{const t=e[o],n=void 0!==t.pine?u.Version.parse(t.pine.version):null,r=void 0!==i.pine?u.Version.parse(i.pine.version):null;null===r||null===n||r.isGreaterOrEqual(n)?(t.removeDefaults(),e[o]=i):s=!1}return s&&i.createDefaults(),i}const b=(0,i.default)((()=>new _(window.ChartApiInstance)))},593026:(e,t,n)=>{"use strict";n.d(t,{TextWidthCache:()=>o,getMinTextMetrics:()=>s});var i=n(164680);function s(e){return{width:e.width,actualBoundingBoxAscent:e.actualBoundingBoxAscent,actualBoundingBoxDescent:e.actualBoundingBoxDescent,fontBoundingBoxAscent:e.fontBoundingBoxAscent,fontBoundingBoxDescent:e.fontBoundingBoxDescent}}class o{constructor(e=150){this._fontStyle="",this._cache=new i.CircularCacheBuffer(e,1.5)}reset(){this._cache.clear()}measureText(e,t,n){let i=t;return n?.mono&&(i=t.replace(/\d/g,"0")),this.getMetrics(e,i).width}yMidCorrection(e,t){const n=this.getMetrics(e,t);return void 0!==n.actualBoundingBoxAscent&&void 0!==n.actualBoundingBoxDescent?(n.actualBoundingBoxAscent-n.actualBoundingBoxDescent)/2:0}getMetrics(e,t){e.font!==this._fontStyle&&(this.reset(),this._fontStyle=e.font);const n=this._cache.get(t);if(void 0!==n)return n;const i=e.textBaseline;e.textBaseline="middle";const o=s(e.measureText(t));return e.textBaseline=i,0===o.width&&t.length||this._cache.set(t,o),o}}},574113:(e,t,n)=>{"use strict";var i,s;n.d(t,{AlertEditorInvocationMode:()=>s,ExpirationPresetType:()=>i}),function(e){
e.OpenEnded="open-ended",e.Fixed="fixed"}(i||(i={})),function(e){e.CreateAlert="create_alert",e.EditAlert="edit_alert",e.ShowReadonlyAlert="show_alert"}(s||(s={}))},167481:(e,t,n)=>{"use strict";n.d(t,{setSupportPortalProblemsHost:()=>s,supportPortalProblemsHost:()=>i});let i="";function s(e){i=e}},640156:(e,t,n)=>{"use strict";n.r(t),n.d(t,{getTranslatedSymbolDescription:()=>o});var i=n(729193);function s(e){const t=`#${e}-symbol-description`,s=i.t(t,void 0,n(258667));return s===t?null:s}function o(e){if(void 0!==e.pro_name){const t=s(e.pro_name);if(null!==t)return t;if(void 0!==e.short_name){const t=s(e.short_name);if(null!==t)return t}}return"en"!==e.language&&void 0!==e.local_description&&e.language===window.language||"en"===e.language&&void 0!==e.local_description&&e.language===window.language?e.local_description:e.description||""}},124321:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28" fill="none"><path fill="currentColor" d="M14 6c6.075 0 11 4.925 11 11 0 1.41-.266 2.76-.75 4l-.144.368-.391-.054-2.284-.319.138-.99 1.885.263A10 10 0 0 0 24 17c0-1.35-.267-2.639-.753-3.815l-1.523.762-.448-.894 1.543-.772A10 10 0 0 0 14 7v2h-1V7.05a10 10 0 0 0-7.82 5.231l1.544.772-.448.894-1.523-.761A10 10 0 0 0 4 17c0 1.145.192 2.244.546 3.268l1.885-.263.138.99-2.284.319-.391.054L3.75 21C3.266 19.76 3 18.41 3 17 3 10.925 7.925 6 14 6m4.416 5.277-2.926 4.389a2 2 0 1 1-.832-.555l2.926-4.388z"/></svg>'},93721:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28"><g fill="none" fill-rule="evenodd" stroke="currentColor"><path d="M13.111 18.5H10.5a1 1 0 0 1-1-1v-11a1 1 0 0 1 1-1h11a1 1 0 0 1 1 1v11a1 1 0 0 1-1 1h-8.389z"/><path d="M18.5 20v1.5a1 1 0 0 1-1 1h-11a1 1 0 0 1-1-1v-11a1 1 0 0 1 1-1H8"/></g></svg>'}}]);