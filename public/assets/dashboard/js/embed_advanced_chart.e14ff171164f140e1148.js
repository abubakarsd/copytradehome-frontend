(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[77038,40696,98927,93867],{197486:(e,t)=>{"use strict";function s(e){return Math.round(1e10*e)/1e10}Object.defineProperty(t,"__esModule",{value:!0}),t.alignTo=t.fixComputationError=t.isNaN=t.isInteger=t.isNumber=void 0,t.isNumber=function(e){return"number"==typeof e&&isFinite(e)},t.isInteger=function(e){return"number"==typeof e&&e%1==0},t.isNaN=function(e){return!(e<=0||e>0)},t.fixComputationError=s,t.alignTo=function(e,t){var i=e/t,r=Math.floor(i),n=i-r;return n>2e-10?s(n>.5?(r+1)*t:r*t):e}},260156:e=>{e.exports={}},812579:(e,t,s)=>{"use strict";s.d(t,{WatchedObject:()=>o});var i=s(385955),r=s(336315);function n(e,t){return(0,i.deepEquals)(e,t)[0]}class o extends r.WatchedValue{constructor(e,t=n){super(e),this._comparator=t}setValue(e,t){!t&&this._comparator(this.value(),e)||super.setValue(e,t)}}},192856:(e,t,s)=>{"use strict";s.d(t,{createGroup:()=>l,keyboardPressedKeysState:()=>a,pressedKeys:()=>o,registerWindow:()=>h});var i=s(360002),r=s(336653);s(954231);const n=new i.ActionManager,o=n.pressedKeys(),a=n.keyboardPressedKeysState();function l(e){return new r.ActionGroup(n,e)}function h(e){n.listen(e)}},524257:(e,t,s)=>{"use strict";var i;s.d(t,{ChartApiMessageMethod:()=>i}),function(e){e.Connected="connected",e.Disconnected="disconnected",e.ReconnectBailout="reconnect_bailout"}(i||(i={}))},168705:(e,t,s)=>{"use strict";async function i(e){return(await Promise.all([s.e(18911),s.e(6784),s.e(11087),s.e(52682),s.e(66920),s.e(68120),s.e(15215),s.e(72113),s.e(30567),s.e(77831),s.e(63122),s.e(58291),s.e(99827),s.e(7676),s.e(38994),s.e(57343),s.e(46383)]).then(s.bind(s,112216))).createDialog(e)}function r(e){i(e).then((e=>e.open()))}s.d(t,{createErrorDialog:()=>i,showErrorDialog:()=>r})},342264:(e,t,s)=>{"use strict";s.d(t,{createCache:()=>o});var i=s(185842);class r{constructor(e){this._cache=e}async getValue(e){const t=await this._cache.match(e);if(!t)return null;return"application/json"===(0,i.ensureNotNull)(t.headers.get("Content-Type"))?t.json():t.text()}async setValue(e,t){return"string"==typeof t?this._cache.put(e,new Response(t,{headers:{"content-type":"text/plain"}})):this._cache.put(e,new Response(JSON.stringify(t),{headers:{"content-type":"application/json"}}))}async migrateValue(e,t){const s=await this.getValue(e);s&&(await this.setValue(t,s),await this._cache.delete(e))}}class n{constructor(){this._data=new Map}async getValue(e){return this._data.get(e)??null}async setValue(e,t){this._data.set(e,t)}async migrateValue(e,t){this._data.has(e)&&(this._data.set(t,this._data.get(e)),this._data.delete(e))}}async function o(e){try{const t=await caches.open(e);return new r(t)}catch{return new n}}},587241:(e,t,s)=>{"use strict";s.d(t,{reloginOrGoPro:()=>u,runOrGoPro:()=>d,runOrGoProWithoutSync:()=>h});var i=s(603719),r=s(537244);function n(e,t,s){return t.value||(0,r.enabled)(e,s)}function o(e,t,s){switch(e){case"SCREENER_INTERVALS":return function(e,t){const s=(0,r.getConfig)("SCREENER_INTERVALS",t)
;return!(!s||!s.interval)&&s.interval.includes(e.interval)}(t,s);case"SCREENER_AUTO_REFRESH":return n("SCREENER_AUTO_REFRESH",t,s);case"ALERTS_NO_EXPIRATION":return n("ALERTS_NO_EXPIRATION",t,s);default:return(0,r.enabled)(e,s)}}var a=s(770145),l=s(822707);function h(e,t,s,i,r){o(t,i)?e():(0,l.openPaywall)({...s,runOrGoproWithFeatureCheckOptions:{featureCheck:()=>o(t,i),signInSuccess:e}},r)}async function d(e,t,s,r={},n){const o=window.is_authenticated;window.is_authenticated&&window.user.is_pro&&await(0,i.syncUserData)("gopro"),o===window.is_authenticated?h(e,t,s,r,n):(0,a.showSignModal)({source:s.goproSource,feature:s.feature,signinSuccess:e})}async function u(e,t){const s=window.is_authenticated;window.is_authenticated&&window.user.is_pro&&await(0,i.syncUserData)("gopro"),s===window.is_authenticated?(0,l.openPaywall)(e,t):(0,a.showSignModal)({source:e.goproSource,feature:e.feature})}},266150:(e,t,s)=>{"use strict";s.r(t),s.d(t,{disable:()=>i.disable,enable:()=>i.enable,getAllFeatures:()=>i.getAllFeatures,isFeaturesetEnabled:()=>i.enabled,setEnabled:()=>i.setEnabled});var i=s(478316);"object"==typeof __initialDisabledFeaturesets&&Array.isArray(__initialDisabledFeaturesets)&&__initialDisabledFeaturesets.forEach(i.disable),"object"==typeof __initialEnabledFeaturesets&&Array.isArray(__initialEnabledFeaturesets)&&__initialEnabledFeaturesets.forEach(i.enable)},788312:(e,t,s)=>{"use strict";s.r(t),s.d(t,{FeatureToggle:()=>h,isFeatureEnabled:()=>u,onFeaturesStateChanged:()=>a});var i=s(724226),r=s(875500),n=s(276978);s(376596);const o=new r.Delegate,a=()=>o,l="forcefeaturetoggle.";const h=new class{enableFeature(e){i.TVLocalStorage.setItem(l+e,"true"),o.fire(e)}disableFeature(e){i.TVLocalStorage.setItem(l+e,"false"),o.fire(e)}resetFeature(e){i.TVLocalStorage.removeItem(l+e),o.fire(e)}onFeaturesStateChanged(){return o}};function d(e,t){return(!e[t]||-1!==e[t])&&(!!("true"===i.TVLocalStorage.getItem(l+t)||window.is_authenticated&&"true"===window.user?.settings?.[l+t])||!("false"===i.TVLocalStorage.getItem(l+t)||window.is_authenticated&&"false"===window.user?.settings?.[l+t])&&(!!e[t]&&(1===e[t]||(0,n.shouldAffectUser)(t,e[t]))))}window.TradingView=window.TradingView||{},window.TradingView.FeatureToggle=h;const u=(c=window.featureToggleState||{},window.TradingView.onWidget?.()||Promise.all([s.e(26395),s.e(13993)]).then(s.bind(s,726395)).then((e=>{e.pushStreamMultiplexer.on("featuretoggle",(e=>{const t=d(c,e.name);c[e.name]=e.state,t!==d(c,e.name)&&o.fire(e.name)}))})),d.bind(null,c));var c;window.TradingView.isFeatureEnabled=u},246445:(e,t,s)=>{"use strict";s.d(t,{emit:()=>d,emitOnce:()=>u,on:()=>l,subscribe:()=>h,unsubscribe:()=>a});var i=s(875500);const r={},n=[],o={};function a(e,t,s){r[e].unsubscribe(s,t)}function l(e,t,s){h(e,t,s)}function h(e,t,s,n){r.hasOwnProperty(e)||(r[e]=new i.Delegate),o[e]?t.call(s):r[e].subscribe(s,t,n)}function d(e,...t){const s=[e].concat(t);n.forEach((e=>{e.apply(null,s)})),r.hasOwnProperty(e)&&r[e].fire.apply(r[e],t)}function u(e){
o[e]&&console.warn(`Something went wrong: emitOnce called multiple times with same event (${e})`),o[e]=!0,d.apply(null,arguments)}},598944:(e,t,s)=>{"use strict";s.d(t,{getFreshInitData:()=>l,getInitData:()=>a,updateInitData:()=>o});var i=s(185842);const r=(0,s(77357).getLogger)("Common.InitData"),n=window.initData||{};function o(){window.initData&&window.initData!==n&&(Object.assign(n,window.initData),window.initData=n);const e=document.querySelectorAll('script[type="application/prs.init-data+json"]');for(let t=0;t<e.length;t++){const s=e[t];try{const e=JSON.parse((0,i.ensureNotNull)(s.textContent));Object.assign(n,e)}catch(e){r.logWarn(`Failed to parse initData element. ${e}`)}finally{(0,i.ensureNotNull)(s.parentNode).removeChild(s)}}n.content&&n.study_meta_info_map&&(n.content.studyMetaInfoMap={...n.content.studyMetaInfoMap,...n.study_meta_info_map})}function a(){return n}function l(){return o(),n}},795491:(e,t,s)=>{"use strict";s.d(t,{LogoSize:()=>i,getLogoUrlResolver:()=>l});var i,r=s(185842),n=s(598944);!function(e){e[e.Medium=0]="Medium",e[e.Large=1]="Large"}(i||(i={}));class o{constructor(e){(0,r.assert)(""!==e,"S3 base url must be a non-empty string"),this._baseUrl=e}getSymbolLogoUrl(e,t){switch((0,r.assert)(""!==e,"logo id must be a non-empty string"),t){case i.Medium:return this._baseUrl+`${e}.svg`;case i.Large:return this._baseUrl+`${e}--big.svg`}}collectSymbolLogoUrls(e,t){const{logoId:s,baseCurrencyLogoId:i,currencyLogoId:r,dexCurrencyLogoId:n}=e;if(s)return[this.getSymbolLogoUrl(s,t)];const o=[];if(i&&o.push(this.getSymbolLogoUrl(i,t)),n?o.push(this.getSymbolLogoUrl(n,t)):r&&o.push(this.getSymbolLogoUrl(r,t)),o.length<2)return o;const a=o.some(h),l=o.every((e=>!e.includes("country")||h(e)));return a&&l?o.filter((e=>!h(e))):o;function h(e){return e.includes("country/US")}}getCountryFlagUrl(e,t){return this.getSymbolLogoUrl("country/"+e,t)}getCryptoLogoUrl(e,t){return this.getSymbolLogoUrl("crypto/"+e,t)}getProviderLogoUrl(e,t){return this.getSymbolLogoUrl("provider/"+e,t)}getSourceLogoUrl(e,t){return this.getSymbolLogoUrl("source/"+e,t)}getBlockchainContractLogoUrl(e,t){return this.getSymbolLogoUrl("blockchain/"+e,t)}}let a;function l(){return function(){if(!a){const e=(0,n.getInitData)(),t=e.settings?e.settings.S3_LOGO_SERVICE_BASE_URL:"";a=new o(t)}return a}()}},784438:(e,t,s)=>{"use strict";function i(e){return e===r(e)}function r(e){const t=e.indexOf("$"),s=e.indexOf("@");return t<0&&s>=0?null:e.substring(Math.max(t+1,0),s>=0?s:e.length)}function n(e){return e.startsWith("PUB;")}function o(e){return e.startsWith("USER;")}function a(e){return e.startsWith("STD;")}function l(e){return e.includes("Candlestick%1Pattern%1")}function h(e){return e.startsWith("EDGR_")}s.d(t,{extractPineId:()=>r,isCandleStickId:()=>l,isCustomPineId:()=>o,isEdgrPineId:()=>h,isPineIdString:()=>i,isPublishedPineId:()=>n,isStandardPineId:()=>a})},190835:(e,t,s)=>{"use strict";const{isFeaturesetEnabled:i}=s(266150);window.TradingView=window.TradingView||{};var r,n,o,a,l,h,d,u=(n=Object.create(null),o=Object.create(null),
a=Object.create(null),l=0,h=0,d="TradingView",window.addEventListener&&window.addEventListener("message",(function(e){var t;try{t=JSON.parse(e.data),i("charting_library_debug_mode")&&console.log(`${(new Date).toISOString()} PostMessage: incoming message: `+JSON.stringify(t))}catch(e){return}if(t&&t.provider&&t.provider===d)if("get"===t.type){if(!o[t.name])return;o[t.name].forEach((function(e){"function"==typeof e&&e.call(t,t.data,(function(e){var s={id:t.id,type:"on",name:t.name,client_id:t.client_id,data:e,provider:d};r.postMessage(JSON.stringify(s),"*")}))}))}else if("on"===t.type)n[t.client_id]&&n[t.client_id][t.id]&&(n[t.client_id][t.id].call(t,t.data),delete n[t.client_id][t.id]);else if("post"===t.type){if(!o[t.name])return;o[t.name].forEach((function(e){"function"==typeof e&&e.call(t,t.data,(function(){}))}))}})),function(e,t){n[t]=Object.create(null),a[t]=e,r=e;var s="";return{on:function(e,t,s){o[e]&&s||(o[e]=[]),o[e].push(t)},get:function(e,s,i){var r={id:l++,type:"get",name:e,client_id:t,data:s,provider:d};n[t][r.id]=i,a[t].postMessage(JSON.stringify(r),"*")},post:function(e,t,i){var r={id:h++,type:"post",name:t,client_id:s,data:i,provider:d};e&&"function"==typeof e.postMessage&&e.postMessage(JSON.stringify(r),"*")},setClientId:function(e){s=e}}});e.exports=u},950808:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>Q,getBool:()=>E,getFloat:()=>F,getInt:()=>N,getJSON:()=>L,getValue:()=>R,keys:()=>O,keysMask:()=>W,loaded:()=>Y,loadedModel:()=>J,onSync:()=>K,remove:()=>k,setJSON:()=>B,setSettingsAdapter:()=>G,setValue:()=>M,sync:()=>$});var i=s(266150),r=s(77357),n=s(788312),o=s(231476),a=(s(376596),s(131890)),l=s(938429),h=s(813169),d=s(724226),u=s(875500);window.TradingView=window.TradingView||{};const c=["s.tradingview.com","betacdn.tradingview.com"],p=((0,i.isFeaturesetEnabled)("use_localstorage_for_settings"),"local"===window.environment?5e3:12e4),_=10,m=window.TradingView.onWidget?.()?"tradingview-widget":"tradingview",g=m+".";let y,f,b,S=!1,v=null,w={},x=[];const P=[/^widgetbar\.widget\.watchlist.+/,/.+quicks$/,/^widgetbar\.layout-settings$/,/^ChartSideToolbarWidget\.visible$/,/^onwidget\.watchlist$/,/^chart\.favoriteDrawings$/,/^chart\.favoriteDrawingsPosition$/,/^chart\.favoriteLibraryIndicators$/,/^loadChartDialog.favorites$/,/^ChartFavoriteDrawingToolbarWidget\.visible/,/^trading\.chart\.proterty$/,/^trading_floating_toolbar\.position$/,/^trading\.orderWidgetMode\./,/^symbolWatermark$/,/^pinereference\.size$/,/^pinereference\.position$/,/^hint\.+/,/^ChartDrawingToolbarWidget\.visible/];const C=()=>!(v||window.is_authenticated),T=e=>g+e,V=(0,r.getLogger)("Lib.TVSettings"),A=e=>{if(S||b)return;if((0,n.isFeatureEnabled)("disable_save_settings"))return void V?.logWarn("Settings flashing has been skipped because of disable_save_settings featuretoggle");if((0,i.isFeaturesetEnabled)("widget"))return;if(C())return;if(0===x.length)return;const t=x;x=[];const s={};for(let e=t.length;e--;){const i=t[e];s[i]=w[i]??null}const r=new FormData;r.append("delta",JSON.stringify(s)),
e&&navigator.sendBeacon?navigator.sendBeacon("/savesettings/",r):(0,a.fetch)("/savesettings/",{method:"POST",credentials:"include",body:r}).then((s=>{if(s.ok||(x=x.concat(t)),[429,503].includes(s.status)){const t=1e3*+(s.headers.get("retry-after")||0)||3e5;b=setTimeout((()=>{b=void 0,A(e)}),t)}})).catch((()=>{x=x.concat(t)}))},D=()=>{y=void 0,x.length&&A()},I=(e,t={})=>{if(v)null==w[e]?v.removeValue(e):v.setValue(e,w[e]);else if(C())try{null==w[e]?d.TVLocalStorage.removeItem(T(e)):d.TVLocalStorage.setItem(T(e),w[e])}catch(e){}else x.push(e),y||(y=setTimeout(D,p));t.skipCrossWindowEvent||h.TVXWindowEvents.emit("settings",JSON.stringify({key:e,value:w[e]}))};function R(e,t){const s=w[e];return s??t}function L(e,t){const s=R(e);if(null==s)return t;try{return JSON.parse(s)}catch(s){return k(e),t}}function k(e,t={}){return null!=w[e]&&(delete w[e],I(e)),t.forceFlush&&A(),X}function E(e,t){const s=R(e);return null==s?t:!(!s||"false"===s||0==+s)}function F(e,t){const s=R(e);if(null==s)return t;const i=parseFloat(s);if(!isFinite(i))throw new TypeError('"'+s+'" is not float (key: "'+e+'")');return i}function N(e,t){const s=R(e);if(null==s)return t;const i=parseInt(s,10);if(!isFinite(i))throw new TypeError('"'+s+'" is not int (key: "'+e+'")');return i}function M(e,t,s={}){const i=""+t;return w[e]!==i&&(w[e]=i,I(e,s)),s.forceFlush&&!f&&(f=setTimeout((()=>{f=void 0,A()}),_)),X}function B(e,t,s){return M(e,JSON.stringify(t),s),X}function O(){return Object.keys(w)}function W(e){const t=O(),s=[],i=new RegExp("^"+(0,l.regExpEscape)(e).replace(/\\\*\\\*/gi,".+").replace(/\\\*/gi,"[^.]+")+"$","gi");for(let e=t.length-1;e>=0;e--)i.test(t[e])&&s.push(t[e]),i.lastIndex=0;return s}h.TVXWindowEvents.on("settings",(e=>{const t=JSON.parse(e);null==t.value?delete w[t.key]:w[t.key]=t.value}));const z=e=>{for(let t=0;t<P.length;++t)if(P[t].exec(e))return!0;return!1},H=e=>e.substring(0,g.length)===g,j=()=>{w={};const e=!(0,i.isFeaturesetEnabled)("save_chart_properties_to_local_storage");for(let t=d.TVLocalStorage.length;t--;){const s=d.TVLocalStorage.key(t);if(!s||!H(s))continue;const i=s.substring(g.length);e&&!z(i)||(w[i]=d.TVLocalStorage.getItem(s))}},U=e=>{w={};const t=0===Object.keys(e).length;t||(e=>{Object.keys(e).forEach((t=>{w[t]=e[t]+""}))})(e),(e=>{for(let t=d.TVLocalStorage.length;t--;){const s=d.TVLocalStorage.key(t);s&&H(s)&&(e&&M(s.substring(g.length),d.TVLocalStorage.getItem(s)),d.TVLocalStorage.removeItem(s))}})(t)},q=()=>{if(!window.TradingView.onWidget?.()||!c.includes(window.location.host))return;const e="tradingview.";for(let t=d.TVLocalStorage.length;t--;){const s=d.TVLocalStorage.key(t);if(0===s.indexOf(e)){const t=s.replace(e,m+".");d.TVLocalStorage.setItem(t,d.TVLocalStorage.getItem(s)),d.TVLocalStorage.removeItem(s)}}},K=new u.Delegate;function $(e){null!==e?(v?U(v.initialSettings||{}):C()?(q(),j()):U(e||{}),K.fire()):S=!0}function G(e){v=e}const Y=!1,J=!1,X={loaded:Y,loadedModel:J,getValue:R,getJSON:L,getBool:E,getFloat:F,getInt:N,setValue:M,setJSON:B,remove:k,keys:O,keysMask:W,sync:$,onSync:K,setSettingsAdapter:G},Q=X
;window.TVSettings=X,document.addEventListener("visibilitychange",(()=>{"hidden"!==document.visibilityState&&!0!==document.hidden||A()})),window.addEventListener("pagehide",(()=>{A(!0)})),window.addEventListener("beforeunload",(()=>{A(!0)})),o.flushDelegate.subscribe(null,(()=>{A()})),setTimeout((async()=>{const{clearOldSettings:e}=await s.e(35980).then(s.bind(s,447436));e()}),3e4)},503888:(e,t,s)=>{"use strict";async function i(){const e=(await Promise.all([s.e(70644),s.e(66224),s.e(19886)]).then(s.bind(s,237529))).getTrackerInstance();return e||null}s.d(t,{getEmbedWidgetTracker:()=>i})},298147:(e,t,s)=>{"use strict";function i(e){return void 0!==e&&e.includes("crypto")}function r(e,t){return"spot"===e&&i(t)}function n(e,t){return"stock"===e&&t.includes("right")||"right"===e}function o(e,t){return a(e,t)||"stock"===e&&t.includes("fund")&&t.includes("etf")||"structured"===e&&t.includes("etn")}function a(e,t){return function(e,t){return"fund"===e&&t.includes("mutual")}(e,t)||"fund"===e&&t.includes("etf")}function l(e){return"bond"===e}function h(e,t){return"bond"===e&&t.includes("corporate")}function d(e){return"economic"===e}function u(e){return"option"===e}function c(e){return"dex"===e?.centralization}function p(e){return"spread"===e}function _(e){return"futures"===e}function m(e){return"forex"===e}function g(e,t,s){return i(t)&&"spot"===e&&"USD"===s}function y(e,t){return"spot"===e&&t.includes("cryptoasset")}function f(e,t){return Boolean("bond"===e&&t.includes("government")&&!t.includes("benchmark"))}function b(e){return Boolean(e.typespecs?.includes("yield"))}function S(e,t){return"stock"===e&&t.includes("common")||"stock"===e&&t.includes("preferred")||"stock"===e&&t.includes("forward")||"stock"===e&&t.includes("bonus")||"stock"===e&&t.includes("cfd")||"fund"===e&&t.includes("unit")||"fund"===e&&t.includes("trust")||"fund"===e&&t.includes("reit")||"fund"===e&&t.includes("etn")||"fund"===e&&t.includes("closedend")||"bond"===e&&t.includes("convertible")||"dr"===e||"warrant"===e||"structured"===e&&!t.includes("etn")}function v(e){return e?.includes("discontinued")??!1}function w(e,t=[]){return S(e,t)&&t.includes("pre-ipo")}s.d(t,{hasCryptoTypespec:()=>i,isBond:()=>l,isCorporateBond:()=>h,isCryptoSpot:()=>r,isCryptoSpotUsd:()=>g,isCryptoassetSpot:()=>y,isDex:()=>c,isEconomicSymbol:()=>d,isEtf:()=>o,isForexSymbol:()=>m,isFundEtf:()=>a,isFutures:()=>_,isGovernmentOnlyBond:()=>f,isOption:()=>u,isPreIpo:()=>w,isRight:()=>n,isSpread:()=>p,isStocksSymbol:()=>S,isSymbolDelisted:()=>v,isYield:()=>b})},493892:(e,t,s)=>{"use strict";s.r(t),s.d(t,{getIsoLanguageCodeFromLanguage:()=>r});const i={ar_AE:"ar",br:"pt",de_DE:"de",ca_ES:"ca",he_IL:"he",id_ID:"id",in:"en",kr:"ko",ms_MY:"ms",sv_SE:"sv",th_TH:"th",uk:"en",vi_VN:"vi",zh_CN:"zh-Hans",zh_TW:"zh-Hant",zh:"zh-Hans",hu_HU:"hu-HU"};function r(e){return i[e]||e}},913103:(e,t,s)=>{"use strict";s.d(t,{actualContent:()=>i});const i=new(s(336315).WatchedValue)(null)},732130:(e,t,s)=>{"use strict";var i;s.d(t,{CompareOption:()=>i}),function(e){e[e.SamePctScale=0]="SamePctScale",
e[e.NewPriceScale=1]="NewPriceScale",e[e.NewPane=2]="NewPane",e[e.SameScale=3]="SameScale"}(i||(i={}))},154406:(e,t,s)=>{"use strict";s.d(t,{currentLayout:()=>i});const i=new(s(336315).WatchedValue)(null)},704461:(e,t,s)=>{"use strict";s.d(t,{SYMBOL_LIST_REPOSITORY_BACKEND_SERVICE:()=>i});const i={id:"SymbolListRepositoryBackend"}},882619:(e,t,s)=>{"use strict";function i(e){const t=new Date(e);return t.setMilliseconds(0),t.setSeconds(0),t.setMinutes(0),t.setHours(0),t}function r(e){const t=new Date(e);return t.setMilliseconds(999),t.setSeconds(59),t.setMinutes(59),t.setHours(23),t}function n(e,t=!1){const s=i(e),r=t?function(e){if(e>6)throw new Error("Invalid day is provided");return 0===e?6:e-1}(s.getDay()):s.getDay();return s.setDate(s.getDate()-r),s}function o(e){const t=i(e);return t.setDate(1),t}function a(e){const t=o(e);return t.setMonth(0),t}s.d(t,{resetToDayEnd:()=>r,resetToDayStart:()=>i,resetToMonthStart:()=>o,resetToWeekStart:()=>n,resetToYearStart:()=>a})},661858:(e,t,s)=>{e.exports=[{name:s.i18next(null,{context:"symbols_type"},s(350146)),value:"",search_type:"undefined"},{name:s.i18next(null,{context:"symbols_type"},s(555510)),value:"stocks",search_type:"stocks"},{name:s.i18next(null,{context:"symbols_type"},s(564917)),value:"funds",search_type:"funds"},{name:s.i18next(null,{context:"symbols_type"},s(505079)),value:"futures",search_type:"futures"},{name:s.i18next(null,{context:"symbols_type"},s(97997)),value:"forex",search_type:"forex"},{name:s.i18next(null,{context:"symbols_type"},s(384597)),value:"cfd",search_type:"cfd"},{name:s.i18next(null,{context:"symbols_type"},s(655235)),value:"bitcoin,crypto",search_type:"crypto"},{name:s.i18next(null,{context:"symbols_type"},s(927411)),value:"index",search_type:"index"},{name:s.i18next(null,{context:"symbols_type"},s(765440)),value:"bond",search_type:"bond"},{name:s.i18next(null,{context:"symbols_type"},s(548322)),value:"economic",search_type:"economic"},{name:s.i18next(null,{context:"symbols_type"},s(79600)),value:"options",search_type:"options"}]},599961:e=>{e.exports={}},350710:(e,t,s)=>{"use strict";s.d(t,{AuthToken:()=>a});var i=s(77357),r=s(875500),n=s(131890);const o=(0,i.getLogger)("ChartApi.AuthToken",{color:"#173"});class a{constructor(){this.invalidated=new r.Delegate,this._tid=0,this._onGoingAuthTokenRequest=null,this._onOnline=()=>{o.logInfo("Online, new token will be fetched if needed"),this.get()},this._onVisibilityChange=()=>{"visible"===document.visibilityState&&(o.logInfo("Page visible, new token should be fetched"),this.get())},window.loginStateChange||(window.loginStateChange=new r.Delegate),window.loginStateChange.subscribe(this,(e=>{e||(this._set(window.user.auth_token),this.invalidated.fire())})),this._set(window.user.auth_token),window.addEventListener("online",this._onOnline),document.addEventListener("visibilitychange",this._onVisibilityChange)}destroy(){window.removeEventListener("online",this._onOnline),document.removeEventListener("visibilitychange",this._onVisibilityChange)}get(e){
return window.is_authenticated?!e&&performance.now()<this._cache.monoValidThru&&Date.now()<this._cache.wallValidThru?(o.logInfo(`Using cached token ${this._cache.token}`),Promise.resolve(this._cache.token)):window.navigator.onLine?this._onGoingAuthTokenRequest?this._onGoingAuthTokenRequest:this._onGoingAuthTokenRequest=this._fetch(Boolean(e),0).then((e=>{if(!window.is_authenticated)throw new Error("User logged out while the request was in flight");return this._set(e),e})).catch((e=>(o.logError(`Error fetching new token: ${e&&e.message}`),""))).finally((()=>{this._onGoingAuthTokenRequest=null})):(o.logWarn("Offline, cannot fetch new token, using cached token"),Promise.resolve(this._cache.token)):Promise.resolve("")}reset(){this._set(void 0),this.invalidated.fire()}_set(e){if(window.is_authenticated&&void 0!==e){const t=function(e){if(""===e)return 144e5;try{const t=JSON.parse(atob(e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"))),s=1e3*(t.exp-t.iat);if(!isFinite(s))throw new Error("invalid expiration");return Math.max(s-3e5,3e5)}catch(t){return o.logError(`${e} is invalid: ${t.message}`),144e5}}(e);this._cache={token:e,monoValidThru:performance.now()+t,wallValidThru:Date.now()+t},clearTimeout(this._tid),this._tid=setTimeout((()=>{window.navigator.onLine&&this.reset()}),t),o.logInfo(`Cached for ${t} ms: ${e}`)}else this._cache={token:"",monoValidThru:-1/0,wallValidThru:-1/0},clearTimeout(this._tid),o.logInfo("Cache dropped")}_fetch(e,t){return o.logNormal(`Fetching a new token, grabSession=${e}`),(0,n.fetch)("/quote_token/",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:e?"grabSession=true":""}).then((e=>{if(!e.ok)throw new Error(`Response status is not ok: ${e.status}`);return e.json().then(String)}),(s=>{if(t>=3)throw s;return o.logWarn("Request failed, will retry"),function(e){return new Promise((t=>setTimeout(t,1e3*e)))}(t).then((()=>this._fetch(e,t+1)))}))}}},797315:(e,t,s)=>{"use strict";s.d(t,{JSONDataHandler:()=>o});var i=s(868971);function r(e){return{index:e.i,value:e.v}}function n(e){for(const t of Object.keys(e)){const s=e[t];s.t&&(s.turnaround=e[t].t),"s"in e[t]&&e[t].s&&!s.series&&(s.series=e[t].s.map(r)),"st"in e[t]&&e[t].st&&!s.series&&(s.series=e[t].st.map(r))}}class o{set_broker(e){return[e]}set_data_quality(){return["low"]}quote_create_session(e){return[e]}quote_delete_session(e){return[e]}quote_set_fields(e,t){return[e].concat(t)}quote_add_symbols(e,t){return[e].concat(t)}quote_remove_symbols(e,t){return[e].concat(t)}quote_fast_symbols(e,t){return[e].concat(t)}quote_hibernate_all(e){return[e]}depth_create_session(e,t,s){return[e,t,s]}depth_delete_session(e){return[e]}depth_set_symbol(e,t){return[e,t]}depth_clear_symbol(e){return[e]}depth_set_scale(e,t){return[e,t]}chart_create_session(e,t){return[e,t?"disable_statistics":""]}chart_delete_session(e){return[e]}set_auth_token(e){return[e]}set_locale(e,t){return[e,t]}switch_timezone(e,t){return[e,t]}resolve_symbol(e,t,s){return[e,t,s]}create_series(e,t,s,i,r,n,o){return[e,t,s=s||"",i,r,n,o]}remove_series(e,t){
return[e,t]}modify_series(e,t,s,i,r,n){return[e,t,s=s||"",i,r,n]}request_more_data(e,t,s){return[e,t,s]}set_future_tickmarks_mode(e,t){return[e,t]}request_studies_metadata(e){return[e]}create_study(e,t,s,i,r,n){return[e,t,s=s||"",i,r].concat(n)}create_child_study(e,t,s,i,r,n){return this.create_study(e,t,s,i,r,n)}remove_study(e,t){return[e,t]}modify_study(e,t,s,i){return[e,t,s=s||""].concat(i)}notify_study(e,t,s,i){return[e,t,s=s||"",i]}create_pointset(e,t,s,i,r,n){return[e,t,s=s||"",i,r].concat(n)}modify_pointset(e,t,s,i){return[e,t,s=s||""].concat(i)}remove_pointset(e,t){return[e,t]}request_more_tickmarks(e,t,s){return[e,t,s]}get_first_bar_time(e,t,s){return[e,t,s]}replay_create_session(e){return[e]}replay_delete_session(e){return[e]}replay_reset(e,t,s){return[e,t,s]}replay_start(e,t,s){return[e,t,s]}replay_stop(e,t){return[e,t]}replay_step(e,t,s){return[e,t,s]}replay_add_series(e,t,s,i){return[e,t,s,i]}replay_remove_series(e,t,s,i){return[e,t,s,i]}replay_set_resolution(e,t,s){return[e,t,s]}replay_get_depth(e,t,s,i){return[e,t,s,i]}convertTimescaleResponse(e){const t=e.marks.map((e=>({span:e[0],time:e[1],index:e[2]}))),s=void 0===e.index_diff?[]:e.index_diff.map((e=>({old:e[0],new:e[1]})));return{...e,marks:t,index_diff:s,clear:0===e.changes.length&&0===s.length&&0===t.length}}getDataUpdateObjects(e){return e.params[0]}getTimescaleObjects(e){return e.params[0]}getTimescaleChangeset(e){return e.params[1]}prepareDataUpdateObjects(e,t,s){for(const[r,n]of Object.entries(t)){const t="plots"in n?n.plots:n.series,o={customId:r,turnaround:n.turnaround,plots:t};"ns"in n&&n.ns&&(o.nonseries=n.ns),"lbs"in n&&n.lbs&&(o.lastBar={closeTime:n.lbs.bar_close_time});for(const e of o.plots)for(const[t,s]of Object.entries(e.value))s&&Math.abs(s)>=1e100&&(e.value[+t]=void 0);s(e,r,{method:i.WebchartChartSessionResponseMethod.DataUpdate,params:o})}}unpack(e){const t=JSON.parse(e);t.m&&t.p&&(t.method=t.m,t.params=t.p,t.time=t.t);const s=t.params[1];switch(t.method){case"qsd":t.method="quote_symbol_data",s.symbolname=s.n,s.status=s.s,s.values=s.v,s.values.change=s.v.ch,s.values.last_price=s.v.lp,s.values.change_percent=s.v.chp,delete s.n,delete s.s,delete s.v,delete s.values.ch,delete s.values.lp,delete s.values.chp;break;case"du":t.method="data_update",n(s);break;case"clear_data":for(const e of Object.keys(s))s[e].turnaround=s[e].t;break;case"timescale_update":n(s)}return t}prepareEncodeMessage(e,t){return JSON.stringify({m:e,p:t})}request_data_problems(){return[]}}},998963:(e,t,s)=>{"use strict";s.d(t,{HandlerInfo:()=>i});class i{constructor(e,t,s){this.handler=e,this.customId=t,this.singleShot=s}}},868971:(e,t,s)=>{"use strict";var i,r,n;s.d(t,{WebchartChartSessionResponseMethod:()=>r,WebchartReplaySessionResponseMethod:()=>n,WebchartResponseMethod:()=>i}),function(e){e.RequestDataProblems="request_data_problems",e.ProtocolError="protocol_error",e.ProtocolSwitched="protocol_switched",e.CriticalError="critical_error"}(i||(i={})),function(e){e.StudiesMetadata="studies_metadata",e.TimeScaleUpdate="timescale_update",
e.TickMarkUpdate="tickmark_update",e.DU="du",e.DataUpdate="data_update",e.IndexUpdate="index_update",e.TimeScaleCompleted="timescale_completed",e.QSD="qsd",e.QuoteListField="quote_list_fields",e.QuoteSymbolData="quote_symbol_data",e.QuoteCompleted="quote_completed",e.DepthSymbolError="depth_symbol_error",e.DepthSymbolSuccess="depth_symbol_success",e.DepthData="dd",e.DepthDataUpdate="dpu",e.DepthBarLastValue="depth_bar_last_value",e.ClearData="clear_data",e.SeriesTimeFrame="series_timeframe",e.SymbolResolved="symbol_resolved",e.SeriesError="series_error",e.SeriesCompleted="series_completed",e.StudyLoading="study_loading"}(r||(r={})),function(e){e.ReplayError="replay_error",e.ReplayPoint="replay_point",e.ReplayOk="replay_ok",e.ReplayResolutions="replay_resolutions",e.ReplayDataEnd="replay_data_end",e.ReplayInstanceId="replay_instance_id",e.ReplayDepth="replay_depth"}(n||(n={}))},368321:(e,t,s)=>{"use strict";s.d(t,{isDrawingToolbarVisible:()=>l});var i=s(950808),r=s(266150),n=s(168509);const o=!(0,r.isFeaturesetEnabled)("hide_left_toolbar_by_default"),a=i.getBool("ChartDrawingToolbarWidget.visible",o),l=new n.WatchedValue(a)},683214:(e,t,s)=>{"use strict";s.d(t,{makeSnapshotRequest:()=>l,takeChartSnapshot:()=>a,takeChartSnapshotPromise:()=>o});s(686923);var i=s(729193),r=s(168705),n=s(131890);function o(e,t={}){return new Promise(((s,i)=>{a(e,s,i,t).catch(i)}))}async function a(e,t,s,i={}){const r=new FormData;if(void 0!==i.previews)for(const e of i.previews)r.append("previews[]",e);void 0!==i.cme&&r.append("cme",String(i.cme)),void 0!==i.wl&&r.append("wl",String(i.wl)),void 0!==i.onWidget&&r.append("onWidget",String(i.onWidget)),i.isReport&&r.append("isReport",String(i.isReport)),i.asyncSave&&r.append("asyncSave",String(i.asyncSave));const n=window.urlParams;n&&n.locale&&r.append("language",n.locale);const o=e.activeChartWidget.value(),a=o.widgetCustomer();void 0!==a&&r.append("customer",a);const h=o.model().model().timezoneExceptExchange().value()??"exchange";r.append("timezone",h),r.append("symbol",o.model().mainSeries().symbol());const d=await e.clientSnapshot({showHeaderMainSymbol:i.showHeaderMainSymbol}),u=await new Promise((e=>d.toBlob(e)));null!==u&&r.append("preparedImage",u),l(r,t,s,i)}async function l(e,t,o,a={}){try{const l=await(0,n.fetch)("/snapshot/",{body:e,method:"POST",credentials:"same-origin"}),h=await l.text();if(l.ok)t(h);else{if("suspicious_chart_snapshots_error"===h){const e=i.t(null,void 0,s(783835)).format({start_link:'<a class="tv-dialog__link js-send-report-link" href="#" data-issue-type="other">',end_link:"</a>"});a.onInvalidSnapshotImage&&a.onInvalidSnapshotImage();return(0,r.createErrorDialog)({title:i.t(null,void 0,s(435241)),content:e,btnType:"danger"}).then((e=>{e.on("afterOpen",(()=>{s.e(34189).then(s.bind(s,74762)).then((({bugDialogCreationHandler:t})=>{t(),e.$el.find(".js-send-report-link").click((()=>{e.close()}))}))})),e.open()}))}o()}}catch{o()}}},193867:(e,t,s)=>{"use strict";s.d(t,{DefaultProperty:()=>O,allowSavingDefaults:()=>D,cleanUpStateKeys:()=>T,createDefaultsState:()=>V,
extractAllPropertiesKeys:()=>I,extractState:()=>L,extractThemedColors:()=>k});var i=s(436492),r=s(209539),n=s(258906),o=s(939291),a=s(748607),l=s(720693),h=s(883991),d=s(90570),u=s(849084),c=s(750586),p=s(185842),_=s(955482),m=s(77357),g=s(921619),y=s(645303),f=s(513852),b=s(64906),S=s(875500),v=s(725408),w=s(253193),x=s(603550);const P=(0,m.getLogger)("ThemedDefaults");function C(e){return e.value()===y.StdTheme.Dark?y.StdTheme.Dark:y.StdTheme.Light}function T(e,t,s){for(const i of t)if((0,n.default)(e,i),s){const t=i.split(".");for(t.pop();t.length;){const s=(0,o.default)(e,t);if(!(0,u.default)(s)||0!==Object.keys(s).length)break;(0,n.default)(e,t),t.pop()}}}function V(e,t,s,n){const o=e?w.defaults:w.factoryDefaults,a=t.startsWith("study_")?(0,i.default)(o("study")):{};let l=(0,i.default)(o(t,n));return t.startsWith("study_")&&l.inputs&&delete l.inputs.symbol,"linetoolicon"===t&&e&&(l.icon=(0,w.defaults)(t).icon),"linetooemoji"===t&&e&&(l.emoji=(0,w.defaults)(t).emoji),"linetoolsticker"===t&&e&&(l.sticker=(0,w.defaults)(t).sticker),l=(0,i.default)(l),T(l,s),(0,r.default)(a,l),a}let A=!1;function D(e){A=e}function I(e){const t=Object.keys(e),s=[];return t.forEach((t=>{const i=e[t];if((0,u.default)(i)){I(i).forEach((e=>s.push(`${t}.${e}`)))}else s.push(t)})),s}function R(e,t,s=""){if(1===t.length&&"*"===t[0])return e;const i={};for(const r of t){const n=r.split("."),o=n[0],a=e[o],l=""===s?o:`${s}.${o}`;if(e.hasOwnProperty(o))if(n.length>1){if(!(0,u.default)(a)){P.logError(`path ${l} must be an object, but it is a primitive`);continue}{const e=t.filter((e=>e.startsWith(`${o}.`))).map((e=>e.split(".").slice(1).join(".")));i[o]=R(a,e,l)}}else{if((0,u.default)(a)){P.logError(`path ${l} must be a primitive, but it is an object`);continue}i[o]=a}}return i}function L(e,t,s){if(!e)return{};let i=e;return t&&(i=R(e,t)),s&&T(i,s,!0),i}function k(e,t){const s=I(e),i=[];for(const r of s){const s=(0,o.default)(e,r),n=(0,o.default)(t,r);(0,p.assert)(void 0!==s,`Light theme value for ${r} is undefined`),(0,p.assert)(void 0!==n,`Dark theme value for ${r} is undefined`),i.push({path:r,colors:[s,n]})}return i}function E(e,t){e.includes(t)||e.push(t)}function F(e,t){const s=e.indexOf(t);-1!==s&&e.splice(s,1)}function N(e,t){const s=(0,l.default)(e,((e,s,i)=>{if(void 0===t[i])return e;if(!(0,h.default)(s,t[i]))if((0,u.default)(s)&&(0,u.default)(t[i])){const r=N(s,t[i]);void 0!==r&&(e[i]=r)}else e[i]=s;return e}),{});return(0,d.default)(s)?void 0:s}function M(e){return e===y.StdTheme.Dark?1:0}function B(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(!(0,c.default)(e)||!(0,c.default)(t))return!1;const s=(0,_.tryParseRgba)(e),i=(0,_.tryParseRgba)(t);return!(!s||!i)&&!!(0,g.colorsAreCloseEnough)(e,t)}class O extends x.Property{constructor(e){
const{defaultName:t,nonThemedDefaultsKeys:s,themedDefaultsKeys:i,excludedDefaultsKeys:n=[],themedColors:o,replaceThemedColorsOnThemeChange:a=!1,allStateKeys:l,excludedStateKeys:h=[],excludedTemplateKeys:d=[],state:u,useUserPreferences:c=!0,saveNonDefaultUserPreferencesOnly:_=!1,ignoreAllowSavingDefaults:m=!1,alwaysSaveDefaultKeys:g=["version"],saveDefaultsConsumer:x=w.saveDefaults,factoryDefaultsSupplier:P=()=>V(!1,t,[],null),schema:T=(0,v.createPropertySchema)(P()),theme:A=f.watchedTheme.spawnOwnership()}=e;super(void 0,T),this._themedColors=[],this._restoreFactoryDefaultsEvent=new S.Delegate,this._replaceThemedColorsOnThemeChange=!1,this._forbidSavingDefaults=!1,this._defaultName=t,this._useUserPreferences=c,this._saveNonDefaultUserPreferencesOnly=_,this._ignoreAllowSavingDefaults=m,this._saveDefaultsConsumer=x,this._factoryDefaultsSupplier=P,this._allStateKeys=l,this._excludedStateKeys=h,this._nonThemedDefaultsKeys=s,this._themedDefaultsKeys=i,this._allDefaultsKeys=s||i?[...s??[],...i??[]]:void 0,this._excludedDefaultsKeys=n,this._excludedTemplateKeys=d,this._themedColors=o,this._alwaysSaveDefaultKeys=g,(0,p.assert)(void 0===this._allDefaultsKeys||0===this._excludedDefaultsKeys.length,"Defaults keys and excluded defaults keys cannot be used at the same time"),(0,p.assert)(void 0===this._allStateKeys||0===this._excludedStateKeys.length,"State keys and excluded state keys cannot be used at the same time"),this._theme=A;const D=C(this._theme);this.merge((0,r.default)(this._factoryDefaultsForTheme((0,b.isStdThemeName)(D)?D:y.StdTheme.Light),this._userSettings(),L(u,l,h))),o&&a&&this.setThemedColors(o),this._restoreFactoryDefaultsEvent=new S.Delegate}destroy(){this._theme?.release(),this._unsubscribeWatchedTheme?.(),super.destroy()}applyTemplate(e,t){this.mergeAndFire(L((0,r.default)((0,i.default)(t),e),this._allStateKeys,this._excludedTemplateKeys))}preferences(){return L(this.state(this._excludedDefaultsKeys),this._allDefaultsKeys)}template(){return L(this.state(void 0,4),void 0,this._excludedTemplateKeys)}mergePreferences(e){this.mergeAndFire(L(e,this._allDefaultsKeys,this._excludedDefaultsKeys))}addExcludedKey(e,t){1&t&&E(this._excludedDefaultsKeys,e),2&t&&E(this._excludedStateKeys,e),4&t&&E(this._excludedTemplateKeys,e)}removeExcludedKey(e,t){1&t&&F(this._excludedDefaultsKeys,e),2&t&&F(this._excludedStateKeys,e)}restoreFactoryDefaults(){const e=this.factoryDefaults();T(e,this._excludedDefaultsKeys),this.mergeAndFire(e),this._defaultName.startsWith("study_")&&!this._defaultName.startsWith("study_VbPFixed")||this._saveDefaultsConsumer(this._defaultName),this._restoreFactoryDefaultsEvent.fire()}onRestoreFactoryDefaults(){return this._restoreFactoryDefaultsEvent}saveDefaults(){if(!this._useUserPreferences||this._forbidSavingDefaults)return;let e;if(this._saveNonDefaultUserPreferencesOnly){const t=this.state(this._excludedDefaultsKeys),s=this.factoryDefaults();if(e=N(L(t,this._nonThemedDefaultsKeys),L(s,this._nonThemedDefaultsKeys,this._excludedDefaultsKeys)),this._alwaysSaveDefaultKeys.length){
const s=L(t,this._alwaysSaveDefaultKeys);e=e??{},(0,r.default)(e,s)}const i=this.themeDefaults(C(this._theme)),n=this.themeState(),o=N(n,i);(0,d.default)(o)||(e=e??{},(0,r.default)(e,n))}else e=this.preferences();this._saveDefaultsConsumer(this._defaultName,e)}themeDefaults(e){if(this._themedColors)return function(e,t){const s={},i=M(t);for(const{path:t,colors:r}of e)(0,a.default)(s,t,r[i]);return s}(this._themedColors,e===y.StdTheme.Dark?y.StdTheme.Dark:y.StdTheme.Light);return L(this._factoryDefaultsSupplier(),this._themedDefaultsKeys,this._excludedDefaultsKeys)}factoryDefaults(){return this._factoryDefaultsForTheme(C(this._theme))}themeState(){const e=super.state(this._excludedDefaultsKeys),t=this._themedColors;return L(e,t?t.map((e=>e.path)):this._themedDefaultsKeys)}allThemePropertiesAreDefault(e){(0,p.assert)(!!this._themedColors,"This method should not be called if themed colors are not set");return function(e,t,s=[]){for(const i of s){const s=i.path;if(!B((0,o.default)(e,s),(0,o.default)(t,s)))return!1}return!0}(this.themeState(),this.themeDefaults(e),this._themedColors)}clone(e){return new O(this._options())}setThemedColors(e){if(this._themedColors=e,void 0===this._unsubscribeWatchedTheme){const e=()=>{this._updateThemedColors(!1)};this._theme.subscribe(e),this._unsubscribeWatchedTheme=()=>this._theme.unsubscribe(e)}this._updateThemedColors(!0)}applyDefaultThemedProperties(e){this._themedColors&&this.mergeAndFire(this.themeDefaults(e))}state(e,t){return L(super.state([...this._excludedStateKeys,...e??[]],t),this._allStateKeys)}fullState(){return super.state()}_updateThemedColors(e){if(!this._themedColors)return;const t=C(this._theme),s=t===y.StdTheme.Light?y.StdTheme.Dark:y.StdTheme.Light;for(const i of this._themedColors){const r=(0,p.ensureDefined)(this.childByPath(i.path)),n=i.colors[M(s)];(""===r.value()||!e&&B(r.value(),n))&&r.setValue(i.colors[M(t)])}}_userSettings(){if(!this._useUserPreferences)return;const e=V(!0,this._defaultName,[],null);if(!e)return;return L((0,v.extractStateWithSchema)(e,this._schema,1),this._allDefaultsKeys,this._excludedDefaultsKeys)}_options(){return{defaultName:this._defaultName,factoryDefaultsSupplier:this._factoryDefaultsSupplier,state:this.state(),nonThemedDefaultsKeys:this._nonThemedDefaultsKeys,themedDefaultsKeys:this._themedDefaultsKeys,excludedDefaultsKeys:this._excludedDefaultsKeys,themedColors:this._themedColors,replaceThemedColorsOnThemeChange:this._replaceThemedColorsOnThemeChange,allStateKeys:this._allStateKeys,excludedStateKeys:this._excludedDefaultsKeys,excludedTemplateKeys:this._excludedTemplateKeys,useUserPreferences:this._useUserPreferences,saveNonDefaultUserPreferencesOnly:this._saveNonDefaultUserPreferencesOnly,ignoreAllowSavingDefaults:this._ignoreAllowSavingDefaults,saveDefaultsConsumer:this._saveDefaultsConsumer,alwaysSaveDefaultKeys:this._alwaysSaveDefaultKeys,theme:this._theme.spawnOwnership()}}_childChanged(e,t){super._childChanged(e,t),this._propertyAffectsDefaults(t)&&this.saveDefaults()}_fireMergeAndFireChangedProps(e){
this._forbidSavingDefaults=!0,super._fireMergeAndFireChangedProps(e),this._forbidSavingDefaults=!1,e.some((e=>this._propertyAffectsDefaults(e.pathToRootProperty())))&&this.saveDefaults()}_factoryDefaultsForTheme(e){return(0,r.default)(this._factoryDefaultsSupplier(),this.themeDefaults(e))}_propertyAffectsDefaults(e){return(this._ignoreAllowSavingDefaults||A)&&!this._defaultName.startsWith("replayStudyStrategy")&&(!this._defaultName.startsWith("study_")||this._defaultName.startsWith("study_VbPFixed"))&&(this._allDefaultsKeys&&this._allDefaultsKeys.includes(e)||!this._allDefaultsKeys&&!this._excludedDefaultsKeys?.includes(e))&&(0,x.isPrimitiveType)(this.childByPath(e)?.value())}}},578107:(e,t,s)=>{"use strict";s.d(t,{drawSelection:()=>o,getSymbolCoordinatesInfo:()=>n});var i=s(196768),r=s(320093);function n(e){const{symbolPosition:t,textWidth:s,textByLines:n,lineHeight:o,font:a,textAlign:l,lineSpacing:h=0}=e;let[d,u]=function(e,t){let s=0;switch(e){case"center":s=t/2;break;case"start":s=(0,i.isRtl)()?t:0;break;case"end":s=(0,i.isRtl)()?0:t;break;case"right":s=t}return[s,0]}(l,s);const c=(0,i.isRtl)(),p=o+h;let _=0,m=0,g="";for(let e=0;e<n.length;e++){let i=t-_;const{wrappedLinePart:o,wrappedLineEnd:h,hidden:y,text:f}=n[e],b=e<n.length-1?n[e+1]:null;if(y||(g=f),b&&i>f.length){_+=f.length+(o&&!h?0:1),y||(u+=p);continue}y&&(u-=p);const S=o&&!h&&f.length===i&&b&&!b.hidden;if(y&&(g+="â€¯",i=g.length),"center"===l)if(S)d=s/2;else{const e=(0,r.measureText)(g,a).width,t=(0,r.measureText)(g.slice(0,i),a).width,n=s/2;d=c?n+e/2-t:n-e/2+t}else if("right"===l&&!c||"left"===l&&c||"end"===l)if(S)d=s;else{const e=(0,r.measureText)(g.slice(i),a).width;d=c?e:s-e}else if(S)d=0;else{const e=(0,r.measureText)(g.slice(0,i),a).width;d=c?s-e:e}S?(m=e+1,u+=p):m=e;break}return{x:d,y:u,lineNumber:m}}function o(e,t,s){const{lines:n,selectionStart:o,selectionEnd:l,left:h,right:d,color:u,font:c,lineHeight:p,lineSpacing:_=0}=s;e.save();const m=(h+d)/2,g=p+_,y=(0,i.isRtl)();e.fillStyle=u;const{horizontalPixelRatio:f,verticalPixelRatio:b}=t;if(o.lineNumber===l.lineNumber){const t=Math.round(o.x*f),s=Math.round(o.y*b),i=Math.round(l.x*f);e.fillRect(Math.min(t,i),s,Math.abs(t-i),Math.round(g*b))}else{const t=(0,r.measureText)(" ",c).width;let s=0;for(let i=o.lineNumber;i<=l.lineNumber;i+=1){const r=i===o.lineNumber,u=i===l.lineNumber,p=n[i];if(p.hidden)continue;const _=a(p.text,c);let S,v,w=!1;"center"===e.textAlign?(S=r?o.x:y?m+_/2:m-_/2,v=u?l.x:y?m-_/2:m+_/2):"right"===e.textAlign||y&&"start"===e.textAlign||!y&&"end"===e.textAlign?(S=r?o.x:d-_,v=u?l.x:d,w=!0):(S=r?o.x:h,v=u?l.x:h+_);let x=Math.min(S,v),P=Math.max(S,v);u||p.wrappedLinePart&&!p.wrappedLineEnd||(w?x-=t:P+=t);const C=Math.round(x*f),T=Math.round(P*f),V=Math.round((o.y+s*g)*b),A=Math.round((o.y+(s+1)*g)*b);e.fillRect(C,V,T-C,A-V),s+=1}}e.restore()}function a(e,t){return(0,r.measureText)(e,t).width}},727724:(e,t,s)=>{"use strict";s.d(t,{isLineTool:()=>r});var i=s(422872);function r(e){return(0,i.isObject)(e)&&"isLineTool"in e&&e.isLineTool}},550837:(e,t,s)=>{"use strict";s.d(t,{
BitmapCoordinatesPaneRenderer:()=>r});var i=s(425860);class r{draw(e,t){new i.CanvasRenderingTarget2D(e,t.mediaSize,t.bitmapSize).useBitmapCoordinateSpace((e=>this._drawImpl(e)))}drawBackground(e,t){new i.CanvasRenderingTarget2D(e,t.mediaSize,t.bitmapSize).useBitmapCoordinateSpace((e=>this._drawBackgroundImpl(e)))}_drawBackgroundImpl(e){}}},449938:(e,t,s)=>{"use strict";s.d(t,{CompositeRenderer:()=>i});class i{constructor(){this._renderers=[],this._globalAlpha=1}setGlobalAlpha(e){this._globalAlpha=e}append(e){e&&this._renderers.push(e)}insert(e,t){this._renderers.splice(t,0,e)}clear(){this._renderers.length=0}isEmpty(){return 0===this._renderers.length}draw(e,t){for(let s=0;s<this._renderers.length;s++)e.save(),e.globalAlpha=this._globalAlpha,this._renderers[s].draw(e,t),e.restore()}drawBackground(e,t){e.save(),e.globalAlpha=this._globalAlpha;for(let s=0;s<this._renderers.length;s++){const i=this._renderers[s];i.drawBackground&&i.drawBackground(e,t)}e.restore()}hitTest(e,t){let s=null;for(let i=this._renderers.length-1;i>=0;i--){const r=this._renderers[i].hitTest(e,t);null!==r&&(null===s||r.target()>s.target())&&(s=r)}return s}doesIntersectWithBox(e,t){return this._renderers.some((s=>!!s.doesIntersectWithBox&&s.doesIntersectWithBox(e,t)))}}},851682:(e,t,s)=>{"use strict";s.d(t,{MediaCoordinatesPaneRenderer:()=>r});var i=s(425860);class r{draw(e,t){new i.CanvasRenderingTarget2D(e,t.mediaSize,t.bitmapSize).useMediaCoordinateSpace((e=>this._drawImpl(e)))}drawBackground(e,t){new i.CanvasRenderingTarget2D(e,t.mediaSize,t.bitmapSize).useMediaCoordinateSpace((e=>this._drawBackgroundImpl(e)))}_drawBackgroundImpl(e){}}},659134:(e,t,s)=>{"use strict";s.d(t,{TextRenderer:()=>V,calculateLabelPosition:()=>_,fontSize:()=>x,getTextAlignInBox:()=>T,getTextBoundaries:()=>m,lineSpacing:()=>w,needTextExclusionPath:()=>g});var i=s(657415),r=s(185842),n=s(691069),o=s(196768),a=s(593859),l=s(141463),h=s(138264),d=s(578107),u=s(320093),c=s(593026),p=s(186263);function _(e,t,s,r,n){const o=.5*(t.x+s.x);let a=s.y;return t.y>s.y?(a-=e.height/2+r.y,a=Math.max(e.height/2,a)):(a+=e.height/2+r.y,a=Math.min(n-e.height/2,a)),new i.Point(o,a)}function m(e,t,s){if(e.isOutOfScreen(t,s))return null;const i=e.getPolygonPoints();return 0===i.length?null:i}function g(e){const t=e.getLinesInfo().lines;if(t.length%2==0)return!1;if(""===t[Math.floor(t.length/2)].text.trim())return!1;return!0}function y(e,t,s){if(0===s)return e.clone();const r=(e.x-t.x)*Math.cos(s)-(e.y-t.y)*Math.sin(s)+t.x,n=(e.x-t.x)*Math.sin(s)+(e.y-t.y)*Math.cos(s)+t.y;return(0,i.point)(r,n)}function f(e){return void 0!==e.boxPaddingVert?e.boxPaddingVert*C(e):void 0!==e.boxPadding?e.boxPadding*C(e):x(e)/3}function b(e){return void 0!==e.boxPaddingHorz?e.boxPaddingHorz*C(e):void 0!==e.boxPadding?e.boxPadding*C(e):x(e)/3}function S(e){return void 0!==e.boxPaddingLeft?e.boxPaddingLeft*C(e):b(e)}function v(e){return void 0!==e.boxPaddingRight?e.boxPaddingRight*C(e):b(e)}function w(e){let t=e.lineSpacing;return void 0===t&&e.lineHeight&&(t=(e.lineHeight-1)*P(e)),(t??0)*C(e)}function x(e){
return Math.ceil(P(e)*C(e))}function P(e){return e.fontsize||e.fontSize||30}function C(e){const t=Math.min(1,Math.max(.2,e.scale||1));if(1===t)return t;const s=P(e);return Math.ceil(t*s)/s}function T(e){const{horzAlign:t,extendLeft:s=!1,extendRight:r=!1,width:n,leftPoint:o,rightPoint:l}=e,h=(o.x<=n||s)&&(l.x>=0||r);let d,u,c=t;switch(c){case a.HorizontalAlign.Left:u=o.y,s?d=h?0:l.x:(d=o.x,c=a.HorizontalAlign.Right);break;case a.HorizontalAlign.Right:u=l.y,r?d=h?n:o.x:(d=l.x,c=a.HorizontalAlign.Left);break;default:d=((s&&h?0:o.x)+(r&&h?n:l.x))/2,u=(o.y+l.y)/2;break}return[(0,i.point)(d,u),c]}class V{constructor(e,t){this._data=null,this._textWidthCache=new c.TextWidthCache,this._internalData=null,this._boxSize=null,this._box=null,this._polygonPoints=null,this._linesInfo=null,this._fontInfo=null,this._centerTextRotationPoint=null,this._rotationPoint=null,this._wordWrap=(0,p.wordWrapCached)(),this._hitTest=t||new l.HitTestResult(l.HitTarget.MovePoint,{areaName:l.AreaName.Text}),void 0!==e&&this.setData(e)}setHitTest(e){this._hitTest=e}data(){return this._data}updateData(e){this.setData({...(0,r.ensureNotNull)(this._data),...e})}setData(e){null!==e?((0,r.assert)(!e.decorator||void 0===e.wordWrapWidth,"Decorator is not supported with wordWrapWidth"),void 0===e.text&&(e.text=""),e.horzTextAlign||(e.horzTextAlign=e.horzAlign),!function(e,t){if(null===e||null===t)return null===e==(null===t);if(void 0===e.points!=(void 0===t.points))return!1;if(void 0!==e.points&&void 0!==t.points){if(e.points.length!==t.points.length)return!1;for(let r=0;r<e.points.length;++r)if(s=e.points[r],i=t.points[r],s.x!==i.x||s.y!==i.y)return!1}var s,i;return e.text===t.text&&e.decorator===t.decorator&&e.vertAlign===t.vertAlign&&e.horzAlign===t.horzAlign&&e.horzTextAlign===t.horzTextAlign&&e.font===t.font&&e.offsetX===t.offsetX&&e.offsetY===t.offsetY&&e.bold===t.bold&&e.italic===t.italic&&e.fontsize===t.fontsize&&e.fontSize===t.fontSize&&e.backgroundRoundRect===t.backgroundRoundRect&&e.forceTextAlign===t.forceTextAlign&&e.wordWrapWidth===t.wordWrapWidth&&e.forceCalculateMaxLineWidth===t.forceCalculateMaxLineWidth&&e.lineHeight===t.lineHeight&&e.lineSpacing===t.lineSpacing&&e.scale===t.scale&&e.boxPadding===t.boxPadding&&e.boxPaddingVert===t.boxPaddingVert&&e.boxPaddingLeft===t.boxPaddingLeft&&e.boxPaddingRight===t.boxPaddingRight&&e.boxPaddingHorz===t.boxPaddingHorz&&e.angle===t.angle&&e.maxHeight===t.maxHeight&&e.outlineBorder?.width===t.outlineBorder?.width&&e.outlineBorder?.color===t.outlineBorder?.color}(this._data,e)?(this._data=e,this._internalData=null,this._boxSize=null,this._polygonPoints=null,this._centerTextRotationPoint=null,this._rotationPoint=null,this._linesInfo=null,this._fontInfo=null,this._box=null):this._data=e):this._data=null}hitTest(e){return null===this._data||void 0===this._data.points||0===this._data.points.length?null:(0,n.pointInPolygon)(e,this.getPolygonPoints())?this._hitTest:null}doesIntersectWithBox(e){return null!==this._data&&void 0!==this._data.points&&0!==this._data.points.length&&(0,
n.pointInBox)(this._data.points[0],e)}measure(){if(null===this._data)return{boxWidth:0,boxHeight:0,width:0,height:0};const e=this._getBoxSize();return{boxWidth:e.boxWidth,boxHeight:e.boxHeight,width:e.textBoxWidth,height:e.textBoxHeight}}rect(){if(null===this._data)return{x:0,y:0,width:0,height:0};const{boxLeft:e,boxTop:t,boxWidth:s,boxHeight:i}=this._getBox();return{x:e,y:t,width:s,height:i}}isOutOfScreen(e,t){if(null===this._data||void 0===this._data.points||0===this._data.points.length)return!0;const{boxLeft:s,boxWidth:r}=this._getBox();if(s+r<0||s>e){const s=(0,i.box)((0,i.point)(0,0),(0,i.point)(e,t));return this.getPolygonPoints().every((e=>!(0,n.pointInBox)(e,s)))}return!1}setPoints(e,t){(0,r.ensureNotNull)(this._data).points=e,this._hitTest=t||new l.HitTestResult(l.HitTarget.MovePoint)}setPoint(e,t,s){const i=(0,r.ensureNotNull)(this._data);this.setData({...i,points:[e],offsetX:t??i.offsetX,offsetY:s??i.offsetY})}point(){return this._data?.points?.[0]??null}fontStyle(e){return null===this._data?"":this._getFontInfo().fontStyle}lineHeight(){return null===this._data?0:x(this._data)}lineSpacing(){return null===this._data?0:w(this._data)}draw(e,t){if(null===this._data||void 0===this._data.points||0===this._data.points.length)return;const{mediaSize:s,horizontalPixelRatio:n,verticalPixelRatio:o}=t;if(this.isOutOfScreen(s.width,s.height))return;const a=this._getInternalData(),l=(0,r.ensureNotNull)(this.rotation()),d=(0,i.point)(l.x*n,l.y*o);e.save(),0!==l.angle&&(e.translate(d.x,d.y),e.rotate(l.angle),e.translate(-d.x,-d.y));const c=this._getFontInfo().fontSize;e.textBaseline=a.textBaseLine,e.textAlign=a.textAlign,e.font=this.fontStyle();const{scaledLeft:p,scaledRight:_,scaledTop:m,scaledBottom:g}=function(e,t){const{horizontalPixelRatio:s,verticalPixelRatio:i}=t,r=Math.round(e.boxLeft*s),n=Math.round(e.boxTop*i);return{scaledLeft:r,scaledRight:r+Math.round(e.boxWidth*s),scaledTop:n,scaledBottom:n+Math.round(e.boxHeight*i)}}(a,t),y=this._data.borderWidth||Math.max(c/12,1),f=Math.round(y*n),b=f/2;if(this._data.backgroundColor||this._data.borderColor){let t=!1;if(this._data.boxShadow){e.save();const{shadowColor:s,shadowBlur:i,shadowOffsetX:r=0,shadowOffsetY:a=0}=this._data.boxShadow;e.shadowColor=s,e.shadowBlur=i*n,e.shadowOffsetX=r*n,e.shadowOffsetY=a*o,t=!0}if(this._data.backgroundRoundRect){const{borderColor:s,backgroundColor:i,backgroundRoundRect:r}=this._data;i&&((0,h.drawRoundRect)(e,p,m,_-p,g-m,r*n),e.closePath(),e.fillStyle=i,e.fill(),t&&(e.restore(),t=!1)),s&&((0,h.drawRoundRect)(e,p-b,m-b,_-p+f,g-m+f,r*n+f),e.closePath(),e.strokeStyle=s,e.lineWidth=f,e.stroke(),t&&e.restore())}else{const{borderColor:s,backgroundColor:i}=this._data;i&&(e.fillStyle=i,e.fillRect(p,m,_-p,g-m),t&&(e.restore(),t=!1)),s&&(e.strokeStyle=s,e.lineWidth=f,e.beginPath(),e.moveTo(p-b,m-b),e.lineTo(p-b,g+b),e.lineTo(_+b,g+b),e.lineTo(_+b,m-b),e.lineTo(p-b,m-b),e.closePath(),e.stroke(),t&&e.restore())}}this._drawSelectionIfNeeded(e,t),e.fillStyle=this._data.color;const S=(p+Math.round(a.textHorizStart*n))/n,v=.05*c
;let x=(m+Math.round((a.textVertStart+v)*o))/o;const P=w(this._data),C=this.getLinesInfo();for(const t of C.lines)(0,u.drawScaled)(e,n,o,(()=>e.fillText(t.text,S,x))),x+=c+P;if(this._data.decorator?.draw(e,t,this._data,a),this._data.outlineBorder){const{outlineBorder:{width:t,color:s}}=this._data,i=Math.round(t*n),r=this._data.borderColor?f:0,o={x:p-r,y:m-r,w:_-p+2*r,h:g-m+2*r},a=new Path2D;a.rect(o.x-i,o.y-i,o.w+2*i,o.h+2*i),a.rect(o.x,o.y,o.w,o.h),e.fillStyle=s,e.fill(a,"evenodd")}e.restore()}getPolygonPoints(){if(null!==this._polygonPoints)return this._polygonPoints;if(null===this._data)return[];const e=this._data.angle||0,{boxLeft:t,boxTop:s,boxWidth:r,boxHeight:n}=this._getBox(),o=this._getRotationPoint();return this._polygonPoints=[y((0,i.point)(t,s),o,e),y((0,i.point)(t+r,s),o,e),y((0,i.point)(t+r,s+n),o,e),y((0,i.point)(t,s+n),o,e)],this._polygonPoints}centerTextRotation(){if(null===this._centerTextRotationPoint&&null!==this._data){const e=this._data.angle??0,t=this._getRotationPoint(),{textLeft:s,textTop:r,textRight:n,textBottom:o}=this._getInternalData(),a=y((0,i.point)((s+n)/2,(r+o)/2),t,e);this._centerTextRotationPoint={x:a.x,y:a.y,angle:e}}return this._centerTextRotationPoint}rotation(){if(null===this._rotationPoint&&null!==this._data){const e=this._data.angle??0,t=this._getRotationPoint();this._rotationPoint={x:t.x,y:t.y,angle:e}}return this._rotationPoint}getLinesInfo(){if(null===this._linesInfo){const e=(0,r.ensureNotNull)(this._data),t=this._wordWrap(e.text,this.fontStyle(),this._textWidthCache,!1,e.wordWrapWidth);let s=t.filter((e=>!e.hidden));if(void 0!==e.maxHeight){const t=function(e){const t=(0,r.ensureDefined)(e.maxHeight),s=x(e),i=w(e);return Math.floor((t+i)/(s+i))}(e);s.length>t&&(s=s.slice(0,t))}this._linesInfo={linesMaxWidth:this._getLinesMaxWidth(s),linesIncludingHidden:t,lines:s}}return this._linesInfo}positionToCoordinate(e){const t=(0,r.ensureNotNull)(this._data),s=this._getInternalData(),i=this.getLinesInfo(),{x:n,y:o,lineNumber:a}=(0,d.getSymbolCoordinatesInfo)({symbolPosition:e,textWidth:s.textRight-s.textLeft,textByLines:i.linesIncludingHidden,lineHeight:x(t),font:this.fontStyle(),textAlign:s.textAlign,lineSpacing:this.lineSpacing()});return{x:n+s.textLeft,y:o+s.textTop,lineNumber:a}}_getInternalData(){if(null!==this._internalData)return this._internalData;const e=(0,r.ensureNotNull)(this._data),{boxLeft:t,boxTop:s,boxWidth:i,boxHeight:n,textBoxWidth:l,textBoxHeight:h}=this._getBox(),d=S(e),u=v(e),c=f(e),p=e.decorator?.geometry(e),_=p?.width??0,m=0===e.text.length?0:p?.decoratorAndTextMargin??0,g=p?.ignoreRtl,y=_+m;let b;const w=s+c+x(e)/2;let P;const C=(0,o.isRtl)(),T=C&&!g,V=T?t+i-u-_:t+d;switch((0,r.ensureDefined)(e.horzTextAlign)){case a.HorizontalAlign.Left:P="start",b=V+y,C&&(e.forceTextAlign?P="left":(b=T?V-m:t+i-u,P="right"));break;case a.HorizontalAlign.Center:P="center";const s=i-d-u-y;b=T?V-m-s/2:V+y+s/2;break;case a.HorizontalAlign.Right:P="end",b=T?V-m:t+i-u,C&&e.forceTextAlign&&(P="right")}return this._internalData={boxLeft:t,boxTop:s,boxWidth:i,boxHeight:n,
textBoxWidth:l,textBoxHeight:h,textLeft:t+d+(T?0:y),textRight:t+i-u-(T?y:0),textTop:s+c,textBottom:s+n-c,textHorizStart:b-t,textVertStart:w-s,textAlign:P,textBaseLine:"middle",decoratorLeft:V,decoratorWidth:_},this._internalData}_getFontInfo(){if(null===this._fontInfo){const e=(0,r.ensureNotNull)(this._data),t=x(e),s=`${e.bold?"bold ":""}${e.italic?"italic ":""}${t}px ${e.font}`;this._fontInfo={fontStyle:s,fontSize:t}}return this._fontInfo}_drawSelectionIfNeeded(e,t){const s=(0,r.ensureNotNull)(this._data),i=x((0,r.ensureNotNull)(this._data));if(s.selectionHighlight){const r=this.positionToCoordinate(s.selectionHighlight.start),n=this.positionToCoordinate(s.selectionHighlight.end),o=this._getInternalData();(0,d.drawSelection)(e,t,{lines:this.getLinesInfo().linesIncludingHidden,selectionStart:r,selectionEnd:n,left:o.textLeft,right:o.textRight,color:s.selectionHighlight.color,font:this.fontStyle(),lineHeight:i,lineSpacing:this.lineSpacing()})}}_getLinesMaxWidth(e){const t=this.fontStyle();if(null!==this._data&&this._data.wordWrapWidth&&!this._data.forceCalculateMaxLineWidth)return this._data.wordWrapWidth*C(this._data);let s=0;for(const i of e)s=Math.max(s,(0,u.measureText)(i.text,t,this._textWidthCache).width);return s}_getBoxSize(){if(null===this._boxSize){const e=this.getLinesInfo(),t=(0,r.ensureNotNull)(this._data),s=function(e,t){const s=e.decorator?.geometry(e),i=Math.round(t+S(e)+v(e)+(s?.width??0)+(0===e.text.length?0:s?.decoratorAndTextMargin??0));return i%2?i+1:i}(t,e.linesMaxWidth),i=function(e,t){return x(e)*t+w(e)*(t-1)+2*f(e)}(t,e.lines.length);this._boxSize={textBoxWidth:s,textBoxHeight:i,boxWidth:t.boxWidth??s,boxHeight:t.boxHeight??i}}return this._boxSize}_getBox(){if(this._box)return this._box;const e=(0,r.ensureNotNull)(this._data),[t]=(0,r.ensureDefined)(e.points),{boxWidth:s,boxHeight:i,textBoxWidth:n,textBoxHeight:o}=this._getBoxSize();let{y:l,x:h}=t;switch(e.vertAlign){case a.VerticalAlign.Bottom:l-=i+e.offsetY;break;case a.VerticalAlign.Middle:l-=i/2;break;case a.VerticalAlign.Top:l+=e.offsetY}switch(e.horzAlign){case a.HorizontalAlign.Left:h+=e.offsetX;break;case a.HorizontalAlign.Center:h-=s/2;break;case a.HorizontalAlign.Right:h-=s+e.offsetX}return this._box={boxLeft:h,boxTop:l,boxWidth:s,boxHeight:i,textBoxWidth:n,textBoxHeight:o}}_getRotationPoint(){const{boxLeft:e,boxTop:t,boxWidth:s,boxHeight:n}=this._getBox(),{horzAlign:o,vertAlign:l}=(0,r.ensureNotNull)(this._data);let h,d;switch(o){case a.HorizontalAlign.Center:h=e+s/2;break;case a.HorizontalAlign.Left:h=e;break;case a.HorizontalAlign.Right:h=e+s}switch(l){case a.VerticalAlign.Middle:d=t+n/2;break;case a.VerticalAlign.Top:d=t;break;case a.VerticalAlign.Bottom:d=t+n}return(0,i.point)(h,d)}}},186263:(e,t,s)=>{"use strict";s.d(t,{wordWrapCached:()=>a});var i=s(904003),r=s(164680),n=s(192516);function o(e,t,s,i=!0,r){return`${t}_${i}_${r}_${e}`}function a(e=10){const t=i.default.Cache;i.default.Cache=r.CircularCacheBuffer.bind(r.CircularCacheBuffer,e);const s=(0,i.default)(n.wordWrap,o);return i.default.Cache=t,s}},192516:(e,t,s)=>{
"use strict";s.d(t,{wordWrap:()=>l});var i=s(385955),r=s(259611),n=s(320093);function o(e){const t=[];do{const s=e.match(/\s+/);if(!s||void 0===s.index||-1===s.index){t.push({word:e,spaces:""});break}t.push({word:e.slice(0,s.index),spaces:s[0]}),e=e.slice(s.index+s[0].length)}while(e.length);return t}function a(e,t,s,i){const o=[],a=[];for(let t=0;t<e.length;++t)a.push(t);for(;e.length;){const l=Math.max(1,(0,r.upperbound)(a,i,((i,r)=>(0,n.measureText)(e.slice(0,r+1),t,s).width>i),0,e.length));o.push(e.slice(0,l)),e=e.slice(l)}return o}function l(e,t,s,r=!0,l){l=(0,i.isString)(l)?parseInt(l):l;const h=(e+="").split(/\r\n|\r|\n|$/).map((e=>({text:e,hidden:!1,wrappedLinePart:!1,wrappedLineEnd:!1})));if(!(0,i.isNumber)(l)||!isFinite(l)||l<=0)return h;if((0,n.measureText)("x",t,s).width>l)return h;const d=[];for(let e=0;e<h.length;e++){const i=h[e];if((0,n.measureText)(i.text,t,s).width<=l){d.push(i);continue}const u=o(i.text),c=!0;let p="",_=0;for(;_<u.length;){const e=u[_];let i=`${p}${e.word}`,o=(0,n.measureText)(i,t,s).width;if(o>l){if(""!==p)d.push({text:p,hidden:!1,wrappedLinePart:c,wrappedLineEnd:!1}),p="";else if(1===i.length)d.push({text:i,hidden:!1,wrappedLinePart:c,wrappedLineEnd:!0}),e.word="";else{const r=a(i,t,s,l);for(let e=0;e<r.length-1;e+=1)d.push({text:r[e],hidden:!1,wrappedLinePart:c,wrappedLineEnd:!1});e.word=r[r.length-1]}continue}let h=i.length;if(i=`${p}${e.word}${e.spaces}`,o=(0,n.measureText)(i,t,s).width,o<l){p=i,_+=1;continue}const m=a(i,t,s,l);for(let e=0;e<m.length;e+=1){const t=m[e];h-=t.length;const s={text:t,hidden:e>0,wrappedLinePart:c,wrappedLineEnd:_===u.length-1&&e===m.length-1};s.hidden&&r||d.push(s)}p="",_+=1}""!==p&&d.push({text:p,wrappedLinePart:c,hidden:!1,wrappedLineEnd:!0})}return d}},229321:(e,t,s)=>{"use strict";s.d(t,{getDefaultResolutions:()=>n});var i=s(266150),r=s(205356);function n(){const e=["1","3","5","15","30","45","60","120","180","240","1D","1W","1M","3M","6M","12M","1R","10R","100R","1000R"];if(!(0,i.isFeaturesetEnabled)("widget")){let t=["1S","5S","10S","15S","30S","45s"];return(0,r.isTicksEnabled)()&&(t=["1T","10T","100T","1000T"].concat(t)),t.concat(e)}return e}},948954:(e,t,s)=>{"use strict";s.d(t,{Series:()=>mt})
;var i=s(883991),r=s(185842),n=s(77357),o=s(858328),a=s(246445),l=s(266150),h=s(222993),d=s(453113),u=s(881362),c=s(253443),p=s(757713),_=s(115676),m=s(834905),g=s(603550),y=s(70346),f=s(976078),b=s(863922),S=s(605434),v=s(599730),w=s(324585),x=s(240512),P=s(112203),C=s(570442),T=s(357966),V=s(561201),A=s(330473),D=s(519862),I=s(982898),R=s(700387),L=s(280521),k=s(547290),E=s(91426),F=s(254236),N=s(635978),M=s(866641),B=s(45587),O=s(922174),W=s(449206),z=s(193343),H=s(587241),j=s(52623),U=s(232339),q=s(90885),K=s(788312),$=s(920174),G=s(573477),Y=s(864210),J=s(622767),X=s(632549),Q=s(860211),Z=s(15474),ee=s(923242),te=s(969185),se=s(420425),ie=s(777729),re=s(884695),ne=s(611445),oe=s(875500),ae=s(385955),le=s(616350),he=s(874651),de=s(332157),ue=s(22901),ce=s(679399),pe=s(601066),_e=s(168509),me=s(39215),ge=s(316746),ye=s(466269),fe=s(686330),be=s(329750),Se=s(693078),ve=s(41846),we=s(972951),xe=s(622778),Pe=s(780414),Ce=s(91255),Te=s(266512),Ve=s(376596),Ae=s(389759),De=s(538911),Ie=s(853557),Re=s(832691),Le=s(288311),ke=s(310587),Ee=s(601109),Fe=s(969699),Ne=s(855592),Me=s(273969),Be=s(282997),Oe=s(61063),We=s(44408),ze=(s(310834),s(298147)),He=s(867219),je=s(870720),Ue=s(203695),qe=s(18107),Ke=s(359691),$e=s(960096),Ge=s(613816),Ye=s(841397),Je=s(59090),Xe=s(814515),Qe=s(196768),Ze=s(700018);const et=(0,l.isFeaturesetEnabled)("price_scale_always_last_bar_value"),tt=(0,l.isFeaturesetEnabled)("display_data_mode"),st=!(0,l.isFeaturesetEnabled)("hide_series_legend_item"),it=(0,l.isFeaturesetEnabled)("hide_price_scale_global_last_bar_value"),rt=(0,l.isFeaturesetEnabled)("no_bars_status"),nt=(0,l.isFeaturesetEnabled)("charting_library_debug_mode"),ot=(0,l.isFeaturesetEnabled)("chart_style_hilo_last_price"),at=(0,n.getLogger)("Chart.Series"),lt=we.lastDayChangeAvailable&&Ve.CheckMobile.any()||we.alwaysShowLastPriceAndLastDayChange,ht=(0,K.isFeatureEnabled)("ticks_replay");let dt=!1;const ut={countdownEnabled:!0,lastPriceAnimationEnabled:!0};function ct(e,t,s){return void 0===t?null:`${e}=${t} (${s?"changed":"unchanged"})`}function pt(e){const t=e.state();return t.data.forEach((e=>e.value.splice(7,1))),t}function _t(e){const{seriesStatus:t,additionalStudyStatus:s}=e;if(v.seriesLoadingStatuses.has(t))return 2;if(s){if(4!==t&&s.type===Ke.StudyStatusType.Error)return 13;if(v.seriesReadyStatuses.has(t)&&(s.type===Ke.StudyStatusType.Loading||s.type===Ke.StudyStatusType.Undefined))return 2}return t}class mt extends d.PriceDataSource{constructor(e,t,n,a){super(e,"_seriesId"),this.isSeries=!0,this.requestingStyleIsNotSupported=new oe.Delegate,this.requestingStyleSupportRecovered=new oe.Delegate,this._paneView=null,this._futureBarsPaneView=null,this._projectionBarsPaneView=null,this._waterlineView=null,this._priceLineView=null,this._gotoDateView=null,this._baseHorizontalLineView=null,this._priceStep=null,this._symbolInfo=new _e.WatchedValue(null),this._isPrePostMarketPricesAvailableProperty=new g.Property(!1),this._isBackAdjustmentForbiddenProperty=new g.Property(!0),this._isSettlementAsCloseForbiddenProperty=new g.Property(!0),
this._highLowPriceCache=new Map,this._averagePriceCache=new Map,this._prevClosePriceAxisView=null,this._priceScaleAboutToBeChanged=new oe.Delegate,this._onRestarted=new oe.Delegate,this._onStatusChanged=new oe.Delegate,this._tagsChanged=new oe.Delegate,this._intervalChanged=new oe.Delegate,this._sessionIdChanged=new oe.Delegate,this._requestMoreDataAvailable=!0,this._lineStyleLastPriceCirclePaneView=new ue.LastPriceCirclePaneView(this),this._prevClosePriceLineView=null,this._dataPoweredBy=null,this._symbolResolvingActive=new _e.WatchedValue(!1),this._predictBars=0,this._syncModel=null,this._data=null,this._lastCompleteFlags=null,this._barColorerCache=null,this._quotesLastSplits=new _e.WatchedValue(null),this._overriddenLastSplits=new _e.WatchedValue(null),this._lastSplits=(0,qe.combine)(((e,t)=>t||e),this._quotesLastSplits.weakReference(),this._overriddenLastSplits.weakReference()),this._boxSizeValue=new _e.WatchedValue,this._base=100,this._pointValue=1,this._formattingDeps=null,this._defaultFormatter=new S.PriceFormatter({priceScale:this._base}),this._formatter=new S.PriceFormatter({priceScale:this._base}),this._ignoreMinMoveFormatter=new S.PriceFormatter({priceScale:this._base}),this._ignoreMinMovePriceStep=null,this._lastBarCloseTime=null,this._onSessionIdPropertyChangedBound=this._onSessionIdPropertyChanged.bind(this),this._ignoreSessionIdProxyPropertyChanges=!1,this._textSourceIsAlwaysTickerRestrictionEnabled=!1,this._lastPriceAnimationActive=!1,this._currentSession="out_of_session",this._onStyleChanged=new oe.Delegate,this._obsoleteZOrder=0,this._seriesErrorMessage=null,this._seriesAlwaysFalseHibernatedVW=new _e.WatchedValue(!1),this._styleToRecover=null,this._precomputedBarStyles=new WeakMap,this._doNotShowLastAvailableBar=!1,this._gotoDateResultCleared=!1,this._endOfDataPaneView=null,this._pendingTimeRange=null,this._replaySubscriber=new _e.WatchedValue(null),this._symbolIntervalChanged=new oe.Delegate,this._isReplayResolutionAvailableForUser=null,this._onInReplayStateChanged=new oe.Delegate,this._onReplaySubscriberSeriesModified=new oe.Delegate,this._paramsNotApplicableForReplay=new oe.Delegate,this._onTimeFrameApplied=new oe.Delegate,this._seriesLoaded=!1,this._seriesCompleted=!1,this._status=new _e.WatchedValue({seriesStatus:0}),this._prevRequestedInterval="",this._isActingAsSymbolSource=new _e.WatchedValue(!0),this._unsupportedResolutionState=new _e.WatchedValue(null),this._countdownUpdateTimer=null,this._deferredDestroyed=(0,h.createDeferredPromise)(),this._volumePointWeights=null,this._studyBindings=null,this._lineColorAtYPercentFromTop=new G.GradientColorCache,this._savedLeftEdge=null,this._pendingScrollToLeftEdge=null,this._symbolSourceWV=new _e.WatchedValue(this),this._updateTimeScaleTimePointWeights=()=>{this._model.timeScale().setTimePointWeights(19===this.style()?this._volumePointWeights:null)};const d=t.childs(),u=d.interval;this._intervalObj=new _e.WatchedValue(T.Interval.parse(u.value())),u.subscribe(this,(()=>this._intervalObj.setValue(T.Interval.parse(u.value())))),this._seriesStatus=(0,
qe.combine)(_t,this._status.weakReference()),this._studyBindings=new q.SeriesStudiesBindings(this),this._studyBindings.onStatusChanged().subscribe(this,(()=>{const e=this.status(),t=this._status.value(),s=this._studyBindings?.status();s?.type!==Ke.StudyStatusType.Error||this.isFailed()||(this._seriesErrorMessage=(0,Ke.convertStudyStatusToString)(s)),this._updateStatus({...this._status.value(),additionalStudyStatus:s}),this.status()!==e&&(this._statusView.update(),this._model.updateSource(this)),(0,i.default)(t,this._status)||this._onStatusChanged.fire()})),this._seriesSource=new me.SeriesDataSource(e.chartApi(),"s",a);const c=this._seriesSource.dataEvents();c.symbolResolved().subscribe(this,this._onSymbolResolved),c.symbolError().subscribe(this,this._onSymbolError),c.seriesTimeFrame().subscribe(this,this._onSeriesTimeFrame),c.seriesError().subscribe(this,this._onSeriesError),c.loading().subscribe(this,this._onSeriesLoading),c.completed().subscribe(this,this._onSeriesCompleted),c.dataUpdated().subscribe(this,this._onDataUpdated),c.barReceived().subscribe(this,this._onBarReceived),c.unsupportedResolutionRequested().subscribe(this,this._onUnsupportedResolutionRequested),c.cleared().subscribe(this,this._onSeriesDataCleared),this._quotesProvider=new I.QuotesProvider(void 0,e.collapsed().spawnOwnership()),this._quotesProvider.quotesUpdate().subscribe(this,this._onQuotesUpdate),this._studyBindings?.bindToSeriesProperties(t),this._properties=t,d.currencyId.subscribe(this,this._onCurrencyChanged),d.unitId.subscribe(this,this._onUnitChanged),d.metricId.subscribe(this,this._onMetricChanged),d.timeframe.subscribe(this,this.changeTimeFrame),t.subscribe(this,this._onPropertiesChanged),this._sessionIdProxyProperty=new g.Property(d.sessionId.value()),d.sessionId.subscribe(this,(()=>this._updateSessionIdProxyProperty())),this._sessionIdProxyProperty.subscribe(this,this._onSessionIdProxyPropertyChanged),this._symbolTextSourceProxyProperty=new g.Property,this._recalcSymbolTextSourceProxyProperty(),d.statusViewStyle.childs().symbolTextSource.subscribe(this,this._recalcSymbolTextSourceProxyProperty),this._symbolTextSourceProxyProperty.subscribe(this,(()=>e.lightUpdate())),this._options=(0,ae.merge)((0,ae.clone)(ut),n),this._prevChartStyle=d.style.value(),this._priceAxisView=new R.SeriesPriceAxisView(this,e,{alwaysShowGlobalLast:!it,showCountdown:n.countdownEnabled});let p=null;et||it||(p=new R.SeriesPriceAxisView(this,e,{visibleOnHistoryOnly:!0,showSymbolLabel:!1,showCountdown:!1,alwaysShowGlobalLast:!1,useSolidBodyColor:!1})),this._priceLinePriceAxisView=new Z.SeriesPriceLineAxisView(this),this._priceLineAxisViews=[this._priceLinePriceAxisView],this._projectionPriceAxisView=new ee.ProjectionSeriesPriceAxisView(this,e,{showCountdown:n.countdownEnabled}),this._priceAxisViews=[this._priceAxisView,this._projectionPriceAxisView],null!==p&&this._priceAxisViews.push(p),this._prevClosePriceAxisView=new J.PrevCloseSeriesPriceAxisView(this,e),this._priceAxisViews.unshift(this._prevClosePriceAxisView),
this._prevClosePriceLineView=new X.SeriesPrevClosePriceLinePaneView(this),this._panePriceAxisView=new te.PanePriceAxisView(this._priceAxisView,this,e),this._historyPricePanePriceAxisView=null!==p?new te.PanePriceAxisView(p,this,e):null,this._projectionPanePriceAxisView=new te.PanePriceAxisView(this._projectionPriceAxisView,this,e),this._labelPaneViews=[this._panePriceAxisView,this._projectionPanePriceAxisView],null!==this._historyPricePanePriceAxisView&&this._labelPaneViews.push(this._historyPricePanePriceAxisView),this._highLowAvgPaneViews=[],this._averagePaneViews=[],this._createHighLowAvgViews(),this._subscribeRestartToSessionIdChange(),d.visible.subscribe(this,this._updateLastPriceAnimationActive),this._updateLastPriceAnimationActive(),d.minTick.subscribe(this,this._onFormatterPropsChanged),this._dataWindowView=new pe.SeriesDataWindowView(this,e),this._legendView=new x.SeriesLegendView(this,e),this._statusView=new w.SeriesStatusView(this,d.statusViewStyle),this._floatingTooltipView=new Je.SeriesChartFloatingTooltipView(e),this._marketStatusModel=new P.MarketStatusModel(this._quotesProvider),this._dataUpdatedModeModel=tt?new A.DataUpdatedModeModel(this._symbolInfo.spawn().ownership(),this._seriesStatus.spawn().ownership(),(0,$e.createWVFromGetterAndSubscription)((()=>this._lastCompleteFlags?.rt_update_period),c.completed()).ownership()):null,this._dataProblemModel=new D.DataProblemModel(this._quotesProvider,this._symbolInfo.spawn().ownership()),d.backAdjustment.subscribe(this,(()=>{this.isStarted()&&this.restart()})),d.settlementAsClose.subscribe(this,(()=>{this.isDWM()&&this.isStarted()&&this.restart()})),this._symbolResolvingActive.subscribe((()=>e.realignLineTools())),this._intervalChanged.subscribe(this,(()=>e.realignLineTools())),this._intervalChanged.subscribe(this,(()=>this._checkChartStyle())),(0,l.isFeaturesetEnabled)("widget")||Promise.all([s.e(47088),s.e(64116),s.e(98115),s.e(57032),s.e(46970),s.e(50865),s.e(48072),s.e(74528),s.e(44589),s.e(93122),s.e(32387),s.e(99331),s.e(91833)]).then(s.bind(s,422190)).then((e=>{this._endOfDataPaneView=new e.EndOfDataLollipopPaneView(this)})),this._studyBindings?.syncStudy(this.style()),this._aliasSymbolInfo=(0,k.createAliasSymbolInfoWV)(this._symbolInfo.weakReference(),this._model.symbolAliasService()),this._aliasSymbolInfo.subscribe((()=>this._onFormatterPropsChanged)),z.alertsAvailable&&this._symbolResolvingActive.subscribe(this._updateAlertCreationAvailable.bind(this)),this.createPaneView(),this._properties.addExcludedKey("visible",1),this._properties.addExcludedKey("currencyId",1),this._futureBarsPaneView=null,this._priceLineView=null,this._baseHorizontalLineView=new Ue.SeriesHorizontalBaseLinePaneView(this);for(const[,e]of Object.entries(v.STYLE_SHORT_NAMES))this._properties.child(`${e}Style`)?.subscribe(this,(()=>this.invalidateBarStylesCache()));const _=d.renkoStyle.childs().inputs.childs();_.boxSize.subscribe(this,(()=>this._restartIfStyleMatches(4))),_.style.subscribe(this,(()=>this._restartIfStyleMatches(4))),
_.atrLength.subscribe(this,(()=>this._restartIfStyleMatches(4))),_.percentageLTP.subscribe(this,(()=>this._restartIfStyleMatches(4))),_.wicks.subscribe(this,(()=>this._restartIfStyleMatches(4))),_.sources.subscribe(this,(()=>this._restartIfStyleMatches(4))),d.pbStyle.childs().inputs.childs().lb.subscribe(this,(()=>this._restartIfStyleMatches(7)));const m=d.kagiStyle.childs().inputs.childs();m.reversalAmount.subscribe(this,(()=>this._restartIfStyleMatches(5))),m.style.subscribe(this,(()=>this._restartIfStyleMatches(5))),m.atrLength.subscribe(this,(()=>this._restartIfStyleMatches(5))),m.percentageLTP.subscribe(this,(()=>this._restartIfStyleMatches(5)));const y=d.pnfStyle.childs().inputs.childs();y.boxSize.subscribe(this,(()=>this._restartIfStyleMatches(6))),y.reversalAmount.subscribe(this,(()=>this._restartIfStyleMatches(6))),y.sources.subscribe(this,(()=>this._restartIfStyleMatches(6))),y.style.subscribe(this,(()=>this._restartIfStyleMatches(6))),y.atrLength.subscribe(this,(()=>this._restartIfStyleMatches(6))),y.percentageLTP.subscribe(this,(()=>this._restartIfStyleMatches(6))),y.oneStepBackBuilding.subscribe(this,(()=>this._restartIfStyleMatches(6))),d.rangeStyle.childs().inputs.childs().phantomBars.subscribe(this,(()=>this._restartIfStyleMatches(11))),this._isDWMProperty=new g.Property(this.isDWM()),this._onRestarted.subscribe(this,(()=>this._isDWMProperty.setValue(this.isDWM()))),d.dividendsAdjustment?.subscribe(this,(()=>{const e=(0,r.ensureDefined)(d.dividendsAdjustment).value();(0,o.trackEvent)("Dividends adjust",!0===e?"On":"Off"),this.restart()})),this._dataPoweredBy=null,d.showCountdown.subscribe(this,this._onShowCountdownChanged),this._onShowCountdownChanged(d.showCountdown),this._recreatePriceFormattingDependencies(),d.lineStyle.childs().priceSource.subscribe(this,this._updateBarFunction),d.lineWithMarkersStyle.childs().priceSource.subscribe(this,this._updateBarFunction),d.steplineStyle.childs().priceSource.subscribe(this,this._updateBarFunction),d.areaStyle.childs().priceSource.subscribe(this,this._updateBarFunction),d.baselineStyle.childs().priceSource.subscribe(this,this._updateBarFunction),d.columnStyle.childs().priceSource.subscribe(this,this._updateBarFunction),d.tpoStyle.childs().priceSource.subscribe(this,this._updateBarFunction),this._updateBarFunction(),this._isInReplay=(0,qe.combine)((e=>null!==e),this._replaySubscriber.weakReference()),this._valuesProvider=new Ge.SeriesValuesProvider(this,this.model()),this._legendValuesProvider=new ie.SeriesLegendValuesProvider(this,this.model()),this._tableViewValuesProvider=new Ze.SeriesTableViewValuesProvider(this,this.model()),this._dataWindowValuesProvider=new Ge.SeriesValuesProvider(this,this.model()),this._valuesProvider=new Ge.SeriesValuesProvider(this,this.model()),this._chartFloatingTooltipValuesProvider=new re.SeriesChartFloatingTooltipValuesProvider(this,this.model())}setId(e){super.setId(e),(0,$.getPersistentLogger)()?.addPersistentLogEntry(`Set series Id to ${e}`,n.LOGLEVEL.INFO,"chart.series")}supportsConflatedChunks(){return!0}
conflatedChunks(e,t){return this.data().conflatedChunks(e,t)}seriesErrorMessage(){const{seriesStatus:e,additionalStudyStatus:t}=this._status.value();return this.isFailed()?this._seriesErrorMessage:v.seriesLoadingStatuses.has(e)?null:t?.type===Ke.StudyStatusType.Error?(0,Ke.convertStudyStatusToString)({type:Ke.StudyStatusType.Error,errorDescription:t.errorDescription},!0):null}destroy(){this._lastSplits.destroy(),this._seriesStatus.destroy(),this._quotesProvider.quotesUpdate().unsubscribeAll(this),this._quotesProvider.destroy(),this.clearGotoDateResult(),this._legendView.destroy(),this._floatingTooltipView.destroy(),this._marketStatusModel.destroy(),this._model.symbolAliasService()?.onAliasChanged().unsubscribeAll(this),this._aliasSymbolInfo?.release(),this._studyBindings?.destroy(),this._dataUpdatedModeModel?.destroy(),this._dataProblemModel.destroy(),this._paneView&&this._paneView.destroy&&this._paneView.destroy(),this._seriesSource.destroy(),this._quotesProvider.quotesUpdate().unsubscribeAll(this),this._model.timeScale().visibleBarsStrictRangeChanged().unsubscribeAll(this),this._unsubscribeRestartToSessionIdChange(),this._paramsNotApplicableForReplay.destroy(),this._onTimeFrameApplied.destroy(),this._deferredDestroyed.resolve(),this._properties.destroy(),this._isInReplay.destroy(),super.destroy()}isActingAsSymbolSource(){return this._isActingAsSymbolSource.readonly()}barColorer(){if(this._barColorerCache)return this._barColorerCache;let e=null;const t=this._model.panes();for(let s=t.length-1;s>=0;s--){const i=t[s].dataSources().filter(We.isStudy).filter((e=>e.hasBarColorer()&&!e.isSourceHidden())).sort(((e,t)=>e.zorder()-t.zorder()));for(let t=0;t<i.length;t++){const s=(0,r.ensureNotNull)(i[t].barColorer());null===e?e=s:e.pushBackBarColorer(s)}}return null===e?e=new Oe.SeriesBarColorer(this):e.pushBackBarColorer(new Oe.SeriesBarColorer(this)),this._barColorerCache=e,e}createPaneView(){this._paneView=null,this._projectionBarsPaneView=null,this._waterlineView=null,this._priceLineView=this.hasClosePrice()?new be.SeriesPriceLinePaneView(this):null;const e=this._properties.childs().style.value();switch(e){case 0:this._paneView=new De.SeriesBarsPaneView(this,this._model);break;case 17:case 19:case 1:this._paneView=new Ie.SeriesCandlesPaneView(this,this._model,1===e||19===e?1:.2);break;case 2:case 18:case 14:case 15:this._paneView=new Re.SeriesLinePaneView(this,this._model);break;case 3:this._paneView=new Le.SeriesAreaPaneView(this,this._model);break;case 16:this._paneView=new ke.SeriesHLCAreaPaneView(this,this._model);break;case 8:this._paneView=new Ee.SeriesHeikenAshiPaneView(this,this._model);break;case 9:this._paneView=new Fe.SeriesHollowCandlesPaneView(this,this._model);break;case 13:this._paneView=new Ae.SeriesColumnsPaneView(this,this._model);break;case 10:{this._paneView=new Ne.SeriesBaselinePaneView(this,this._model);const e=this._properties.childs().baselineStyle.childs();this._waterlineView=new Se.SeriesWaterlinePaneView({paneHeight:()=>this.priceScale().height(),color:()=>e.baselineColor.value(),
baseLevelPercentage:()=>e.baseLevelPercentage.value()});break}case 12:this._paneView=new ve.SeriesHiLoPaneView(this,this._model);break;case 21:this._paneView=new Xe.SeriesHLCBarsPaneView(this,this._model)}switch(e){case 4:this._paneView=new xe.SeriesRenkoPaneView(this,this._model),this._projectionBarsPaneView=new xe.SeriesProjectionRenkoPaneView(this,this._model);break;case 7:this._paneView=new Pe.SeriesPriceBreakPaneView(this,this._model),this._projectionBarsPaneView=new Pe.SeriesProjectionPriceBreakPaneView(this,this._model);break;case 5:this._paneView=new Ce.SeriesKagiPaneView(this,this._model),this._projectionBarsPaneView=new Ce.SeriesProjectionKagiPaneView(this,this._model);break;case 6:this._paneView=new Te.SeriesPnFPaneView(this,this._model),this._projectionBarsPaneView=new Te.SeriesProjectionPnFPaneView(this,this._model)}if(11===e&&(this._properties.childs().rangeStyle.childs().barStyle.value()===He.RangeBarStyle.Bars?(this._paneView=new De.SeriesBarsPaneView(this,this._model),this._projectionBarsPaneView=new Q.SeriesProjectionRangeBarsPaneView(this,this._model)):(this._paneView=new Ie.SeriesCandlesPaneView(this,this._model),this._projectionBarsPaneView=new Q.SeriesProjectionRangeCandlesPaneView(this,this._model))),20===e&&(this._paneView=U.EmptyPaneView.instance()),null===this._paneView)throw Error("Unknown chart style assigned: "+e)}properties(){return this._properties}zorder(){return 0}quotesProvider(){return this._quotesProvider}currentSession(){return this._currentSession}syncModel(){if(!this._syncModel){const e=this.symbolInfo(),t=this.interval();if(!e||!t)return null;this._syncModel=new V.SyncModel(e,t)}return this._syncModel}labelPaneViews(){return this._labelPaneViews}topPaneViews(){const e=[];if(null!==this._gotoDateView&&e.push(this._gotoDateView),this._lastPriceAnimationActive){const t=this._lineStyleLastPriceCirclePaneView;t.animationActive()&&setTimeout((()=>this._model.invalidate(ce.InvalidationMask.cursor())),0),t.invalidateStage(),e.push(t)}return 0!==e.length?e:null}paneViews(e){if(!this.properties().childs().visible.value()||!this._model.isSnapshot()&&!this._wasCompletedBefore())return null;const t=e===this._model.paneForSource(this),s=t?[(0,r.ensureNotNull)(this._baseHorizontalLineView),(0,r.ensureNotNull)(this._paneView)]:[];return s.push(...this._studyBindings?.paneViews(e)??[]),t&&(this._endOfDataPaneView&&s.push(this._endOfDataPaneView),this._futureBarsPaneView&&s.push(this._futureBarsPaneView),this._projectionBarsPaneView&&s.push(this._projectionBarsPaneView),null!==this._waterlineView&&s.push(this._waterlineView),s.push((0,r.ensureNotNull)(this._prevClosePriceLineView)),null!==this._priceLineView&&s.push(this._priceLineView),window.TradingView.printing&&this._lastPriceAnimationActive&&(this._lineStyleLastPriceCirclePaneView.stopAnimation(),s.push(this._lineStyleLastPriceCirclePaneView)),s.push(...this._highLowAvgPaneViews),s.push(...this._averagePaneViews)),s}widgetSideAreaViews(e){return this._studyBindings?.widgetSideAreaViews(e)??null}priceAxisViews(e,t){
return e.findTargetPriceAxisViews(this,t,this._priceAxisViews,this._priceLineAxisViews)}clearHighLowPriceCache(){this._highLowPriceCache.clear()}clearAveragePriceCache(){this._averagePriceCache.clear()}priceScale(){return(0,r.ensureNotNull)(this._priceScale)}setPriceScale(e){this._priceScale!==e&&(this._priceScaleAboutToBeChanged.fire(),this._priceScale=e,this._properties.removeProperty("priceAxisProperties"),this._properties.addChild("priceAxisProperties",e.properties()),this._properties.childs().priceAxisProperties.fireChanged(),(0,a.emit)("series_event","price_scale_changed"),this._priceScaleChanged.fire(e))}priceScaleChanged(){return this._priceScaleChanged}priceScaleAboutToBeChanged(){return this._priceScaleAboutToBeChanged}applyPreferences(e){const t=(0,ae.clone)(e);this.priceScale().setMode({autoScale:t.priceAxisProperties.autoScale,percentage:t.priceAxisProperties.percentage,log:t.priceAxisProperties.log,lockScale:t.priceAxisProperties.lockScale}),this.setChartStyleWithIntervalIfNeeded(t.style);const{style:s,interval:i,...r}=t;this._properties.mergePreferences(r),this._properties.saveDefaults(),this.createPaneView(),this.invalidateBarStylesCache()}disconnect(){this._studyBindings?.stop(),this._seriesSource.stop(),this._predictBars=0,this._updateStatus({...this._status.value(),seriesStatus:0})}isStarted(){return this._seriesSource.isStarted()}isCompleted(){return this._seriesCompleted}restart(e){if(5===this._status.value().seriesStatus)return;let t=null;this._pendingTimeRange&&(t=this._pendingTimeRange,this._seriesSource.isStarted()||(this._seriesSource.setTimeframe(t),this._pendingTimeRange=null));const s=this._properties.childs().interval.value(),i=(0,fe.getServerInterval)(s),r=this._getResolvingSymbolObject();this._seriesSource.canModifySeries(r,i)?(this._seriesLoaded=!1,this._seriesCompleted=!1,this._lastCompleteFlags=null,this._onRestarted.fire(),this._setStatus(1),this._updateSymbolInfo(null),T.Interval.isEqual(s,this._prevRequestedInterval)||this._notifyIntervalChanged(s),e||this._removeReplaySubscriber(),this._onBeforeModifySeries(this.getSymbolString(),s),this._onTimeFrameApplied.fire(t),this._data=null,this.model().recalcVisibleRangeStudies(u.RecalcVisibleRangeStudiesReason.SeriesRestart),this._seriesSource.modifySeries(r,i,t),this._seriesSource.isStarted()||this._seriesSource.start(),this._prevRequestedInterval=this.interval(),this._pendingTimeRange=null,this._studyBindings?.restart(),this.updateAllViews((0,ge.sourceChangeEvent)(this.id())),this._model.lightUpdate()):this._seriesSource.isStarted()||(this._updateSymbolInfo(null),this._seriesSource.start(),this._studyBindings?.restart())}isSymbolInvalid(){return 4===this._status.value().seriesStatus}getSymbolString(){return(0,he.encodeExtendedSymbolOrGetSimpleSymbolString)(this._getSymbolObject())}getAlertSymbolString(){return(0,he.encodeExtendedSymbolOrGetSimpleSymbolString)(this._getSymbolObject(this.actualSymbol()))}getAlertProSymbolString(){return(0,he.encodeExtendedSymbolOrGetSimpleSymbolString)(this._getSymbolObject(this.proSymbol()))}
getQuotesSymbolString(){return(0,he.encodeExtendedSymbolOrGetSimpleSymbolString)(this._getExtendedSymbolObject(void 0,!0))}invalidateBarStylesCache(e){at.logDebug("Invalidate style cache starting from "+e),this._clearStylePlot(this.bars(),e),this._clearStylePlot(this.nsBars())}isLoading(){return v.seriesLoadingStatuses.has(this.statusWV().value())}isFailed(){const e=this.status();return 12===e||4===e||10===e||14===e||13===e}isStatusError(){return 12===this.status()}unsupportedResolutionState(){return this._unsupportedResolutionState.readonly()}actualSymbol(){return(0,y.actualSymbol)(this.symbolInfo(),this.symbol())}proSymbol(){return(0,y.proSymbol)(this.symbolInfo(),this.symbol())}onStyleChanged(){return this._onStyleChanged}style(){return this.properties().childs().style.value()}setStyle(e){this.setSymbolParams({style:e})}isRangeBasedStyle(){return(0,y.isRangeBasedStyle)(this.style())}symbolSameAsCurrent(e){return this.symbol()===e||(0,le.symbolSameAsCurrent)(e,this.symbolInfo())}symbolSameAsResolved(e){return this._model.isSnapshot()?this.symbolSameAsCurrent(e):this._seriesSource.symbolSameAsResolved(e)}status(){return this._seriesStatus.value()}statusWV(){return this._seriesStatus}compositeStatusVW(){return this._status}symbol(){return this.properties().childs().symbol.value()}symbolOrAlias(){const e=this.symbol(),t=this._model.symbolAliasService()?.getAliasByProName(e);return t?.aliasName??e}symbolChanged(){return this.properties().childs().symbol}seriesSource(){return this._seriesSource}symbolInfo(){return this._symbolInfo.value()}aliasSymbolInfo(){return(this._aliasSymbolInfo??this._symbolInfo).value()}symbolInfoWV(){return this._symbolInfo.readonly()}lastSplits(){return this._lastSplits}overrideLastSplits(e){this._overriddenLastSplits.setValue(e)}symbolResolved(){return this.dataEvents().symbolResolved()}symbolResolvingActive(){return this._symbolResolvingActive}symbolHibernated(){return this._seriesAlwaysFalseHibernatedVW}getSymbolName(){return this.symbolInfo()?.name??""}firstValue(){const e=this.firstBar();return null===e?null:this._barFunction(e,0)}firstBar(){const e=this.model().timeScale().visibleBarsStrictRange();if(null===e)return null;const t=e.firstBar(),s=this.data().search(t,_.PlotRowSearchMode.NearestRight);return null!==s?s.value:null}formatter(e=!0){return e?this._formatter:this._ignoreMinMoveFormatter}defaultFormatter(){return this._defaultFormatter}priceStep(e=!0){return e?this._priceStep:this._ignoreMinMovePriceStep}bars(){return this.data().bars()}nsBars(){return this.data().nsBars()}interval(){return this.properties().childs().interval.value()}setInterval(e){this.setSymbolParams({interval:e})}intervalObj(){return this._intervalObj.readonly()}prevClose(){const e=this.priceScale();if(e.isEmpty()||this.data().isEmpty())return null;const t=this.quotes(),s=this.firstValue();if(null===t||null===s)return null;const i=t.prev_close_price;return void 0===i?null:{coordinate:e.priceToCoordinate(i,s),formattedPricePercentage:e.formatPricePercentage(i,s,{signPositive:!0}),
formattedPriceAbsolute:e.formatPriceAbsolute(i),formattedPriceIndexedTo100:e.formatPriceIndexedTo100(i,s)}}priceLineColor(e){return this.properties().childs().priceLineColor.value()||e}hasClosePrice(){return ot||12!==this.properties().childs().style.value()}lastValueData(e,t,s){const i={noData:!0},r=this.priceScale();if(this.model().timeScale().isEmpty()||r.isEmpty()||this.data().isEmpty())return i;const n=this.model().timeScale().visibleBarsStrictRange(),o=this.firstValue();if(null===n||null===o)return i;let a,l;if(t){const e=this.data().bars().last();if(null===e)return i;a=e.value,l=e.index}else{const e=this.data().bars().search(n.lastBar(),_.PlotRowSearchMode.NearestLeft);if(null===e)return i;a=e.value,l=e.index}const h=(void 0!==e?a[e]:this._barFunction(a,2))??NaN,d=this.barColorer().barStyle(l,!1),u=r.priceToCoordinate(h,o),c={...r.getFormattedValues(h,o,!0),noData:!1,color:d.barColor,coordinate:u,index:l};return s&&(c.price=h),c}isDWM(){return this.intervalObj().value().isDWM()}isPulse(){const e=this.symbolInfo();return null!==e&&(e.resolutions??[]).length>0}data(){return this._data??this._seriesSource.data()}clearData(){(0,r.assert)(null===this._data,"Cannot clear loaded data"),this._studyBindings?.clearData(),this._seriesSource.clearData()}nearestData(e,t){return this.data().search(e,t)??void 0}nearestIndex(e,t){return this.nearestData(e,t)?.index}nearestValue(e,t,s){const i=this.nearestData(e,s);return i?.value[t]??void 0}onSymbolIntervalChanged(){return this._symbolIntervalChanged}onIntervalChanged(){return this._intervalChanged}onStatusChanged(){return this._onStatusChanged}onRestarted(){return this._onRestarted}fixLastBar(e){if(!this._futureBarsPaneView){const t=this.bars().lastIndex();t&&(this._futureBarsPaneView=new W.FutureBarsPaneView(this.model().timeScale(),this,t,e))}}requestMoreData(e){if(!v.seriesReadyStatuses.has(this._status.value().seriesStatus))return;if(this._model.timeScale().isEmpty())return;const t=this._model.timeScale().visibleBarsStrictRange();if(null===t)return;if(0===this.bars().size())return;const s=t.lastBar()-(0,r.ensureNotNull)(this.data().last()).index;if(this._predictBars<s&&(this._predictBars=s,this._seriesSource.requestMoreTickmarks(s)),!this._requestMoreDataAvailable)return;const i=(0,r.ensureNotNull)(this.bars().firstIndex()),n=e||Math.max(i-t.firstBar(),i-(this._studyBindings?.requestMoreDataIndex()??i));if(n<=0)return;if(!Number.isFinite(n))return void at.logWarn("requestMoreData: invalid bar count: "+n+", visible bars: ["+t.firstBar()+", "+t.lastBar()+"], last index: "+(0,r.ensureNotNull)(this.data().last()).index+", predicted bars: "+this._predictBars+", required bars:"+e);this._requestMoreDataAvailable=!1;const o=this._colorOnPrevBar()?2:0;this._seriesSource.requestMoreData(n+o),this._setStatus(2)}isNeedRestart(e){return 5!==this._status.value().seriesStatus&&(void 0===e&&(e=this.properties().childs().style.value()),(0,y.styleChangeRequiresRestart)(this._prevChartStyle,e))}isStyleSupported(e){return!this.isInReplay().value()||(0,y.isStyleSupportedForReplay)(e)}
sessionId(){return this.properties().childs().sessionId.value()}sessionIdChanged(){return this._sessionIdChanged}priceRange(e){const t=this._priceScale;if(this.data().isEmpty()||!t)return null;const{startTimePoint:s,endTimePoint:i}=e;if(t.isLockScale()){const e=this._model.mainSeriesScaleRatio();if(null!==e){const s=t.internalHeight()/(this.model().timeScale().barSpacing()/e),n=(0,r.ensureNotNull)(this.data().search(i,_.PlotRowSearchMode.NearestLeft)).value,o=((0,r.ensure)(n[2])+(0,r.ensure)(n[3]))/2;return new m.PriceRange(o-.5*s,o+.5*s)}}const n=this.priceSource();let o,a,l;if(null!==n?(o=this.data().bars().minMaxOnRangeCached(s,i,[{name:n,offset:0}]),a=this.data().nsBars().minMaxOnRangeCached(s,i,[{name:n,offset:0}])):(o=this.data().bars().minMaxOnRangeCached(s,i,[{name:"low",offset:0},{name:"high",offset:0}]),a=this.data().nsBars().minMaxOnRange(s,i,[{name:"low",offset:0},{name:"high",offset:0}])),o=(0,p.mergeMinMax)(o,a),null===o)l=new m.PriceRange(-.5,.5);else if(o.min===o.max){const e=5/(this.symbolInfo()?.pricescale??100);l=new m.PriceRange(o.min-e,o.max+e)}else l=new m.PriceRange(o.min,o.max);return t.isLog()?new m.PriceRange(t.priceToLogical(l.minValue()),t.priceToLogical(l.maxValue())):l}autoScaleInfo(e){let t={range:this.priceRange({...e,scaleSeriesOnly:!0}),topPixelMargin:this._paneView?.topPixelMargin?.(),bottomPixelMargin:this._paneView?.bottomPixelMargin?.()};if(!e.scaleSeriesOnly){const s=this._model.allStudies().filter((e=>e.isVisible())),i=(e,t)=>void 0===e?t:void 0===t?e:Math.max(e,t),r=s.map((t=>t.autoScaleInfo({...e,forceOverlayOnly:!0})));this._studyBindings&&r.push(...this._studyBindings.autoScaleInfos(e));const n=(e,t)=>({range:e.range?t.range?e.range.merge(t.range):e.range:t.range,topPixelMargin:i(e.topPixelMargin,t.topPixelMargin),bottomPixelMargin:i(e.bottomPixelMargin,t.bottomPixelMargin)});t=r.reduce(n,t)}return t}onChartStyleChanged(){if(this._updateBarFunction(),this.isNeedRestart()){this.data().clear();const e=(0,y.isStyleSupportedForReplay)(this.style());this.isInReplay().value()&&!e&&this._removeReplaySubscriber(),this._saveLeftEdgeIfRequired(!1)||this.model().timeScale().scrollToRealtime(!1),this.restart(e)}const e=this.properties();this._prevChartStyle!==e.childs().style.value()&&this._studyBindings?.syncStudy(this.style()),this._prevChartStyle=e.childs().style.value(),this._onStyleChanged.fire(e.childs().style.value()),this.invalidateBarStylesCache(),this._updateLastPriceAnimationActive(),this._styleToRecover?.originalStyle!==this.style()&&(this._styleToRecover=null),this._updateTimeScaleTimePointWeights()}setChartStyleWithIntervalIfNeeded(e,t){const s=this.interval(),i=t??(0,ye.getResolutionByChartStyle)(e,s,this._model.defaultResolutions()),r=T.Interval.isEqual(i,s);this.setSymbolParams({interval:r?void 0:i,style:e})}getInputsProperties(){const e=this._properties.child(`${this.getStyleShortName()}Style`);return e?.childs().inputs??new g.Property}getInputsInfoProperties(){const e=this._studyBindings?.getInputsInfoProperties();if(e)return e
;const t=this._properties.child(`${this.getStyleShortName()}Style`);return t?.childs().inputInfo??new g.Property}getSourceIcon(){return{type:"loadSvg",svgId:`series.${this.style()}`}}onSourceIconChanged(){return this._onStyleChanged}purgeSymbolInfo(){this._symbolInfo.setValue(null),this._quotesLastSplits.setValue(null)}idForAlert(){return(0,N.getSeriesIdForAlert)(this.getSymbolString(),this.interval())}hasStateForAlert(){const e=this.symbolInfo();return super.hasStateForAlert()&&!(0,y.isEconomicSymbol)(e)&&!(0,y.isMetricActive)(e)}stateForAlert(){const e=this.idForAlert(),t=M.FormattersSerializer.serialize(this._formatter);let s;const i=this.isDWM()?b.SubsessionId.Regular:this.sessionIdProxyProperty().value(),n=this.symbolInfo();if(n&&n.subsessions&&n.subsessions.length>1){const e=n.subsessions?.find((e=>e.id===i));e&&(s=(0,B.translateSessionExtendedDescription)(e.description))}const o=this.properties().childs(),a={id:e,type:"MainSeries",actualSymbol:this.actualSymbol(),symbolString:this.getSymbolString(),interval:this.interval(),style:o.style.value(),styleInputs:this.getInputsProperties().state(),sessionId:i,sessionDescription:s,dividendsAdjustment:(0,r.ensureDefined)(o.dividendsAdjustment).value(),boxSize:this.data().boxSize,reversalAmount:this.data().reversalAmount,isSpread:this.isSpread(),formatter:t},l=(0,O.getSeriesDangerReason)(this);return l&&(a.dangerReason=l),a}async stateForAlertAsync(){return this.stateForAlert()}styleStudyInfos(){let e={haStyle:{studyId:(0,r.ensureNotNull)((0,y.chartStyleStudyId)(8,!0))},renkoStyle:{studyId:(0,r.ensureNotNull)((0,y.chartStyleStudyId)(4,!0))},pbStyle:{studyId:(0,r.ensureNotNull)((0,y.chartStyleStudyId)(7,!0))},kagiStyle:{studyId:(0,r.ensureNotNull)((0,y.chartStyleStudyId)(5,!0))},pnfStyle:{studyId:(0,r.ensureNotNull)((0,y.chartStyleStudyId)(6,!0))},rangeStyle:{studyId:(0,r.ensureNotNull)((0,y.chartStyleStudyId)(11,!0))}};return e={...e,volFootprintStyle:{studyId:(0,r.ensureNotNull)((0,y.chartStyleStudyId)(17,!0))},tpoStyle:{studyId:(0,r.ensureNotNull)((0,y.chartStyleStudyId)(18,!0,this._properties.childs().tpoStyle.childs().inputs.state()))},svpStyle:{studyId:(0,r.ensureNotNull)((0,y.chartStyleStudyId)(20,!0))}},e}dataEvents(){return this._seriesSource.dataEvents()}isSpread(){return"spread"===this.symbolInfo()?.type}isYield(){const e=this.symbolInfo();return null!==e&&(0,ze.isYield)(e)}dividendsAdjustmentProperty(){return(0,r.ensureDefined)(this._properties.childs().dividendsAdjustment)}sessionIdProxyProperty(){return this._sessionIdProxyProperty}symbolTextSourceProxyProperty(){return this._symbolTextSourceProxyProperty}setTextSourceIsAlwaysTickerRestrictionEnabled(e){this._textSourceIsAlwaysTickerRestrictionEnabled=e,this._recalcSymbolTextSourceProxyProperty()}isDWMProperty(){return this._isDWMProperty}isPrePostMarketPricesAvailableProperty(){return this._isPrePostMarketPricesAvailableProperty}isSettlementAsCloseForbiddenProperty(){return this._isSettlementAsCloseForbiddenProperty}isBackAdjustmentForbiddenProperty(){return this._isBackAdjustmentForbiddenProperty}
getStyleShortName(){const e=this.style(),t=v.STYLE_SHORT_NAMES[e];return(0,r.assert)(!!t,`Missed short name for style ${e}`),t}invalidateBarColorerCache(){this._barColorerCache=null,this.invalidateBarStylesCache()}paramsNotApplicableForReplay(){return this._paramsNotApplicableForReplay}onTimeFrameApplied(){return this._onTimeFrameApplied}onInReplayStateChanged(){return this._onInReplayStateChanged}onReplayModified(){return this._onReplaySubscriberSeriesModified}dataWindowView(){return this._dataWindowView}chartFloatingTooltipView(){return this._floatingTooltipView}statusView(){return st?this._statusView:null}legendView(){return this._legendView}marketStatusModel(){return this._marketStatusModel}isMainSeries(){return!0}dataUpdatedModeModel(){return this._dataUpdatedModeModel}dataProblemModel(){return this._dataProblemModel}setDefaultTimeframe(e){this._pendingTimeRange=e}loadDataTo(e){const t=this._properties.childs().interval.value();this._onTimeFrameApplied.fire(e),this._seriesSource.modifySeries(this._getResolvingSymbolObject(),(0,fe.getServerInterval)(t),e)}isInReplay(){return this._isInReplay}quotes(){return this.data().isEmpty()?null:this._quotesProvider.quotes().value()}base(){return this._base}pointValue(){return this._pointValue}barCloseTime(){return this._lastBarCloseTime}priceSource(){let e=null;const t=this._properties.childs();switch(t.style.value()){case 2:e=t.lineStyle.childs().priceSource.value();break;case 18:e=t.tpoStyle.childs().priceSource.value();break;case 14:e=t.lineWithMarkersStyle.childs().priceSource.value();break;case 15:e=t.steplineStyle.childs().priceSource.value();break;case 3:e=t.areaStyle.childs().priceSource.value();break;case 10:e=t.baselineStyle.childs().priceSource.value();break;case 13:e=t.columnStyle.childs().priceSource.value()}return e}lineColorAtYPercentFromTop(e){let t;switch(this.style()){case 2:t=this.properties().childs().lineStyle.childs();break;case 14:t=this.properties().childs().lineWithMarkersStyle.childs();break;case 15:t=this.properties().childs().steplineStyle.childs();break;default:t=null}return t?t.colorType?.value()===Ye.ColorType.Solid?t.color.value():this._lineColorAtYPercentFromTop.gradientColor((0,r.ensureDefined)(t.gradientStartColor).value(),(0,r.ensureDefined)(t.gradientEndColor).value(),e):null}updateAllViews(e){this._studyBindings?.updateAllViews(e),"hover-change"!==e.type&&(this._paneView?.update(e),this._dataWindowView.update(),this._legendView.update(),this._statusView.update(),this._floatingTooltipView.update(e),this._averagePaneViews.forEach((t=>t.update(e))),this._highLowAvgPaneViews.forEach((t=>t.update(e))),this._labelPaneViews.forEach((t=>t.update(e))),this._priceAxisViews.forEach((t=>t.update(e))),this._priceLineAxisViews.forEach((t=>t.update(e))),this._futureBarsPaneView?.update(e),this._projectionBarsPaneView?.update(e),this._waterlineView?.update(e),this._prevClosePriceLineView?.update(e),this._priceLineView?.update(e),this._gotoDateView?.update(e),this._endOfDataPaneView?.update(e),this._baseHorizontalLineView?.update(e),
this._model.activeStrategySource().value()?.updateAllViews(e),this._model.replayStudyStrategy().value()?.updateAllViews(e),this._lineStyleLastPriceCirclePaneView.update(e))}styleStudyInfo(e){return this.styleStudyInfos()[e]}barFunction(){return this._barFunction}precomputedBarStyle(e){return this._precomputedBarStyles.get(e)}setPrecomputedBarStyle(e,t){this._precomputedBarStyles.set(e,t)}symbolParams(){return(0,le.symbolParams)(this)}compareSymbolParams(e){return(0,le.compareSymbolParams)(this,e,this._model.unitConversionEnabled(),this._model.metricConversionEnabled())}setSymbolParams(e){const{symbol:t,currency:s,unit:i,metric:n,style:o,interval:a,session:l}=e,{symbolChanged:h,intervalChanged:d,currencyChanged:u,unitChanged:c,metricChanged:p,styleChanged:_,sessionChanged:m}=this.compareSymbolParams(e),g=[ct("symbol",t,h),ct("interval",a,d),ct("currency",s,u),ct("unit",i,c),ct("metric",n,p),ct("style",o,_),ct("session",l,m)].filter((e=>null!==e)).join("; ");at.logInfo(`Applying series symbol params: ${g}`);const y=this.properties().childs();void 0!==t&&y.symbol.setValue(t),void 0!==s&&y.currencyId.setValue(s),void 0!==i&&y.unitId.setValue(i),void 0!==n&&p&&y.metricId.setValue(n),d&&y.interval.setValue((0,r.ensureDefined)(a)),void 0!==o&&_&&y.style.setValue(o);let f=!1;void 0!==l&&m&&(y.sessionId.setValue(l),f=!this.isDWM()),_&&(f||=this.isNeedRestart(),this.onChartStyleChanged());let b=Promise.resolve();return!f&&(h||d||u||c||p)&&(b=this._applySymbolParamsChanges({symbolChanged:h,currencyChanged:u,unitChanged:c,metricChanged:p,intervalChanged:d,styleChanged:_})),(h||u||c||p)&&this.model().checkLineToolSelection(),b}setSymbol(e){this.setSymbolParams({symbol:e})}currency(){return this.properties().childs().currencyId.value()||null}setCurrency(e){this.setSymbolParams({currency:e})}setMetric(e){this.setSymbolParams({metric:e})}isConvertedToOtherCurrency(){return(0,y.isConvertedToOtherCurrency)(this.symbolInfo())}unit(){return this.properties().childs().unitId.value()||null}setUnit(e){this.setSymbolParams({unit:e})}measureUnitId(){return(0,K.isFeatureEnabled)("ytm_on_chart")&&this.symbolInfo()?.metrics?null:(0,y.measureUnitId)(this.symbolInfo())}metric(){return this.properties().childs().metricId.value()||null}isConvertedToOtherUnit(){return(0,y.isConvertedToOtherUnit)(this.symbolInfo(),this._model.unitConversionEnabled())}valueAt(e,t){return this.data().search(e)?.value[t]??null}symbolSource(){return this}symbolSourceWV(){return this._symbolSourceWV.readonly()}barsProvider(){return this}title(e){return this.symbolTitle(e)}name(){return this.symbolTitle(je.TitleDisplayTarget.StatusLine)}symbolTitle(e,t,s){let i=this.properties().childs().symbol.value();const r=this.aliasSymbolInfo();if(null!==r&&(i=(0,y.symbolTitle)(r,t)),s)return i;let n=(0,de.translatedIntervalString)(this.properties().childs().interval.value());return e===je.TitleDisplayTarget.DataWindow&&(n=(0,Qe.forceRTLStr)(n)),`${i}, ${n}`}setObsoleteZOrder(e){this._obsoleteZOrder=e}obsoleteZOrder(){return this._obsoleteZOrder}valuesProvider(){
return this._valuesProvider}legendValuesProvider(){return this._studyBindings?.legendValuesProvider()??this._legendValuesProvider}tableViewValuesProvider(){return this._studyBindings?.tableViewValuesProvider()??this._tableViewValuesProvider}dataWindowValuesProvider(){return this._studyBindings?.dataWindowValuesProvider()??this._dataWindowValuesProvider}chartFloatingTooltipValuesProvider(){return this._chartFloatingTooltipValuesProvider}statusProvider(e){return new ne.SeriesStatusProvider(this,this.properties().childs().statusViewStyle,e)}moveItem(e,t,s){if(10===this.style()&&0===t){const t=this.priceScale(),s=this.properties().childs().baselineStyle,i=t.height(),r=100-e.y/i*100,n=r<0?0:Math.round(10*r)/10;s.childs().baseLevelPercentage.setValue(Math.max(Math.min(n,100),0))}}rerequestData(){this._applySymbolParamsChanges({force:!0})}switchToReplay(e,t,s){this._replaySubscriber.setValue(e),this._isReplayResolutionAvailableForUser=t,this._onInReplayStateChanged.fire(),e.onSeriesModified().subscribe(this,(()=>this._onReplaySubscriberSeriesModified.fire())),e.modifySeries(this.getSymbolString(),this._properties.childs().interval.value(),s),this.rerequestData()}switchToRealtime(){this.isInReplay().value()&&(this._removeReplaySubscriber(),this.rerequestData())}async canChangeResolution(e){{if(!this.isInReplay().value())return!0;const t="changeResolution";if(!(0,r.ensureNotNull)(this._isReplayResolutionAvailableForUser)(e))return this._paramsNotApplicableForReplay.fire(3,t),!1;const s=await(0,r.ensureNotNull)(this._replaySubscriber.value()).canChangeSymbolParams(this.getSymbolString(),e);return s||this._paramsNotApplicableForReplay.fire(2,t),s}}async canChangeSymbol(e){{if(!this.isInReplay().value())return{result:!0};const t=this._getExtendedSymbolObject(e);delete t["currency-id"],delete t["unit-id"];const s=(0,he.encodeExtendedSymbolOrGetSimpleSymbolString)(t),i="changeSymbol";return new Promise((e=>{this._model.chartApi().resolveSymbol((0,L.makeNextSymbolId)(),s,(t=>{if("symbol_error"===t.method)this._paramsNotApplicableForReplay.fire(0,i),e({result:!1,reason:0});else if(t.params[1].is_replayable){const t=this.interval();(0,r.ensureNotNull)(this._isReplayResolutionAvailableForUser)(t)?(0,r.ensureNotNull)(this._replaySubscriber.value()).canChangeSymbolParams(s,t).then((t=>t?e({result:!0}):(this._paramsNotApplicableForReplay.fire(2,i),e({result:!1,reason:2})))):(this._paramsNotApplicableForReplay.fire(3,i),e({result:!1,reason:3}))}else this._paramsNotApplicableForReplay.fire(1,i),e({result:!1,reason:1})}))}))}}requestMoreDataAvailable(){return this._requestMoreDataAvailable}seriesLoaded(){return this._seriesLoaded}endOfData(){return void 0!==this._lastCompleteFlags?.data_completed}endOfDataType(){return this._lastCompleteFlags?.data_completed??null}dataPoweredBy(){return this._dataPoweredBy}boxSizeValue(){return this._boxSizeValue}isUserDeletable(){return!1}changeTimeFrame(){(0,o.trackEvent)("GUI","Change timeframe")}onTagsChanged(){return this._tagsChanged}state(e){const t=this.obsoleteZOrder();let s={type:"MainSeries",
id:this.id(),zorder:t,...this.styleStudyInfos(),formattingDeps:this._formattingDeps,studyBindings:this._studyBindings?.state(!!e)};const i=this.properties().state(void 0,2);if(i.symbol=(0,y.symbolToSaveInState)(this.symbolInfo()??this._model.chartApi().lastSymbolResolveInfo(i.symbol),i.symbol),this._model.unitConversionEnabled()||(i.unitId=null),s.state=i,e){let e=this.bars();const t=this._model.timeScale().visibleExtendedDataRange(e,0);null!==t&&(e=e.range(t.firstBar(),t.lastBar())),s={...s,bars:pt(e),nsBars:pt(this.nsBars()),symbolInfo:this.symbolInfo(),rtPrice:this.data().lastProjectionPrice,boxSize:this.data().boxSize,reversalAmount:this.data().reversalAmount}}return s}restoreState(e,t,s){t&&this._setStatus(5),!this._model.unitConversionEnabled()&&e.state&&delete e.state.unitId,e.state&&T.Interval.isRange(e.state.interval)&&(e.state.style=11);const i=e.state;if(void 0!==i){const e=i.style,t=j.chartStylePermissions.get(e);t&&!this._model.isSnapshot()&&(i.style=2,(0,H.runOrGoProWithoutSync)((()=>{i.style=e}),t.feature,{feature:t.featureName}))}if(this._properties.mergeAndFire(e.state),null!==this._properties.childs().metricId.value()||s||this._properties.childs().metricId.setValue("price"),this._prevChartStyle=this.properties().childs().style.value(),this.createPaneView(),t){const t=e;this.restoreData(t.bars,t.nsBars,t.symbolInfo,t.rtPrice,t.boxSize,t.reversalAmount)}e.formattingDeps&&(this._formattingDeps=e.formattingDeps,this._recreatePriceFormattingDependencies()),this._studyBindings?.restoreState(e.studyBindings??{},t),this._studyBindings?.syncStudy(this.style())}restoreData(e,t,s,i,r,n){this._updateStatus({seriesStatus:5}),this._data=new c.SeriesData,this._data.bars().restoreState(e),this._data.nsBars().restoreState(t),this._updateSymbolInfo(s),this._data.lastProjectionPrice=i,this._data.boxSize=r;const o=this.properties().childs();r||(6===o.style.value()?this._data.boxSize=o.pnfStyle.childs().inputs.childs().boxSize.value():4===o.style.value()&&(this._data.boxSize=o.renkoStyle.childs().inputs.childs().boxSize.value())),this._data.reversalAmount=n,n||5===o.style.value()&&(this._data.reversalAmount=o.kagiStyle.childs().inputs.childs().reversalAmount.value())}async setGotoDateResult(e,t){this._gotoDateResultCleared=!1;const i=await Promise.all([s.e(5538),s.e(88358)]).then(s.bind(s,150288));this._gotoDateResultCleared||(this._gotoDateView=new i.GotoDateView(this,e,t),this._gotoDateView.doNotShowLastAvailableBar(this._doNotShowLastAvailableBar),this._model.updateSource(this))}clearGotoDateResult(){this._gotoDateView=null,this._gotoDateResultCleared=!0}doNotShowLastAvailableBar(e){this._doNotShowLastAvailableBar=e,this._gotoDateView?.doNotShowLastAvailableBar(e)}dataUpdated(){return this.dataEvents().dataUpdated()}moveData(e){const t=this._seriesSource.moveData(e);null!==this._volumePointWeights&&this._volumePointWeights.moveData(e),this._studyBindings?.moveData(e),t.then((()=>{this._isDestroyed||this.bars().isEmpty()||this._onIndexDiffsApplied(e)}))}async seriesCreated(){const e=this._seriesSource.instanceId()
;if(null!==e)return e;const t=await Promise.race([this._deferredDestroyed.promise.then((()=>{})),this._model.isSnapshot()?Promise.resolve(null):new Promise((e=>{this.dataEvents().created().subscribe(this,e,!0)}))]);if(void 0===t)throw new Error("Series has been destroyed");return t}activeStudyBinding(){return this._studyBindings?.activeStudy()??null}contextMenuStatName(){return"SeriesContextMenu"}_updateBarFunction(){this._barFunction=(0,Be.barFunctionByStyle)(this.style(),this.priceSource())}_updateSessionIdProxyProperty(e){const t=this._properties.childs().sessionId.value();let s=t;if(e){const e=this.symbolInfo();null!==e&&(s=e.subsession_id||t)}this._ignoreSessionIdProxyPropertyChanges=!0,this._sessionIdProxyProperty.setValue(s),this._ignoreSessionIdProxyPropertyChanges=!1}_onSessionIdProxyPropertyChanged(){this._ignoreSessionIdProxyPropertyChanges||this._properties.childs().sessionId.setValue(this._sessionIdProxyProperty.value()),this._updateLastPriceAnimationActive()}_onSymbolResolved(e){this._seriesErrorMessage=null,this._updateSymbolInfo(e),this._model.updateSource(this),this._model.onWidget()||((0,o.trackEvent)("Symbol",e.listed_exchange,e.name),(0,o.trackEvent)("Symbol Type",e.type,e.listed_exchange));const t=e.minmov/e.pricescale,s=this.properties().childs();4===s.style.value()&&s.renkoStyle.childs().inputs.childs().boxSize.value()<t?s.renkoStyle.childs().inputs.merge({boxSize:t}):6===s.style.value()&&s.pnfStyle.childs().inputs.childs().boxSize.value()<t?s.pnfStyle.childs().inputs.merge({boxSize:t}):5===s.style.value()&&s.kagiStyle.childs().inputs.childs().reversalAmount.value()<t&&s.kagiStyle.childs().inputs.merge({reversalAmount:t}),this._checkChartStyle(),this._formattingDeps={format:e.format,pricescale:e.pricescale,minmov:e.minmov,fractional:e.fractional,minmove2:e.minmove2,variable_tick_size:e.variable_tick_size},this._updateLastPriceAnimationActive()}_onSymbolError(e){this._setStatus(4),this._properties.childs().shortName.setValue(this._properties.childs().symbol.value()),this._model.clearAllStudies(),this.updateAllViews((0,ge.sourceChangeEvent)(this.id())),this._model.updateSource(this),this._sendTelemetryCounter("symbol_error",this._getTelemetryAdditionalData(e,!1)),this._symbolResolvingActive.setValue(!1)}_sendTelemetryCounter(e,t){void 0===t&&(t=this._getTelemetryAdditionalData());const s=Object.assign({count:1},{additional:t});F.telemetry.sendChartReport(e,s)}_getTelemetryAdditionalData(e,t){t=void 0===t||t;const s={symbol:this.actualSymbol()};return t&&(s.resolution=this.interval()),void 0!==e&&(s.reason=e),s}_onSeriesTimeFrame(e,t,s,i,r){const n=(0,y.isSingleValueBasedStyle)(this.style())?e+.5:e;let o=t;if(void 0===r)null!==s&&"period-back"!==s.type||(o+=this._model.studyAwareDefaultRightOffset());else if(r.applyDefaultRightMargin)o+=this._model.studyAwareDefaultRightOffset();else if(r.percentRightMargin){const e=t-n+1,s=Math.max(0,Math.min(.99,r.percentRightMargin/100));o+=s*e/(1-s)}this._model.setTimeViewport(n,o)}_onSeriesError(e){let t=e.error;const s=e.ctx;if(s){const e={}
;Object.keys(s).forEach((t=>{e[t]=s[t].toString()})),t=t.format(e)}nt&&at.logNormal("Error reason: "+t),this._seriesErrorMessage=t;const i=rt&&this.symbolInfo()?10:4;this._setStatus(i),this._seriesLoaded=!0,this._sendTelemetryCounter("series_error",this._getTelemetryAdditionalData(t)),this._enablePriceRangeReady()}_onSeriesLoading(e){this._setStatus(2)}_onDataUpdated(e,t,s,i,n){t&&n&&this._colorOnPrevBar()&&this._precomputedBarStyles.delete(n.value);const o=this.symbolInfo();if(i&&o){let e=0,t=0;if((0,y.hasVolume)(o))for(const s of this.bars().fullRangeIterator()){const i=s.value[5];0!==i&&(e+=i,t+=1)}this._volumePointWeights=t>0?new Y.VolumeBasedTimePointWeights(e/t):null,this._updateTimeScaleTimePointWeights()}if(null!==this._volumePointWeights){const e=t?this.bars().fullRangeIterator():s?this.bars().rangeIterator(s.index,(0,r.ensureNotNull)(this.bars().lastIndex())):null;if(null!==e)for(const t of e)this._volumePointWeights.setVolume(t.index,t.value[5])}t?this._requestMoreDataAvailable=!0:this._lastPriceAnimationActive&&this._seriesLoaded&&this._lineStyleLastPriceCirclePaneView.update((0,ge.sourceChangeEvent)(this.id())),this._lastBarCloseTime=e&&e.closeTime||null,this._boxSizeValue.setValue(this.data().boxSize),this._statusView.update();const a=this.bars().firstIndex(),l=this.bars().lastIndex();null!==a&&null!==l?this._dataRangeUpdated.fire({type:"partial",startIndex:s?.index??a,endIndex:t?n?.index??l:l}):this._dataRangeUpdated.fire({type:"full"}),this.clearAveragePriceCache(),this.clearHighLowPriceCache();const h=this.model(),d=(0,r.ensureNotNull)(h.paneForSource(this));h.recalculatePane(d,(0,ge.sourceChangeEvent)({sourceId:this.id(),realtime:!t,firstUpdatedTimePointIndex:s?.index??void 0})),h.updateSource(this)}_plotsDataRange(){const e=this.bars().firstIndex(),t=this.bars().lastIndex();return null!==e&&null!==t?[e,t]:null}_setStatus(e){const t={...this._status.value(),seriesStatus:e};this._updateStatus(t),this._statusView.update(),this.model().updateSource(this),this._onStatusChanged.fire()}_onBarReceived(e){this.model().recalcVisibleRangeStudies(u.RecalcVisibleRangeStudiesReason.DataUpdate)}_onUnsupportedResolutionRequested(){const e=(0,r.ensureNotNull)(this._getStateForUnsupportedResolution());this._seriesErrorMessage=e.reason,this._unsupportedResolutionState.setValue(e),this._setStatus(14),this._seriesLoaded=!0,this.clearData(),this._model.timeScale().points().clear(),this._enablePriceRangeReady()}_getStateForUnsupportedResolution(){const e=this.symbolInfo();if(null===e)return null;const t=this.interval(),s=(0,Me.getResolutionUnsupportedReason)(e,t);if(null===s)return null;const i=e.name;if("less_than_frequency"!==s){let e=["D","W","M"];return{ticker:i,reason:s,unsupportedResolution:t,applicableResolution:e[0],supportedResolutions:e}}{const n=(0,r.ensureDefined)(e.data_frequency);let o=(0,ye.getApplicableIntervalForFrequency)(n,t);const a=this._model.defaultResolutions();if(!(a.includes(o)||window.is_authenticated&&window.user.is_pro)){const e=a.find((e=>(0,ye.compareResolutions)(e,o)>=0))
;o=e??a[a.length-1]}return{ticker:i,reason:s,applicableResolution:o,unsupportedResolution:t,supportedResolutions:[]}}}_recreateFormatter(){this._defaultFormatter=(0,y.createSeriesFormatter)(this.aliasSymbolInfo()??this._formattingDeps,"default"),this._formatter=(0,y.createSeriesFormatter)(this.aliasSymbolInfo()??this._formattingDeps,this.properties().childs().minTick.value()),this._ignoreMinMoveFormatter=(0,y.createSeriesFormatter)(this.symbolInfo(),this.properties().childs().minTick.value(),!0),this._priceScale?.updateFormatter(),this._formatterChanged.fire()}_recreatePriceStep(){const{minMove:e,priceScale:t}=(0,y.getSeriesPriceFormattingState)(this.symbolInfo()),s=e/t;this._ignoreMinMovePriceStep=1/t,this._priceStep!==s&&(this._priceStep=s,this._priceStepChanged.fire())}_recreatePriceFormattingDependencies(){this._recreateFormatter(),this._recreatePriceStep()}_onQuotesUpdate(e,t){{const s=void 0!==t.values.change||void 0!==t.values.change_percent;s&&lt&&this._legendView.update();const i=void 0!==t.values.prev_close_price;i&&((0,r.ensureNotNull)(this._prevClosePriceLineView).update((0,ge.sourceChangeEvent)(this.id())),(0,r.ensureNotNull)(this._prevClosePriceAxisView).update((0,ge.sourceChangeEvent)(this.id()))),(s||i)&&this.model().updateSource(this),this._quotesLastSplits.setValue(e.values.last_splits??null)}void 0!==e.values.current_session&&e.values.current_session!==this._currentSession&&(this._currentSession=e.values.current_session,this._updateLastPriceAnimationActive())}_updateIsPrePostMarketPricesForbiddenProperty(){const e=this.symbolInfo(),t=(0,y.symbolHasPreOrPostMarket)(e)&&(this.isDWM()||!!e&&(0,y.isRegularSessionId)(this.sessionIdProxyProperty().value(),e));this._isPrePostMarketPricesAvailableProperty.setValue(t)}_updateSettlementAsCloseForbiddenProperty(){const e=this.isDWM()&&Boolean(this.symbolInfo()?.has_settlement);this._isSettlementAsCloseForbiddenProperty.setValue(!e)}_updateBackAdjustmentForbiddenProperty(){const e=Boolean(this.symbolInfo()?.has_backadjustment);this._isBackAdjustmentForbiddenProperty.setValue(!e)}_removeReplaySubscriber(){{if(!this.isInReplay().value())return;const e=this._replaySubscriber.value();this._replaySubscriber.setValue(null),this._isReplayResolutionAvailableForUser=null,this._onInReplayStateChanged.fire(),e?.onSeriesModified().unsubscribeAll(this),e?.destroy()}}_getSymbolForApi(){return this.symbol()}_getSymbolObject(e){const t=this._getExtendedSymbolObject(e),s=this.properties().childs().style.value();if(v.SYMBOL_STRING_DATA.hasOwnProperty(s)&&!v.chartStylesWithAttachedStudies.includes(s)){return{symbol:t,type:this.styleStudyInfo(this.getStyleShortName()+"Style").studyId+"!",inputs:this.getInputsProperties().state()}}return t}_getExtendedSymbolObject(e,t){const s={symbol:e??this._getSymbolForApi()},i=this.properties().childs(),n=this.currency();null!==n&&(s["currency-id"]=n);const o=this.unit();this._model.unitConversionEnabled()&&null!==o&&(s["unit-id"]=o);const a=this.metric();return this._model.metricConversionEnabled()&&null!==a&&!t&&(s.metric=a),
this.isDWM()||(s.session=i.sessionId.value()),s.adjustment=(0,r.ensureDefined)(i.dividendsAdjustment).value()?"dividends":"splits",i.backAdjustment.value()&&(s.backadjustment="default"),i.settlementAsClose.value()||(s["settlement-as-close"]=!1),s}_checkChartStyle(){const e=this.style();(0,y.isCloseBasedSymbol)(this.symbolInfo())||this.intervalObj().value().is1Tick()?(0,y.isSingleValueBasedStyle)(e)||(this.requestingStyleIsNotSupported.fire(),this._styleToRecover={correctedStyle:this.style(),originalStyle:e}):"hlc"===this.symbolInfo()?.visible_plots_set?(0,y.isHLCBasedStyle)(e)||(0,y.isSingleValueBasedStyle)(e)||(this.requestingStyleIsNotSupported.fire(),this._styleToRecover={correctedStyle:this.style(),originalStyle:e}):null!==this._styleToRecover&&(this.requestingStyleSupportRecovered.fire(this._styleToRecover.originalStyle),this._styleToRecover=null)}_updateSymbolInfo(e){if(this._symbolInfo.setValue(e),e){const t=this._getResolvingSymbolObject(),s=this._properties.childs();s.shortName.setValue(e.name);const r=(0,f.extractSymbolNameFromSymbolInfo)(e,this.symbol());r&&s.symbol.setValue(r);const n=(0,y.symbolCurrency)(e),o=(0,y.symbolUnit)(e,this._model.unitConversionEnabled()),a=(0,y.symbolMetric)(e,this._model.metricConversionEnabled());"alwaysOff"===(0,C.currencyUnitMetricVisibilityProperty)().value()||n===s.currencyId.value()&&o===s.unitId.value()||this._model.fullUpdate(),s.currencyId.setValue(n),s.unitId.setValue(o),s.metricId.setValue(a);const l=this._getResolvingSymbolObject(),h=this._seriesSource.symbol();(0,i.default)(t,h)&&!(0,i.default)(l,h)&&this._seriesSource.updateExtSymbol(l),this._updateSessionIdProxyProperty(!0)}const t=this.aliasSymbolInfo();this._base=t?t.pricescale/t.minmov:100,this._pointValue=e&&e.pointvalue||1;const s=this.getQuotesSymbolString();s!==this._quotesProvider.symbol()&&this._quotesLastSplits.setValue(null),this._quotesProvider.setQuotesSessionSymbol(s),this._marketStatusModel.setSymbolInfo(e),e&&this._recreatePriceFormattingDependencies(),this._statusView.update(),this.priceScale().updateFormatter(),this._symbolResolvingActive.setValue(!e),this._updateIsPrePostMarketPricesForbiddenProperty(),this._dataPoweredBy=(0,E.getDataVendorString)(e),this._updateBackAdjustmentForbiddenProperty(),this._updateSettlementAsCloseForbiddenProperty()}_createHighLowAvgViews(){const e=this.properties().childs().highLowAvgPrice,t=this._getHighLowPrice.bind(this),s=(0,se.createHighLowViews)(this._model,this,e,t);this._highLowAvgPaneViews.push(...s.paneViews),this._labelPaneViews.push(...s.panePriceAxisViews),this._priceAxisViews.push(...s.priceAxisViews),this._priceLineAxisViews.push(...s.priceLineAxisViews)}_createAverageViews(){}_getHighLowPrice(e){if(!this._highLowPriceCache.has(e)){const e=this._model.timeScale().visibleBarsStrictRange();if(null===e)return null;const t=function(e,t,s){return e.minMaxOnRangeCached(t,s,[{name:"low",offset:0},{name:"high",offset:0}])}(this._model.mainSeries().bars(),e.firstBar(),e.lastBar());if(null===t)return null;this._highLowPriceCache.set(1,t.min),
this._highLowPriceCache.set(0,t.max)}return this._highLowPriceCache.get(e)}_getAveragePrice(e){return null}_updateCompleteStatusMode(e){switch(e="pulsed"===e?"delayed":e){case"streaming":this._setStatus(3);break;case"endofday":this._setStatus(6);break;case"delayed":this._setStatus(8);break;case"replay":this._setStatus(11)}e.match(/delayed_streaming/)&&this._setStatus(9)}_onSeriesCompleted(e){if(14===this._status.value().seriesStatus)return;this._sendTelemetryCounter("series_loaded",this._getTelemetryAdditionalData()),this._seriesErrorMessage=null,this._updateCompleteStatusMode(e.updateMode),this._lastCompleteFlags=e.flags??null;const t=(0,r.ensureNotNull)(this._model.paneForSource(this));t.recalculatePriceScale(this.priceScale(),(0,ge.sourceChangeEvent)(this.id()));const i=ce.InvalidationMask.full();if(null!==this._model.appliedTimeFrame().value()&&i.lockVisibleTimeRangeOnResize(),this._model.invalidate(i),!this.priceScale().isLockScale()||this.model().timeScale().isEmpty()||this._seriesLoaded||(this.model().timeScale().correctOffset(),this.model().timeScale().correctBarSpacing(),this.model().resetPriceScale(t,this.priceScale())),this._seriesLoaded=!0,this._seriesCompleted=!0,this.model().recalcVisibleRangeStudies(u.RecalcVisibleRangeStudiesReason.SeriesCompleted),this.model().recalcStudyBasedLineTools(),!dt){dt=!0;(0,s(613092).trackTiming)("Chart","Time to series",window.performance.now())}if(this.requestMoreData(),null!==this._savedLeftEdge&&2!==this._status.value().seriesStatus){const e=1e3*this._savedLeftEdge,t=this._pendingScrollToLeftEdge;setTimeout((()=>{this._model.syncTimeWithModel((0,r.ensureNotNull)(this.syncModel()).syncSourceTarget(),e,{targetPointAlignment:"left",alignIfTargetPointIsVisible:!0,autoscaleAfterScroll:!1}).then((()=>{t?.resolve()})).catch((()=>{}))}),0),this._savedLeftEdge=null,this._pendingScrollToLeftEdge=null}this._enablePriceRangeReady()}_onSeriesDataCleared(){this._dataRangeUpdated.fire({type:"full"})}_notifyIntervalChanged(e){const t={timeframe:this._pendingTimeRange??void 0};this._intervalChanged.fire(e,t),this._pendingTimeRange=t.timeframe??null}_onCurrencyChanged(){this._currencyChanged.fire()}_onUnitChanged(){this._unitChanged.fire()}_onMetricChanged(){this._metricChanged.fire()}_saveLeftEdgeIfRequired(e,t=null){if(this._savedLeftEdge=null,!t&&!e&&this._model.properties().childs().scalesProperties.childs().saveLeftEdge.value()){const e=this._model.timeScale();if(!e.isEmpty()){let t=e.visibleBarsStrictRange()?.firstBar();if(void 0!==t){const s=this._seriesSource.data()?.bars().first();return null!=s&&(t=Math.max(t,s.index)),this._savedLeftEdge=e.indexToTimePoint(t),this._pendingScrollToLeftEdge=(0,h.createDeferredPromise)(),!0}}}return!1}async _processReplayOnApplySymbolParamsChanges(e,t){if(this.isInReplay().value()){const s=()=>this._removeReplaySubscriber();e&&(T.Interval.isRange(t)||T.Interval.isTicks(t)&&!ht?s():(0,r.ensureNotNull)(this._isReplayResolutionAvailableForUser)(t)?await this.canChangeResolution(t)||s():(s(),
this._paramsNotApplicableForReplay.fire(3,"changeResolution")))}}async _applySymbolParamsChanges(e){this._lastCompleteFlags=null,this.clearGotoDateResult();const t=this.interval(),s=this.currency(),i=this.unit(),r=this.metric();T.Interval.isRange(t)&&this._properties.childs().rangeStyle.childs().inputs.childs().range.setValue(T.Interval.parse(t).multiplier());const{symbolChanged:n,intervalChanged:o,currencyChanged:a,unitChanged:l,metricChanged:h,force:d}=e,c=o&&T.Interval.parse(t).isDWM()!=T.Interval.parse(t).isDWM();if((null!==s&&a||null!==i&&l||null!==r&&h)&&this.isInReplay().value()){const e=this.symbolInfo();(null===e||null!==s&&e.original_currency_id!==s||null!==i&&e.original_unit_id!==i)&&this._removeReplaySubscriber()}if(this._syncModel=null,this._prevRequestedInterval=t,5!==this._status.value().seriesStatus&&(!this._seriesSource.isStarted()||n||a||l||h||c)&&this._updateSymbolInfo(null),this._processReplayOnApplySymbolParamsChanges(!!o,t),5===this._status.value().seriesStatus)return void this._model.realignLineTools();this._setStatus(1),this._updateIsPrePostMarketPricesForbiddenProperty(),this._updateBackAdjustmentForbiddenProperty(),this._updateSettlementAsCloseForbiddenProperty(),this._symbolIntervalChanged.fire(),o&&this._notifyIntervalChanged(t),this._onRestarted.fire(),this._seriesLoaded=!1,this._seriesCompleted=!1,this._lineStyleLastPriceCirclePaneView.stopAnimation();let p=null;this._pendingTimeRange&&(p=this._pendingTimeRange,this._pendingTimeRange=null),this._onTimeFrameApplied.fire(p),this._onBeforeModifySeries(this.getSymbolString(),t);const _=this._shouldDefineNumberOfBarsForModifySeries(e)&&this._visibleBarsCount()||null;this.model().recalcVisibleRangeStudies(u.RecalcVisibleRangeStudiesReason.SeriesRestart),this._saveLeftEdgeIfRequired(!!n,p),this._data=null,this._seriesSource.modifySeries(this._getResolvingSymbolObject(),(0,fe.getServerInterval)(t),p,d,_),this._seriesSource.isStarted()||(this._predictBars=0,this._seriesSource.start()),(n||a||l)&&this.disablePriceRangeReady(),this.updateAllViews((0,ge.sourceChangeEvent)(this.id())),this._model.lightUpdate(),this._pendingScrollToLeftEdge&&await this._pendingScrollToLeftEdge.promise}async _onBeforeModifySeries(e,t){const s=this._replaySubscriber.value();s?.modifySeries(e,t)}_getResolvingSymbolObject(){let e=this._getSymbolObject(this._symbolForResolve());const t=this._replaySubscriber.value();return t&&(e=t.generateReplaySymbol(e)),e}_onSessionIdPropertyChanged(){this._sessionIdChanged.fire(),this.isDWM()||(this._saveLeftEdgeIfRequired(!1),this.restart(!0),this._updateLastPriceAnimationActive()),this._syncModel=null}_subscribeRestartToSessionIdChange(){this.properties().childs().sessionId.subscribe(this,this._onSessionIdPropertyChangedBound)}_unsubscribeRestartToSessionIdChange(){this.properties().childs().sessionId.unsubscribe(this,this._onSessionIdPropertyChangedBound)}_updateLastPriceAnimationActive(){if(!this._options.lastPriceAnimationEnabled||(0,l.isFeaturesetEnabled)("disable_pulse_animation"))return
;const e=this._lastPriceAnimationActive,t=this.properties().childs(),s=t.style.value(),i=3===s||10===s||2===s||14===s||15===s,r=this.symbolInfo();if(!this._model.isSnapshot()&&t.visible.value()&&i&&r){const e=this.currentSession(),t=!(0,y.isRegularSessionId)(this.sessionIdProxyProperty().value(),r)&&!this.isDWM();this._lastPriceAnimationActive="market"===e||t&&("pre_market"===e||"post_market"===e)}else this._lastPriceAnimationActive=!1;this._lastPriceAnimationActive&&e!==this._lastPriceAnimationActive&&this.model().invalidate(ce.InvalidationMask.cursor())}_onPropertiesChanged(e){const t=this._properties.childs();if(e===t.symbol||e===t.interval||e===t.timeframe)return;const s=this._id.value();this._tagsChanged.fire(),this.createPaneView(),this.updateAllViews((0,ge.sourceChangeEvent)(s)),this.model().updateSource(this),(0,a.emit)("series_properties_changed",s)}_recalcSymbolTextSourceProxyProperty(){this._textSourceIsAlwaysTickerRestrictionEnabled?this._symbolTextSourceProxyProperty.setValue("ticker"):this._symbolTextSourceProxyProperty.setValue(this._properties.childs().statusViewStyle.childs().symbolTextSource.value())}_clearStylePlot(e,t){if(0===e.size())return;if(void 0===t&&e!==this.nsBars())return void(this._precomputedBarStyles=new WeakMap);const s=t??(0,r.ensureNotNull)(e.firstIndex()),i=(0,r.ensureNotNull)(e.lastIndex())+1;e.range(s,i).each(((e,t)=>(this._precomputedBarStyles.delete(t),!1)))}_visibleBarsCount(){const e=this._model.timeScale().visibleBarsStrictRange();return e?.count()}_symbolForResolve(){const e=this.symbol();return this._seriesSource.symbolSameAsResolved(e)?this._seriesSource.resolvedSymbol()??e:e}_shouldDefineNumberOfBarsForModifySeries(e){return!1}_onShowCountdownChanged(e){e.value()?this._countdownUpdateTimer=this._model.setInterval((()=>{this._priceAxisView.updateCountdown?.(),this._projectionPriceAxisView.updateCountdown?.()}),500):null!==this._countdownUpdateTimer&&(this._model.clearInterval(this._countdownUpdateTimer),this._countdownUpdateTimer=null)}_onFormatterPropsChanged(){this._recreateFormatter(),this._model.fullUpdate()}_updateStatus(e){14!==e.seriesStatus&&this._unsupportedResolutionState.setValue(null),this._status.setValue(e)}_wasCompletedBefore(){return this.isCompleted()&&(this._studyBindings?.wasCompletedBefore()??!0)}_colorOnPrevBar(){const e=new Map([[1,"candleStyle"],[0,"barStyle"],[19,"volCandlesStyle"],[8,"haStyle"],[13,"columnStyle"]]);e.set(17,"volFootprintStyle");const t=e.get(this.style());return!!t&&this._properties.childs()[t].childs().barColorsOnPrevClose.value()}_restartIfStyleMatches(e){this.style()===e&&this.restart()}}},453843:(e,t,s)=>{"use strict";s.d(t,{types:()=>i});const i={ECONOMIC:"economic",QUANDL:"quandl"}},702:(e,t,s)=>{"use strict";function i(e){const t={};if(-1===e.indexOf("@"))t.shortId=e,t.packageId="tv-basicstudies",t.id=e+"@"+t.packageId,t.version=1;else{const s=e.split("@");t.shortId=s[0];const i=s[1].split("-");if(3===i.length)t.packageId=i.slice(0,2).join("-"),t.id=t.shortId+"@"+t.packageId,
t.version=parseInt(i[2]);else if(1===i.length&&"decisionbar"===i[0])t.packageId="les-"+i[0],t.id=t.shortId+"@"+t.packageId,t.version=1;else{if(1!==i.length)throw new Error("unexpected study id:"+e);t.packageId="tv-"+i[0],t.id=t.shortId+"@"+t.packageId,t.version=1}}if(t.fullId=t.id+"-"+t.version,"tv-scripting"===t.packageId){const e=t.shortId;if(0===e.indexOf("Script$")||0===e.indexOf("StrategyScript$")){const s=e.indexOf("_");t.productId=s>=0?e.substring(0,s):t.packageId}else t.productId=t.packageId}else t.productId=t.packageId;return t}s.d(t,{parseIdString:()=>i})},80130:(e,t,s)=>{"use strict";window.TradingView=window.TradingView||{},s(952375).setClasses(),s(409562),s(531394).install(),s(376596),s(686923),s(780927),s(434612),s(137995),s(788312),s(724226),s(726026),s(950808),s(56582)},315709:(e,t,s)=>{"use strict";s(260156),s(80130);var i=s(185842),r=s(266150),n=s(950808);(0,r.isFeaturesetEnabled)("use_localstorage_for_settings")&&n.default.sync(void 0);var o=s(729193),a=s(253193),l=s(807434),h=s(683214),d=s(970013),u=s(733149),c=s(110443),p=s(521928),_=s.n(p),m=s(190835),g=s.n(m),y=s(660101),f=s(70346),b=s(357966),S=s(466269);function v(){return Promise.all([s.e(98111),s.e(11607),s.e(93066)]).then(s.bind(s,242614))}var w=s(168509);class x{constructor(e,t){this._visibility=new w.WatchedValue(!1),this._dialogPromise=null,this._dialog=null,this._chartWidgetCollection=e,this._options=t}visible(){return this._visibility.readonly()}show(e,t,s){const i=Array.isArray(e)?e:[],r=Array.isArray(e)?void 0:e;null===this._dialog&&this._requestDialog(i??[],t,s,r),this._dialog?.open(i??[],this._options?.indicatorsPreloader?.getIndicatorPromises(),t,s,r)}hide(){this._dialog?.hide()}getDialog(){return this._dialog}resetAllPages(){this._dialog?.resetAllStudies()}_requestDialog(e,t,i,r){if(null===this._dialogPromise){let n
;n=this._options?.onWidget?Promise.all([s.e(20661),s.e(64116),s.e(98115),s.e(57032),s.e(1967),s.e(46970),s.e(50865),s.e(48072),s.e(63665),s.e(75828),s.e(97627),s.e(74354),s.e(24977),s.e(31788),s.e(15365),s.e(45448),s.e(92597),s.e(18257),s.e(86834),s.e(27688),s.e(48011),s.e(92568),s.e(60627),s.e(96872),s.e(68805),s.e(80387),s.e(75174),s.e(87795),s.e(57350),s.e(36430),s.e(24193),s.e(96793),s.e(72644),s.e(93787),s.e(77141),s.e(75350),s.e(77202),s.e(99826),s.e(78898),s.e(83945),s.e(28602),s.e(76331),s.e(7972),s.e(5355),s.e(70354),s.e(86316),s.e(32387),s.e(80915),s.e(67890),s.e(30910),s.e(93474),s.e(46439)]).then(s.bind(s,310159)).then((e=>new e.IndicatorsLibraryContainer(this._chartWidgetCollection,this._options))):Promise.all([s.e(20661),s.e(64116),s.e(98115),s.e(57032),s.e(1967),s.e(46970),s.e(50865),s.e(48072),s.e(63665),s.e(75828),s.e(97627),s.e(74354),s.e(24977),s.e(31788),s.e(15365),s.e(45448),s.e(92597),s.e(18257),s.e(86834),s.e(27688),s.e(48011),s.e(92568),s.e(60627),s.e(96872),s.e(68805),s.e(80387),s.e(75174),s.e(87795),s.e(57350),s.e(36430),s.e(24193),s.e(96793),s.e(72644),s.e(93787),s.e(77141),s.e(75350),s.e(77202),s.e(99826),s.e(78898),s.e(83945),s.e(28602),s.e(76331),s.e(7972),s.e(5355),s.e(70354),s.e(86316),s.e(32387),s.e(80915),s.e(67890),s.e(30910),s.e(93474),s.e(46439)]).then(s.bind(s,264442)).then((e=>new e.IndicatorsContainerMainChart(this._chartWidgetCollection))),this._dialogPromise=n.then((s=>{this._dialog=s,this._dialog.visible().subscribe((e=>{this._visibility.setValue(e)})),this._dialog.open(e,this._options?.indicatorsPreloader?.getIndicatorPromises(),t,i,r)}))}return this._dialogPromise}}var P=s(368321),C=s(64906),T=s(513852),V=s(952375),A=s(501434),D=s(273969),I=s(60554);const R={8:[A.timeFrames.ytd,A.timeFrames["12m"],A.timeFrames["60m"],A.timeFrames.all],3:[A.timeFrames["1d"],A.timeFrames["5d"],A.timeFrames["1m"],A.timeFrames["3m"],A.timeFrames["6m"],A.timeFrames.ytd,A.timeFrames["12m"],A.timeFrames["60m"],A.timeFrames.all]},L=new Map([["1D",(0,I.getFromForDay)(1)],["5D",(0,I.getFromForDay)(5)],["7D",(0,I.getFromForDay)(7)],["1M",(0,I.getFromForMonthsAgo)(1)],["3M",(0,I.getFromForMonthsAgo)(3)],["6M",(0,I.getFromForMonthsAgo)(6)],["12M",(0,I.getFromForYearsAgo)(1)],["24M",(0,I.getFromForYearsAgo)(2)],["36M",(0,I.getFromForYearsAgo)(3)],["60M",(0,I.getFromForYearsAgo)(5)],["YTD",(0,I.getStartOfTheYear)()],["LASTSESSION",(0,I.getFromForDay)(1)],["ALL",-1/0]]);function k(e,t,s=-1/0){let r;null!==e?r=(R[3]||[]).filter((t=>null===(0,D.getResolutionUnsupportedReason)(e,t.targetResolution))):(9===t&&(t=3),6===t&&(t=8),r=R[t]||[]);const n=[];for(let e=0;e<r.length;e++){const t=r[e];if(n.push(t),(0,i.ensureDefined)(L.get(t.value.value))<s)break}return n.length&&"ALL"!==n[n.length-1].value.value&&(n[n.length-1]={...n[n.length-1],text:A.timeFrames.all.text,value:{...n[n.length-1].value,value:A.timeFrames.all.value.value}}),n}function E(e,t,s){const i={name:e,frameElementId:t,data:s};window.parent.postMessage(i,"*")}function F(e,t){function s(s){s.data&&s.data.name&&s.data.name===e&&t(s.data.data)}
return window.addEventListener("message",s,!1),()=>{window.removeEventListener("message",s,!1)}}var N,M;function B(e){return"seekingalpha"===e||"smartlab-custom"===e?Promise.all([s.e(89611),s.e(57032),s.e(1967),s.e(63665),s.e(24977),s.e(74528),s.e(31788),s.e(45448),s.e(6406),s.e(18257),s.e(20432),s.e(35424),s.e(12559),s.e(60627),s.e(73133),s.e(75649),s.e(59717),s.e(63935),s.e(29984),s.e(4050),s.e(26729),s.e(31403),s.e(25947),s.e(497),s.e(66985),s.e(44591),s.e(78399),s.e(24193),s.e(24025),s.e(57435),s.e(25361),s.e(28209),s.e(83986),s.e(27097),s.e(61274),s.e(97493),s.e(95907),s.e(69883),s.e(6819),s.e(50889),s.e(94150),s.e(83945),s.e(89212),s.e(99393),s.e(50019),s.e(32387),s.e(17686),s.e(53233),s.e(20560),s.e(21438),s.e(49486),s.e(44013),s.e(13447),s.e(39318)]).then(s.bind(s,239318)):"cme"===e?Promise.all([s.e(37425),s.e(57032),s.e(1967),s.e(63665),s.e(24977),s.e(74528),s.e(31788),s.e(45448),s.e(6406),s.e(18257),s.e(20432),s.e(35424),s.e(12559),s.e(60627),s.e(73133),s.e(75649),s.e(59717),s.e(63935),s.e(29984),s.e(4050),s.e(26729),s.e(31403),s.e(25947),s.e(497),s.e(66985),s.e(44591),s.e(78399),s.e(24193),s.e(24025),s.e(57435),s.e(25361),s.e(28209),s.e(83986),s.e(27097),s.e(61274),s.e(97493),s.e(95907),s.e(69883),s.e(6819),s.e(50889),s.e(94150),s.e(83945),s.e(89212),s.e(32387),s.e(17686),s.e(53233),s.e(20560),s.e(21438),s.e(49486),s.e(44013),s.e(13447),s.e(67206)]).then(s.bind(s,667206)):Promise.all([s.e(58871),s.e(57032),s.e(1967),s.e(63665),s.e(24977),s.e(74528),s.e(31788),s.e(45448),s.e(6406),s.e(18257),s.e(20432),s.e(35424),s.e(12559),s.e(60627),s.e(73133),s.e(75649),s.e(59717),s.e(63935),s.e(29984),s.e(4050),s.e(26729),s.e(31403),s.e(25947),s.e(497),s.e(66985),s.e(44591),s.e(78399),s.e(24193),s.e(24025),s.e(57435),s.e(25361),s.e(28209),s.e(83986),s.e(27097),s.e(61274),s.e(97493),s.e(95907),s.e(69883),s.e(6819),s.e(50889),s.e(94150),s.e(83945),s.e(89212),s.e(99393),s.e(32387),s.e(17686),s.e(53233),s.e(20560),s.e(21438),s.e(49486),s.e(44013),s.e(13447),s.e(9574)]).then(s.bind(s,509574))}!function(e){let t;!function(e){e.SetSymbol="set-symbol",e.SetInterval="set-interval"}(t=e.Names||(e.Names={}))}(N||(N={})),function(e){let t;!function(e){e.SymbolClick="tv-widget-symbol-click",e.WidgetLoad="tv-widget-load",e.WidgetReady="tv-widget-ready",e.ResizeIframe="tv-widget-resize-iframe",e.NoData="tv-widget-no-data"}(t=e.Names||(e.Names={}))}(M||(M={}));var O=s(49833),W=s(187614),z=s(376596),H=s(277637);const j=["LineToolTrendLine","LineToolRay","LineToolInfoLine","LineToolExtended","LineToolRegressionTrend","LineToolRotatedRectangle","LineToolParallelChannel","LineToolFlatBottom","LineToolDisjointAngle","LineToolPitchfork","LineToolSchiffPitchfork","LineToolSchiffPitchfork2","LineToolInsidePitchfork","LineToolVertLine","LineToolCrossLine","LineToolHorzLine","LineToolHorzRay","LineToolTrendAngle"];function U(e,t=!1,a=!1){if(!(0,r.isFeaturesetEnabled)("popup_hints"))return()=>{};const l=e.getContainer();let h=null,d=null,u=null;return O.tool.subscribe(c),O.createdLineTool.subscribe(null,p),O.finishedLineTool.subscribe(null,_),
e.layoutSizesChanged().subscribe(m),t||z.CheckMobile.any()||!y("hint.startFocusedZoom")||(u=function(e,t){let s=!1;const i=r=>{r?(s&&t(r),e.onZoom().unsubscribe(null,i)):s||(t(r),s=!0)};return e.onZoom().subscribe(null,i),()=>e.onZoom().unsubscribe(null,i)}(e,(function(e){if(!y("hint.startFocusedZoom"))return;if(e)d&&(u=null,f("hint.startFocusedZoom"));else{g(o.t(null,void 0,s(475299)).format({key:(0,H.humanReadableModifiers)(H.Modifiers.Mod,!1)}),"hint.startFocusedZoom")}}))),()=>{O.tool.unsubscribe(c),O.createdLineTool.unsubscribe(null,p),O.finishedLineTool.unsubscribe(null,_),e.layoutSizesChanged().unsubscribe(m),u?.()};function c(){const t=O.tool.value(),i=z.CheckMobile.any();if(h?.hide(),!i&&(0,O.toolIsDemonstration)(t)&&y("hint.demonstrationCursorSelected")){return void g(o.t(null,void 0,s(582303)).format({key:(0,H.humanReadableModifiers)(H.Modifiers.Alt,!1)}),"hint.demonstrationCursorSelected")}if(a&&i&&(r=t,j.includes(r)))return void async function(t){{const i=()=>(0,O.resetToCursor)(!0);if(h)h.show(t,i);else{const{DrawingHintsRenderer:r}=await Promise.all([s.e(27174),s.e(45448),s.e(64623),s.e(32387),s.e(21766)]).then(s.bind(s,265637));h=new r(e),t===O.tool.value()&&h.show(t,i)}}}(t);var r;if("LineToolTextAbsolute"===t&&y("hint.anchoredTextWillBeRemoved"))return void g(o.t(null,void 0,s(576995)),"hint.anchoredTextWillBeRemoved");if(!y("hint.touchPainting"))return;const n=(0,W.isLineToolDrawWithoutPoints)(t);!(0,W.isStudyLineToolName)(t)||"LineToolRegressionTrend"===t||n||i?(0,W.isLineToolName)(t)&&!(0,W.isLineDrawnWithPressedButton)(t)&&!n&&i?g(o.t(null,void 0,s(730935)),"hint.touchPainting"):d&&d.hide():g(o.t(null,void 0,s(161528)),"hint.touchPainting")}function p(){const e=O.tool.value();"LineToolPath"===e&&y("hint.finishBuildPathByDblClick")?g(o.t(null,void 0,s(844259)),"hint.finishBuildPathByDblClick"):"LineToolPolyline"===e&&y("hint.finishBuildPolylineByDblClick")&&g(o.t(null,void 0,s(609023)),"hint.finishBuildPolylineByDblClick")}function _(){if(d){const e=O.tool.value();"LineToolPath"===e?f("hint.finishBuildPathByDblClick"):"LineToolPolyline"===e&&f("hint.finishBuildPolylineByDblClick")}}function m(){if(!y("hint.startResizingChartInLayout"))return;g(z.CheckMobile.any()?o.t(null,void 0,s(137149)):o.t(null,void 0,s(296471)),"hint.startResizingChartInLayout")}function g(e,t){if(d)d.show(e,f.bind(null,t));else{const i=O.tool.value();Promise.all([s.e(50865),s.e(72454),s.e(32387),s.e(77588)]).then(s.bind(s,614572)).then((s=>{d=new s.ChartEventHintRenderer(l),i===O.tool.value()&&d.show(e,f.bind(null,t))}))}}function y(e){return!Boolean(n.getBool(e))}function f(e){n.setValue(e,!0,{forceFlush:!0}),(0,i.ensureNotNull)(d).destroy(),null!==u&&u(),d=null}}var q=s(246445);function K(e,t){const r=o.t(null,void 0,s(2229)).format({emoji:"ðŸ‘"}),n=o.t(null,void 0,s(388770)).format({emoji:"ðŸ‘"}),a=o.t(null,void 0,s(834822)).format({emoji:"ðŸ‘"});q.on("onServerScreenshotCopiedToClipboard",(()=>d(r)),null),q.on("onClientScreenshotCopiedToClipboard",(()=>d(n)),null),
q.on("onServerScreenshotEmbedCodeCopiedToClipboard",(()=>d(a)),null);let l=null;const h=e.getContainer();function d(e){l?l.show(e):Promise.all([s.e(48072),s.e(63470),s.e(6878),s.e(32387),s.e(43180)]).then(s.bind(s,520518)).then((s=>{l||(l=new s.ChartScreenshotHintRenderer((0,i.ensureNotNull)(h),{bottomPadding:t.seriesControlBarEnabled}),l.show(e))}))}}var $=s(704461),G=s(835228);class Y{constructor(e=[]){this._list={id:"DEFAULT_SINGLE_WATCHLIST",type:"custom",name:o.t(null,void 0,s(397788)),description:null,symbols:[...e],shared:!1,persistedState:null}}getCustomWatchLists(){return Promise.resolve([this._list])}getSymbols(e){return Promise.resolve(this._list.symbols)}createWatchList(e){throw new Error("not implemented")}putWatchList(e){throw new Error("not implemented")}removeWatchList(e){throw new Error("not implemented")}renameWatchList(e,t){return Promise.resolve(null)}replaceSymbols(e,t){return this._list.symbols=[...t],Promise.resolve(this._list.symbols)}addSymbols(e,t){return this._list.symbols.push(...t),Promise.resolve(this._list.symbols)}removeSymbols(e,t){return this._list.symbols=this._list.symbols.filter((e=>!t.includes(e))),Promise.resolve(this._list.symbols)}setActive(e){return Promise.resolve(this._list)}getActive(){return Promise.resolve(this._list)}changeDescription(e,t){throw new Error("not implemented")}getCustomWatchlist(e){throw new Error("not implemented")}renameSeparator(e,t,s){return Promise.resolve(null)}}var J=s(584104),X=s(875500);const Q=new X.Delegate,Z=new X.Delegate,ee=new X.Delegate,te=new X.Delegate,se=new X.Delegate;class ie{constructor(e=[],t=n){if(this._lists={},this._activeListSettingsKey="widgetbar.widget.watchlist",(0,r.isFeaturesetEnabled)("trading_terminal")&&(this._activeListSettingsKey+="terminal"),this._settings=t,this._settings.onSync.subscribe(this,this._updateLists),this._updateLists(),0===Object.keys(this._lists).length){const t=this._createList({title:this._pickTitle(),symbols:[...e]},!0);this.setActive({id:t.id,type:"custom"})}}destroy(){this._settings.onSync.unsubscribeAll(this)}getCustomWatchLists(){this._updateLists();const e=[];return Object.keys(this._lists).forEach((t=>{const s=this._getList(t);s&&e.push(this._toSymbolList(s))})),Promise.resolve(e)}createWatchList(e){const t=this._createList({id:e.id,title:e.name||this._pickTitle(),symbols:e.symbols||[]});return ee.fire(t.id,[...t.symbols]),Promise.resolve(this._toSymbolList(t))}putWatchList(e){this._updateLists();const t=this._getList(e.id),s=t?.title,i=e.name;return this.saveList({id:e.id,symbols:e.symbols,title:e.name}),void 0!==s&&s!==i&&se.fire(e.id,s,i),null!==t?Q.fire(e.id):ee.fire(e.id,e.symbols),Promise.resolve(e)}removeWatchList(e){const{id:t}=e;return this._settings.remove(`savedwatch.${t}`,{forceFlush:!0}),delete this._lists[t],te.fire(t),Promise.resolve()}renameWatchList(e,t){this._updateLists();const{name:s}=e;return e.name=t,this.saveList({id:e.id,symbols:e.symbols,title:t}),se.fire(e.id,s,t),Promise.resolve(null)}replaceSymbols(e,t){const s=this._getList(e.id);return null===s||(s.symbols=[...t],
this.saveList(s),Q.fire(e.id)),Promise.resolve(null)}addSymbols(e,t){const s=this._getList(e.id);return null===s?Promise.resolve([]):(s.symbols.push(...t),this.saveList(s),Q.fire(e.id),Promise.resolve([...s.symbols]))}removeSymbols(e,t){const s=this._getList(e.id);return null===s?Promise.resolve([]):(s.symbols=s.symbols.filter((e=>!t.includes(e))),this.saveList(s),Q.fire(e.id),Promise.resolve([...s.symbols]))}setActive(e){return this._settings.setValue(this._activeListSettingsKey,e.id),Z.fire(),Promise.resolve(null)}getActive(){const e=this._getActive();return Promise.resolve(this._toSymbolList(e))}changeDescription(e,t){throw new Error("not implemented")}renameSeparator(e,t,s){this._updateLists();const i=this._getList(e);if(null===i)return Promise.resolve(null);const r=i.symbols.findIndex((e=>e===t));return i.symbols[r]=s,this.saveList(i),Q.fire(e),Promise.resolve(null)}saveList(e,t=!1){const s={symbols:e.symbols,title:String(e.title)};this._settings.setJSON(`savedwatch.${e.id}`,s,{forceFlush:!0,skipCrossWindowEvent:t}),this._lists[e.id]=s}getCustomWatchlist(e){throw new Error("not implemented")}_createList(e,t=!1){const s={id:e.id??(0,J.randomHash)(),symbols:e.symbols,title:e.title};return this.saveList(s,t),s}_getList(e){if(this._updateLists(),this._lists.hasOwnProperty(e)){const t=this._lists[e];return{id:e,symbols:t.symbols.slice(),title:t.title}}return null}_toSymbolList(e){return{type:"custom",id:e.id,name:e.title,description:null,symbols:e.symbols,shared:!1,persistedState:null}}_updateLists(){this._lists={};this._settings.keys().forEach((e=>{const t=/^savedwatch\.(.*)$/.exec(e);if(!t)return;const s=t[1],i=this._settings.getJSON(e,null);i&&(i.symbols||(i.symbols=[]),this._lists[s]=i)}))}_getActive(){const e=this._settings.getValue(this._activeListSettingsKey),[t,s]=Object.entries(this._lists)[0],i={id:t,...s};return void 0!==e&&this._getList(e)||i}_pickTitle(){this._updateLists();const e=Object.keys(this._lists).map((e=>this._lists[e].title));for(let t=1;;t++){const i=o.t(null,void 0,s(397788))+(t>1?` (${t})`:"");if(-1===e.indexOf(i))return i}}}var re=s(990221);class ne{constructor(e){this._document=e,this.isFullscreen=new w.WatchedValue;const t=()=>{const e=["fullscreenElement","webkitFullscreenElement","mozFullscreenElement","mozFullScreenElement","msFullscreenElement"];for(let t=0;t<e.length;t++){const s=e[t];if(s in this._document){this.isFullscreen.setValue(!!this._document[s]);break}}};t();for(const s of["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"])e.addEventListener(s,t,!1)}enter(){const e=this._document.documentElement;for(const t of["requestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","msRequestFullscreen"])if("function"==typeof e[t]){e[t]();break}this.isFullscreen.setValue(!0)}exit(){const e=this._document;for(const t of["exitFullscreen","mozCancelFullScreen","mozExitFullscreen","webkitExitFullscreen","msExitFullscreen"])if("function"==typeof e[t]){e[t]();break}this.isFullscreen.setValue(!1)}}class oe{constructor(e){
this.isFullscreen=new w.WatchedValue,this._handleExit=e=>{27!==(0,H.hashFromEvent)(e)||e.defaultPrevented||(e.preventDefault(),this.exit())},this._element=e}enter(){this.isFullscreen.setValue(!0),q.emit("onInternalFullscreenShow"),this._element.addEventListener("keydown",this._handleExit)}exit(){this.isFullscreen.setValue(!1),q.emit("onInternalFullscreenHide"),this._element.removeEventListener("keydown",this._handleExit)}}var ae=s(284133),le=s(702203);function he(e,t){let s=0;for(const{min:i,max:r}of t){if(e<i||r<i)continue;const t=Math.min(e,r);if(s=Math.max(s,t),e===s)break}return s}function de(e){const t=[];if(void 0===e)return[];Array.isArray(e)||(e=[e]);for(const s of e){let e,i;isFinite(s)?e=i=Number(s):(e=+s.min,i=+s.max),(e<0||isNaN(e))&&(e=0),isNaN(i)&&(i=1/0),e<=i&&i>0&&t.push({min:e,max:i})}return t.sort(((e,t)=>e.min-t.min||e.max-t.max)),t}function ue(e,t){if(e.length!==t.length)return!1;for(let s=e.length;s--;){if(e[s].min!==t[s].min)return!1;if(e[s].max!==t[s].max)return!1}return!0}var ce=s(708333);const pe=(0,r.isFeaturesetEnabled)("no_min_chart_width"),_e=(0,r.isFeaturesetEnabled)("bypass_chart_height_check");function me(e){const t=(0,r.isFeaturesetEnabled)("side_toolbar_in_fullscreen_mode"),s=(0,r.isFeaturesetEnabled)("header_in_fullscreen_mode");return"center"===e||"left"===e&&t||"top"===e&&s||"analysis"===e}const ge=[...k(null,3)];ge.splice(7,0,A.timeFrames["24m"]);var ye=s(784438),fe=s(841397),be=s(167481);const Se={whitelabel:!0,permissionOverrides:!0,linkCapturingAllowed:!0};var ve=s(732130),we=s(503888);var xe=s(154406),Pe=s(18107),Ce=s(913103),Te=s(336315);var Ve=s(145619),Ae=s(503699);s(599961);const De=window.initData,Ie=window.initData.widgetDefaults,Re=function(e,t=[],s){return function(e,t,s,i=[],r){const n=s.slice(1),o=decodeURIComponent(n);let a={};try{""!==o&&(a=JSON.parse(o),void 0!==r&&r(e,a),Object.keys(a).forEach((e=>{(Se[e]||i.includes(e))&&delete a[e]})))}catch(e){a={},console.warn("Hash params parsing error! Hash params ignored.")}const l=t.slice(1),h=t.includes("%")?decodeURIComponent(l):t,d=new URLSearchParams(h);let u={};try{d.forEach(((e,t)=>{i.includes(t)||(u[t]=e)})),void 0!==r&&r(e,u)}catch(e){u={},console.warn("Search query params parsing error! Search query params ignored.")}return Object.assign({},e,a,u)}(e,location.search,location.hash,t,s)}(Ie);try{!async function(e){Math.random()>.005||(await(0,we.getEmbedWidgetTracker)())?.trackWidgetLoadMetaInfo(e)}({widget_id:"advanced-chart",symbols:JSON.stringify([Re.symbol]),customer:Re.customer})}catch{}const Le=void 0!==Re.extended_hours?lt(Re.extended_hours)?"extended":"regular":void 0!==Ie.def_extended_hours?lt(Ie.def_extended_hours)?"extended":"regular":Ie.def_session_id;const ke=Ie.customer,Ee=Ie.customerReadableName,Fe=Re.range||Ie.def_range,Ne=lt(Re.withdateranges??Ie.def_withdateranges),Me=lt(Re.save_image??De.def_save_image,!0);let Be;(void 0===Re.allow_symbol_change?lt(Ie.def_hide_symbol_edit):!lt(Re.allow_symbol_change))&&((0,r.setEnabled)("header_symbol_search",!1),(0,
r.setEnabled)("disable_legend_inplace_symbol_change",!0),(0,r.setEnabled)("symbol_search_hot_key",!1)),(0,r.setEnabled)("header_screenshot",Boolean(Me)),"bovespa"===ke&&((0,r.disable)("header_settings"),Be=[{symbol:"IBOV",title:"Bovespa Index"},{symbol:"IBXX",title:"Brazil 100 Index"},{symbol:"IBXL",title:"Brazil 50 Index"},{symbol:"IBRA",title:"Brazil Broad-Based Index"},{symbol:"IGCX",title:"Special Corporate Governance Stock Index"},{symbol:"ITAG",title:"Special Tag-Along Stock Index"},{symbol:"IGNM",title:"Novo Mercado Corporate Governance Equity Index"}]),window.pro=new d.Pro(window.shopConf);let Oe=Re.symbol||Ie.def_symbol||window.DEFAULT_SYMBOL;"cme"===Re.symbology&&(Oe=(e=>{const t=new(_().SymbolToken)(e);if(!t.root())return e;const s=u.CMEToTVSymbologyAdapter.convertSymbolDataToTV(t.root(),t.exchange(),Re.venue??"");return"ok"!==s.status?e:(s.data.symbol&&t.root(s.data.symbol),s.data.exchange&&t.exchange(s.data.exchange),t.toString())})(Oe));const We=g()(parent),ze=[];let He,je=[];if(Re.watchlist&&(je=(Array.isArray(Re.watchlist)?Re.watchlist:Re.watchlist.split(/\x1f/)).map((e=>e.trim())).filter(Boolean)),je.length||Re.editablewatchlist){const e={type:"watchlist",properties:{list:je}};Re.editablewatchlist?(e.readonly=!1,e.data={hideTitleButton:!0},e.settingsKey="onwidget.watchlist",e.unAuthEditable=!0,function(e){const t=new ie(e);(0,G.registerService)($.SYMBOL_LIST_REPOSITORY_BACKEND_SERVICE,t)}(je)):function(e){const t=new Y(e);(0,G.registerService)($.SYMBOL_LIST_REPOSITORY_BACKEND_SERVICE,t)}(je),ze.push(e)}lt(Re.details)&&ze.push({type:"detail"}),void 0!==Re.widgetbar_width&&(He=+Re.widgetbar_width),(!He||!isFinite(He)||He<200)&&(He=200);const Ue=ze.length?[{name:"base",title:o.t(null,void 0,s(716066)),icon:Ve,widgets:ze.map((e=>e))}]:[];Re.hotlist&&Ue.push({name:"hotlist",title:o.t(null,void 0,s(821248)),icon:Ae,widgets:[{type:"hotlist",properties:{exchangeByLocale:{default:window.COUNTRY_CODE_TO_DEFAULT_EXCHANGE.en},groupByLocale:{default:"volume_gainers"}}},{type:"hotlist",properties:{exchangeByLocale:{default:window.COUNTRY_CODE_TO_DEFAULT_EXCHANGE.en},groupByLocale:{default:"percent_change_gainers"}}},{type:"hotlist",properties:{exchangeByLocale:{default:window.COUNTRY_CODE_TO_DEFAULT_EXCHANGE.en},groupByLocale:{default:"percent_change_loosers"}}}]});const qe=new class{constructor(e,t){this._updateDocumentHeight=e=>{"visual"===this._viewportType&&this._window.document.documentElement.style.setProperty("height",`${e}px`,"important")},this._window=e,this._fullscreenApi=t?new oe(e.document.body):new ne(e.document),this._viewportType=z.CheckMobile.iOS()&&!(0,le.isOnMobileAppPage)("any")&&this._window.visualViewport?"visual":"quirks","visual"===this._viewportType?this._viewport=(0,i.ensure)(this._window.visualViewport):this._viewport=this._window;const s=this._layoutSizeSensor=this._window.document.createElement("div");s.id="layout-size-sensor",s.style.position="fixed",s.style.top="0",s.style.left="0",s.style.right="0",s.style.bottom="0",s.style.pointerEvents="none",s.style.visibility="hidden",
this._initFullscreen()}allocate(){this.free();const e=this._window.document,t=e.createElement("div");t.classList.add("js-rootresizer__contents"),t.style.position="relative",t.style.width="100%",t.style.height="100%",e.body.insertAdjacentElement("afterbegin",t),e.body.insertAdjacentElement("afterbegin",this._layoutSizeSensor),this._visibilityApi=new ae.VisibilityApi(this._window.document);const s={alive:new w.WatchedValue(!0),fullscreenable:new w.WatchedValue(!0),container:new w.WatchedValue(t),width:new w.WatchedValue,height:new w.WatchedValue,availWidth:new w.WatchedValue,availHeight:new w.WatchedValue,visible:this._visibilityApi.isVisible,fullscreen:this._fullscreenApi.isFullscreen,remove:()=>{s.alive.setValue(!1)},attach:()=>{s.alive.setValue(!1),this._window.close()},requestFullscreen:()=>{this._requestFullscreen()},exitFullscreen:()=>{this._exitFullscreen()}};return s.alive.subscribe((e=>{e||s!==this._area||this.free()})),this._area=s,this._resizeHandler=()=>{const e=this._width(s)||800,t=this._height(s)||600;s.availHeight.setValue(t),s.availWidth.setValue(e),s.height.setValue(t),s.width.setValue(e)},this._area.height.subscribe(this._updateDocumentHeight,{callWithLast:!0}),this._resizeHandler(),this._viewport.addEventListener("resize",this._resizeHandler),new re.ResizerDetacherState(s).bridge()}free(){if(this._resizeHandler&&(this._viewport.removeEventListener("resize",this._resizeHandler),this._resizeHandler=void 0),this._visibilityApi&&(this._visibilityApi.destroy(),this._visibilityApi=void 0),this._area){const e=this._area;this._area=void 0,e.height.unsubscribe(this._updateDocumentHeight),e.alive.setValue(!1);const t=e.container.value(),s=t?.parentElement;s&&(s.removeChild(t),s.removeChild(this._layoutSizeSensor))}}_height(e){if("visual"===this._viewportType)return this._layoutSizeSensor.clientHeight;return e.container.value().clientHeight}_width(e){return e.container.value().clientWidth}_requestFullscreen(){this._fullscreenApi.enter()}_exitFullscreen(){this._fullscreenApi.exit()}_initFullscreen(){this._fullscreenApi.isFullscreen.subscribe((e=>{this._resizeHandler&&this._resizeHandler()}))}}(window),Ke=new class{constructor(e){this._processVisibility=e=>{const t=e.container.value();return this.affectsLayout(e.name)?(t&&t.classList.toggle("js-hidden",!1),!0):(t&&t.classList.toggle("js-hidden",!0),!1)},this._setWidth=(e,t,s)=>{let i=s;this._fullscreenArea!==e.name&&(e.availWidth.setValue(s),e.canNegotiate.width&&(i=he(s,e.negotiations.width))),t||(i=0);const r=e.container.value();return r&&t&&(r.style.width=i+"px"),e.width.setValue(i),i},this._setHeight=(e,t,s)=>{let i=s;this._fullscreenArea!==e.name&&(e.availHeight.setValue(s),e.canNegotiate.height&&(i=he(s,e.negotiations.height))),t||(i=0);const r=e.container.value();return r&&t&&(r.style.height=i+"px"),e.height.setValue(i),i};const t=e.container.value();if(!t)throw new Error("bridge.container.value() must be an element");this._container=t,this._availableAreas=["left","tradingpanel","right","top","bottom","center","topleft","extratop","analysis"],
this._areas={},this._bridge=e,this._width=e.width,this._height=e.height,this._width.subscribe((()=>this.recalculate())),this._height.subscribe((()=>this.recalculate())),this._bridge.visible.subscribe((()=>this._updateVisibility())),this._bridge.fullscreen.subscribe((()=>this._onParentFullscreenChange())),this.recalculate()}allocate(e){const t=e&&e.areaName;if(-1===this._availableAreas.indexOf(t))throw new Error("unknown options.areaName");this.free(t);const s=this._createDOM(t),i={name:t,canNegotiate:{width:"left"===t||"right"===t||"tradingpanel"===t||"topleft"===t,height:"top"===t||"bottom"===t||"topleft"===t||"extratop"===t},negotiations:{width:[],height:[]},remove:()=>{for(const e in this._areas)this._areas[e]===i&&this.free(e)},negotiateWidth:e=>{if(!i.canNegotiate.width)return;const t=de(e);ue(i.negotiations.width,t)||(i.negotiations.width=t,this.recalculate())},negotiateHeight:e=>{if(!i.canNegotiate.height)return;const t=de(e);ue(i.negotiations.height,t)||(i.negotiations.height=t,this.recalculate())},requestFullscreen:()=>{this._fullscreenArea||("right"!==t&&"center"!==t||(this._fullscreenArea=t),"center"===t&&this._bridge.requestFullscreen(),this._updateFullscreen())},exitFullscreen:()=>{t===this._fullscreenArea&&(this._fullscreenArea=void 0,"center"===t&&this._bridge.exitFullscreen(),this._updateFullscreen())},width:new w.WatchedValue,height:new w.WatchedValue,availWidth:new w.WatchedValue,availHeight:new w.WatchedValue,alive:new w.WatchedValue(!0),container:new w.WatchedValue(s),visible:new w.WatchedValue(!0),fullscreen:new w.WatchedValue(!1),fullscreenable:new w.WatchedValue("right"===t||"center"===t),rdState:new re.ResizerDetacherState};return i.rdState.pushOwner(i),this._areas[t]=i,i.rdState.owner.subscribe((e=>{const s=i.container.value();if(e!==i)s&&(s.innerHTML="",s.parentElement&&s.parentElement.removeChild(s));else{let e=null;for(let s=this._availableAreas.indexOf(t);s--;){const t=this._availableAreas[s];if(this.affectsLayout(t)){e=this._areas[t].container.value();break}}s&&(e&&s.parentElement?s.insertAdjacentElement("afterend",e):this._container.appendChild(s))}this.recalculate()}),{callWithLast:!0}),i.rdState.bridge()}free(e){const t=this._areas[e];if(!t)return;this._areas[e]=void 0;const s=t.container.value();s&&s.parentElement&&s.parentElement.removeChild(s),t.alive.setValue(!1)}recalculate(){const e={};this._recalcSingleRunToken=e;const t=this._areas.topleft,s=this._areas.left,i=this._areas.tradingpanel,r=this._areas.right,n=this._areas.top,o=this._areas.bottom,a=this._areas.center,l=this._areas.extratop,h=this._areas.analysis,d=this._width.value(),u=this._height.value();let c=0,p=0,_=0,m=0,g=0,y=0,f=0,b=0;if(e===this._recalcSingleRunToken&&l){const e=this._processVisibility(l);b=this._setHeight(l,e,u),this._setWidth(l,e,d)}if(e===this._recalcSingleRunToken&&t){const e=this._processVisibility(t);f=this._setHeight(t,e,u),y=this._setWidth(t,e,d);const s=t.container.value();e&&s&&(s.style.top=b+"px")}let S=0;if(e===this._recalcSingleRunToken&&n){
const e=this._processVisibility(n),t=n.container.value();e&&t&&(t.style.left=y+"px",t.style.top=b+"px");const s=d-y;this._setWidth(n,e,s),c=this._setHeight(n,e,u),c&&(S=1)}if(e===this._recalcSingleRunToken&&s){const e=this._processVisibility(s),t=Math.max(f,c);_=this._setWidth(s,e,d),_&&(_+=4),_&&1===S&&(S=4);const i=s.container.value();e&&i&&(i.style.top=t+b+S+"px"),this._setHeight(s,e,u-t-b-S)}if(e===this._recalcSingleRunToken&&i){const e=this._processVisibility(i);let t=d-_;pe||(t-=300),g=this._setWidth(i,e,t),g&&1===S&&(S=4),this._setHeight(i,e,u-b-c-S)}if(e===this._recalcSingleRunToken&&r){const e=this._processVisibility(r);let t=d-_-g;pe||(t-=300),m=this._setWidth(r,e,t),m&&1===S&&(S=4),this._setHeight(r,e,u-b-c-S);const s=r.container.value();e&&s&&(s.style.top=c+b+S+"px")}const v=g+m,w=v?4:0;let x=0,P=d-_-g-m-w;const C=Boolean(g||!v);if(!m&&g&&(P+=4),e===this._recalcSingleRunToken&&o){const e=this._processVisibility(o),t=o.container.value();e&&t&&(t.style.left=_+"px",t.classList.toggle("no-border-top-left-radius",!_),t.classList.toggle("no-border-top-right-radius",C)),this._setWidth(o,e,P);const s=u-b;x=Math.min(300,s-0),p=this._setHeight(o,e,s)+4}const T=Boolean(c&&(_||v));if(this._container.classList.toggle("layout-with-border-radius",T),ce.setNewBlackColor&&this._container.classList.toggle("black-border-bigger-radius",!0),e===this._recalcSingleRunToken&&a){const e=this._processVisibility(a),t=a.container.value();e&&t&&(t.style.left=_+"px",t.style.top=c+b+S+"px",t.classList.toggle("no-border-bottom-left-radius",!p||!_),t.classList.toggle("no-border-bottom-right-radius",C||!p),t.classList.toggle("no-border-top-left-radius",Boolean(!_&&v)),t.classList.toggle("no-border-top-right-radius",C)),this._setWidth(a,e,P);const s=u-c-p-b-S;this._setHeight(a,e,Math.max(s,x))}if(e===this._recalcSingleRunToken&&h){const e=this._processVisibility(h),t=h.container.value();e&&t&&(t.style.left="0px",t.style.top=c+b+S+"px",t.classList.toggle("no-border-bottom-left-radius",!0),t.classList.toggle("no-border-bottom-right-radius",C||!p),t.classList.toggle("no-border-top-left-radius",!0),t.classList.toggle("no-border-top-right-radius",!0));const s=d-m-w;this._setWidth(h,e,s);const i=u-c-b-S;this._setHeight(h,e,i)}if(e===this._recalcSingleRunToken&&i&&this.affectsLayout("tradingpanel")){const e=i.container.value();e&&(e.style.right=g&&m?`${m+4}px`:`${m}px`,e.style.top=b+c+S+"px",e.style.borderTopRightRadius=T&&m?"4px":"0px")}e===this._recalcSingleRunToken&&this._updateVisibility()}affectsLayout(e){const t=this._areas[e];if(!t)return!1;if(t.rdState.owner.value()!==t)return!1;if(this._fullscreenArea&&this._fullscreenArea!==e)return me(e);if(this._width.value()<=567||this._height.value()<=445&&!_e){if(!["center","top","left","topleft","extratop","analysis"].includes(e))return!1}return!0}_updateVisibility(){const e=this._bridge.visible.value();for(let t=0;t<this._availableAreas.length;t++){const s=this._availableAreas[t],i=this._areas[s];i&&(e&&this.affectsLayout(s)?i.visible.setValue(!0):i.visible.setValue(!1))}}
_onParentFullscreenChange(){this._bridge.fullscreen.value()||(this._fullscreenArea=void 0,this._updateFullscreen())}_updateFullscreen(){const e=void 0!==this._fullscreenArea;for(let t=0;t<this._availableAreas.length;t++){const s=this._availableAreas[t],i=this._areas[s];if(!i)continue;if(s===this._fullscreenArea){i.fullscreen.setValue(!0);continue}i.fullscreen.setValue(!1);const r=i.container.value();r&&r.classList.toggle("js-hidden",e&&!me(s))}this._updateVisibility(),this.recalculate()}_createDOM(e){const t=document.createElement("div");return t.classList.add("layout__area--"+e),t.style.position="absolute","tradingpanel"===e&&(t.style.borderTopRightRadius="4px"),"bottom"===e?t.style.bottom="0":t.style.top="0","right"===e||"tradingpanel"===e?t.style.right="0":t.style.left="0",t}}(qe.allocate()),$e=lt(Re.hide_top_toolbar)?null:Ke.allocate({areaName:"top"}),Ge=void 0===Re.hide_side_toolbar||+Re.hide_side_toolbar?null:Ke.allocate({areaName:"left"}),Ye=Ke.allocate({areaName:"center"}),Je=Ue.length?Ke.allocate({areaName:"right"}):null;if(xe.currentLayout.setValue(new class{constructor(e){this._analysisPanelVisibility=new Te.WatchedValue(!1),this._chartResizer=e,this._analysisArea=this._chartResizer.allocate({areaName:"analysis"}),this._canShowFloatingToolbars=(0,Pe.combine)((e=>null===e),Ce.actualContent.weakReference()),this._analysisPanelVisibility.subscribe((e=>{this._analysisArea.container.value().style.display=e?"grid":"none"}),{callWithLast:!0}),Ce.actualContent.subscribe((e=>{this._analysisPanelVisibility.setValue(null!==e)}),{callWithLast:!0})}analysisPanelVisible(){return this._analysisPanelVisibility}analysisRenderTarget(){return this._analysisArea.container.value()}canShowFloatingToolbars(){return this._canShowFloatingToolbars}}(Ke)),(0,be.setSupportPortalProblemsHost)(Re.support_host??""),Fe){const e=(Xe=Fe,ge.find((e=>e.value.value===Xe)));e&&(Re.range=Fe,Re.interval=e.targetResolution)}var Xe;let Qe,Ze;Qe=void 0===Re.interval?void 0===Re.style?Ie.def_interval??"1":(0,S.getDefaultResolution)((0,f.isRangeStyle)(parseInt(Re.style))):Re.interval,Ze=void 0===Re.style?void 0===Re.interval?Ie.def_style??1:(0,f.getDefaultStyle)(b.Interval.isRange(Re.interval)):parseInt(Re.style);const et=window.chartWidgetCollection=new l.ChartWidgetCollection({resizerBridge:Ye,padding:5,edge:Number(Re.padding)||0,publishedChartsEnabled:!1,saveChartEnabled:!1,widgetOptions:{onWidget:!0,useUserChartPreferences:!lt(Re.doNotStoreSettings,!1),addToWatchlistEnabled:!1,propertyPagesEnabled:!1,chartEventsEnabled:!1,newsNotificationsEnabled:!1,esdEnabled:(0,r.isFeaturesetEnabled)("esdonwidget"),sourceStatusesWidget:{errorSolution:!1},marketStatusWidgetEnabled:!0,chartWarningWidget:{subscriptionFullInfo:!1},widgetCustomer:ke,customerReadableName:Ee,hideIdeas:!0,controlBarEnabled:!0,addVolume:!lt(Re.hide_volume),muteSessionErrors:!(0,r.isFeaturesetEnabled)("referral_program_for_widget_owners"),defSymbol:Oe,defInterval:Qe,defStyle:Ze,defSessionId:Le,timezone:Re.timezone||Ie.def_timezone,defTimeframe:Fe,
isDrawingToolbarVisible:P.isDrawingToolbarVisible,watermarkEnabled:!0,paneContextMenuEnabled:!1,compareSymbols:Be,timeScaleWidget:{contextMenuEnabled:!1,timezoneMenuEnabled:!1},timeScale:{preserveBarSpacing:!0,lockVisibleTimeRangeOnResize:!1},legendWidgetEnabled:!lt(Re.hide_legend),legendWidget:{contextMenu:{settings:!1,fundamentals:!1,showOpenMarketStatus:!0}},goToDateEnabled:!1,handleScroll:{vertTouchDrag:lt(Re.verttouchdrag),horzTouchDrag:lt(Re.horztouchdrag,!0)},handleScale:{mouseWheel:"investopedia"!==ke&&"eurex"!==ke},currencyConversionEnabled:!0,unitConversionEnabled:!0},seriesControlBarEnabled:!!Ne,seriesControlBar:{timeFramesWidgetEnabled:!0,timeFramesWidget:{goToDateEnabled:!1,availableTimeFrames:k},timeWidgetEnabled:!0,timeWidget:{timezoneMenuEnabled:!1},adjustForDividendsButtonEnabled:!0,sessionIdButtonEnabled:Boolean(Le),backAdjustmentButtonEnabled:!1,settlementAsCloseButtonEnabled:!1,percentageScaleButtonEnabled:!1,logScaleButtonEnabled:!1,autoScaleButtonEnabled:!1,layoutFullscreenButtonEnabled:!0,mobileChangeLayoutEnabled:!1},mobileForceChartMaximizeEnabled:!1});let tt=!1;et.onAboutToBeDestroyed.subscribe(null,(()=>{tt=!0}),!0),Re.studies_overrides&&et.applyStudiesOverrides(JSON.parse(Re.studies_overrides)),Promise.all([s.e(89618),s.e(6610),s.e(55482),s.e(93299),s.e(49883)]).then(s.bind(s,715503)).then((e=>{e.addBrandingSource(et)}));const st=et.activeChartWidget.value();let it;if(window.chartWidget=st,et.readOnly()||(window.studyMarket=new x(et,{onWidget:!0})),c.linking.bindToChartWidgetCollection(et),E(M.Names.WidgetLoad,Re.frameElementId||null,void 0),Re.theme){const e=Re.theme.toLowerCase();if(C.themes[e]){(0,T.setTheme)(e);const t=C.getStdTheme(e);t&&t.content&&(it=t.content,Re.style&&(it.mainSourceProperties.style=parseInt(Re.style)),(0,a.applyDefaultsOverrides)(it,{mainSeriesProperties:"mainSourceProperties"},!0))}}let rt=!1,nt=!1;function ot(e){return(0,ye.isPineIdString)(e)?{type:"pine",pineId:e}:{type:"java",studyId:e}}function at(){document.querySelectorAll(".loading-indicator").forEach((e=>{e instanceof HTMLElement&&(e.style.display="none")}))}function lt(e,t=!1){return!1===e||!0===e?e:"1"===e||1===e||"true"===e||"0"!==e&&0!==e&&"false"!==e&&t}st.withModel(null,(function(){const e=st.model().mainSeries();st.applyOverrides({"mainSeriesProperties.showCountdown":!1}),it&&st.model().model().restoreTheme(it,!1),Re.backgroundColor&&st.applyOverrides({"paneProperties.background":Re.backgroundColor,"paneProperties.backgroundType":fe.ColorType.Solid}),Re.gridColor&&st.applyOverrides({"paneProperties.vertGridProperties.color":Re.gridColor,"paneProperties.horzGridProperties.color":Re.gridColor}),async function(e){if(!e)return;try{const t="string"==typeof e?JSON.parse(decodeURIComponent(e)):e;if(!Array.isArray(t)||0===t.length)return;const s=st.model().model().mainSeries();for(let e=0;e<t.length;e++){const i=t[e];if(i.symbol&&i.position&&ve.CompareOption[i.position])switch(i.position){case"SameScale":st.addCompareAsOverlay(i.symbol,!1,s.isYield());break;case"NewPriceScale":
st.addOverlayStudy(i.symbol,!0);break;case"NewPane":st.addOverlayStudy(i.symbol,!1)}}}catch(e){return}}(Re.compareSymbols),e.dataEvents().symbolResolved().subscribe(e,(()=>{!function(e,t){if(!t)return;const s=e.model().model(),i=ke?20:5;try{const e=JSON.parse("string"==typeof t?t:JSON.stringify(t));e.slice(0,i).forEach((e=>{const t=s.createStudyInserter(ot(e.id));t.setForceOverlay(e.overlay),t.insert((()=>Promise.resolve({inputs:e.inputs,parentSources:[]})))}))}catch(e){((Array.isArray(t)?t:t.split(/\x1f/))||[]).slice(0,i).forEach((e=>{s.createStudyInserter(ot(e)).insert()}))}}(window.chartWidget,Re.studies)}),!0),e.dataEvents().completed().subscribe(this,(()=>{it&&at(),U&&!rt&&(U(et,!0),rt=!0),K&&!nt&&(K(et,{seriesControlBarEnabled:!!Ne}),nt=!0)})),e.dataEvents().symbolError().subscribe(null,(()=>{E(M.Names.NoData,Re.frameElementId||null,void 0)}))})),Ge&&(async()=>{
const[e,t,{DrawingToolbar:i},{LineToolPropertiesWidget:r}]=await Promise.all([Promise.all([s.e(97781),s.e(57032),s.e(1967),s.e(46970),s.e(50865),s.e(63665),s.e(24977),s.e(5709),s.e(74528),s.e(45448),s.e(22066),s.e(18257),s.e(60627),s.e(75649),s.e(63935),s.e(26729),s.e(31403),s.e(93807),s.e(25947),s.e(2527),s.e(497),s.e(49515),s.e(66985),s.e(44591),s.e(24193),s.e(15215),s.e(24025),s.e(57435),s.e(51493),s.e(25361),s.e(30468),s.e(91987),s.e(28209),s.e(61274),s.e(95907),s.e(6819),s.e(27450),s.e(54396),s.e(57425),s.e(54145),s.e(87103),s.e(32387),s.e(80915),s.e(53121),s.e(92251),s.e(49486),s.e(44013),s.e(96976),s.e(9453),s.e(42934)]).then(s.t.bind(s,779474,19)),Promise.all([s.e(97781),s.e(57032),s.e(1967),s.e(46970),s.e(50865),s.e(63665),s.e(24977),s.e(5709),s.e(74528),s.e(45448),s.e(22066),s.e(18257),s.e(60627),s.e(75649),s.e(63935),s.e(26729),s.e(31403),s.e(93807),s.e(25947),s.e(2527),s.e(497),s.e(49515),s.e(66985),s.e(44591),s.e(24193),s.e(15215),s.e(24025),s.e(57435),s.e(51493),s.e(25361),s.e(30468),s.e(91987),s.e(28209),s.e(61274),s.e(95907),s.e(6819),s.e(27450),s.e(54396),s.e(57425),s.e(54145),s.e(87103),s.e(32387),s.e(80915),s.e(53121),s.e(92251),s.e(49486),s.e(44013),s.e(96976),s.e(9453),s.e(42934)]).then(s.t.bind(s,129365,19)),Promise.all([s.e(97781),s.e(57032),s.e(1967),s.e(46970),s.e(50865),s.e(63665),s.e(24977),s.e(5709),s.e(74528),s.e(45448),s.e(22066),s.e(18257),s.e(60627),s.e(75649),s.e(63935),s.e(26729),s.e(31403),s.e(93807),s.e(25947),s.e(2527),s.e(497),s.e(49515),s.e(66985),s.e(44591),s.e(24193),s.e(15215),s.e(24025),s.e(57435),s.e(51493),s.e(25361),s.e(30468),s.e(91987),s.e(28209),s.e(61274),s.e(95907),s.e(6819),s.e(27450),s.e(54396),s.e(57425),s.e(54145),s.e(87103),s.e(32387),s.e(80915),s.e(53121),s.e(92251),s.e(49486),s.e(44013),s.e(96976),s.e(9453),s.e(42934)]).then(s.bind(s,588792)),Promise.all([s.e(97781),s.e(57032),s.e(1967),s.e(46970),s.e(50865),s.e(63665),s.e(24977),s.e(5709),s.e(74528),s.e(45448),s.e(22066),s.e(18257),s.e(60627),s.e(75649),s.e(63935),s.e(26729),s.e(31403),s.e(93807),s.e(25947),s.e(2527),s.e(497),s.e(49515),s.e(66985),s.e(44591),s.e(24193),s.e(15215),s.e(24025),s.e(57435),s.e(51493),s.e(25361),s.e(30468),s.e(91987),s.e(28209),s.e(61274),s.e(95907),s.e(6819),s.e(27450),s.e(54396),s.e(57425),s.e(54145),s.e(87103),s.e(32387),s.e(80915),s.e(53121),s.e(92251),s.e(49486),s.e(44013),s.e(96976),s.e(9453),s.e(42934)]).then(s.bind(s,344576))]);tt||(t.render(e.createElement(i,{chartWidgetCollection:et,resizerBridge:Ge,screenshotButton:"cme"===ke}),Ge.container.value()),window.lineToolPropertiesToolbar=new r(et))})(),$e&&(async()=>{const[e,t,i,{HeaderToolbar:r}]=await Promise.all([B(ke),Promise.all([s.e(16193),s.e(54145),s.e(90867),s.e(32387),s.e(43926)]).then(s.t.bind(s,779474,19)),Promise.all([s.e(16193),s.e(54145),s.e(90867),s.e(32387),s.e(43926)]).then(s.t.bind(s,129365,19)),Promise.all([s.e(16193),s.e(54145),s.e(90867),s.e(32387),s.e(43926)]).then(s.bind(s,83500))]),n=await e.getToolSet(),o=V.mobiletouch?["full"]:void 0;i.render(t.createElement(r,{tools:n,
chartApiInstance:window.ChartApiInstance,availableTimeFrames:k,chartWidgetCollection:et,ideas:!1,resizerBridge:$e,popupButton:lt(Re.show_popup_button),studyMarket:window.studyMarket,windowMessageService:We,isFundamental:!1,allowedModes:o}),$e.container.value())})(),Je&&(async()=>{const[{WidgetBar:e},{configuration:t}]=await Promise.all([Promise.all([s.e(99955),s.e(50865),s.e(48072),s.e(5709),s.e(96872),s.e(44591),s.e(15215),s.e(51493),s.e(54396),s.e(66917),s.e(32387),s.e(36295),s.e(12170),s.e(9453),s.e(56382)]).then(s.bind(s,406881)),Promise.all([s.e(99955),s.e(50865),s.e(48072),s.e(5709),s.e(96872),s.e(44591),s.e(15215),s.e(51493),s.e(54396),s.e(66917),s.e(32387),s.e(36295),s.e(12170),s.e(9453),s.e(56382)]).then(s.bind(s,497354))]);Ue.forEach((e=>{e.widgets=e.widgets?.filter((e=>!(void 0!==e.isEnabled&&!e.isEnabled)))}));window.widgetbar=new e({resizerBridge:Je,affectsLayout:()=>Ke.affectsLayout("right"),readonly:!0,state:{width:He,pages:Ue},showCloseButton:!0,configuration:()=>t({chartApiInstance:window.ChartApiInstance})})})(),st.onDisconnected().subscribe(null,(e=>{var t;at(),e&&(t=()=>{window.ChartApiInstance.disconnect(),setTimeout((()=>{window.ChartApiInstance.connect(),st.reconnect()}),500)},v().then((e=>e.showCriticalErrorMessage(t))))})),st.onReconnectBailout().subscribe(null,(()=>{var e;e=()=>{setTimeout((()=>{window.ChartApiInstance.connect()}),0)},v().then((t=>t.showDisconnectedMessage(e)))})),document.querySelectorAll(".tv-content").forEach((e=>{e.addEventListener("contextmenu",(e=>{e.target instanceof Element&&e.target.matches("input, textarea")||e.preventDefault()}))})),Re.whotrades&&(0,r.setEnabled)("whotrades_auth_only",!0),document.querySelectorAll(".loading-indicator").forEach((e=>{e.remove()})),(()=>{let e;const t=t=>{void 0!==e&&(0,y.getQuoteSessionInstance)("simple").unsubscribe("widgetQuoteListener",e),e=t,(0,y.getQuoteSessionInstance)("simple").subscribe("widgetQuoteListener",t,(e=>{const t=e.values,s=["change","change_percent","last_price","original_name","short_name","exchange","description","volume"],i={};for(let e=0;e<s.length;e++){const r=s[e];if(!t.hasOwnProperty(r))return;i[r]=t[r]}i.volume=1e100===t.volume?void 0:t.volume,We.post(parent,"quoteUpdate",i)}))};st.withModel(null,(()=>{const e=st.model().mainSeries();e.properties().childs().symbol.subscribe(e,(e=>{t(e.value()),"telegram"===ke&&We.post(parent,"symbolChanged",e.value())}))})),We.on("quoteSubscribe",(()=>{const e=st.model().mainSeries().properties().childs().symbol.value();t(e)})),We.on("imageURL",((e,t)=>{(0,h.takeChartSnapshot)(et,(e=>{t(e)}),(()=>{t("")}),{wl:lt(Ie.logo?.whitelabel),cme:Ie.cme_widget})})),We.on("symbolInfo",((e,t)=>{const s=(0,i.ensureNotNull)(st.model().mainSeries().symbolInfo()),r=st.model().mainSeries().properties().childs().interval.value();t({name:s.name,exchange:s.exchange,description:s.description,type:s.type,interval:r})})),We.on("widgetReady",((e,t)=>{st.withModel(null,(()=>{let e;st.model().mainSeries().symbolInfo()?t():(e=()=>{t(),
st.model().mainSeries().dataEvents().symbolResolved().unsubscribe(null,e)},st.model().mainSeries().dataEvents().symbolResolved().subscribe(null,e))}))})),F(N.Names.SetSymbol,(e=>{e&&e.symbol&&et.setSymbol(e.symbol)})),F(N.Names.SetInterval,(e=>{e&&e.interval&&et.setResolution(e.interval)}))})(),window.applyStudiesOverrides=e=>{e&&window.chartWidgetCollection.applyStudiesOverrides(e)}},196768:(e,t,s)=>{"use strict";s.r(t),s.d(t,{detectAutoDirection:()=>S,forceLTRStr:()=>c,forceLTRStrSsr:()=>p,forceRTLStr:()=>m,getLTRScrollLeft:()=>g,getLTRScrollLeftOffset:()=>y,isRtl:()=>r,startWithLTR:()=>u,stripLTRMarks:()=>d,stripLTRStrSsr:()=>_});var i=s(320403);const r=()=>"rtl"===window.document.dir,n="â€Ž",o="â€ª",a="â€«",l="â€¬",h=new RegExp(n+"|"+o+"|"+a+"|"+l,"g");function d(e){return""!==e&&r()&&null!=e?e.replace(h,""):e}function u(e){return""!==e&&r()&&null!=e?n+e:e}function c(e){return""!==e&&r()&&null!=e?o+e+l:e}function p(e){return o+e+l}function _(e){return e.startsWith(o)&&e.endsWith(l)?e.slice(1,-1):e}function m(e){return""!==e&&r()&&null!=e?a+e+l:e}function g(e){return(0,i.getNormalizedScrollLeft)(e,"rtl")}function y(e,t){const s=(0,i.detectScrollType)();if("indeterminate"===s)return 0;switch(s){case"negative":t=e.clientWidth-e.scrollWidth+t;break;case"reverse":t=e.scrollWidth-e.clientWidth-t}return t}const f=/[^\u0000-\u0040\u005B-\u0060\u007B-\u00BF\u00D7\u00F7\u02B9-\u02FF\u2000-\u200E\u2010-\u2029\u202C\u202F-\u2BFF]/,b=/[\u0590-\u07FF\u200F\u202B\u202E\uFB1D-\uFDFD\uFE70-\uFEFC]/;function S(e){const t=f.exec(e);return t?b.test(t[0])?"rtl":"ltr":""}},822707:(e,t,s)=>{"use strict";s.d(t,{openPaywall:()=>o});var i=s(266150),r=s(285800),n=s(961531);s(574908);async function o(e,t={}){if(r.paywallMobileInterceptor.isHiddenFeature(e.feature))return void r.paywallMobileInterceptor.invoke(e.feature);if((0,i.isFeaturesetEnabled)("referral_program_for_widget_owners"))return(0,n.showGoToTradingViewReferralDialog)({feature:e.feature});const{paywalls:o}=await Promise.all([s.e(97647),s.e(46970),s.e(48072),s.e(45448),s.e(86834),s.e(36810),s.e(6784),s.e(72644),s.e(52694),s.e(54478),s.e(83066),s.e(95483),s.e(32387),s.e(41818),s.e(52312),s.e(93489),s.e(86001)]).then(s.bind(s,869848));o.open(e,t)}},915503:(e,t,s)=>{"use strict";s.d(t,{AggregateError:()=>y,ApiError:()=>g,accumulateErrors:()=>n,checkPhoneCode:()=>h,continuePartialAuth:()=>x,fetchPost:()=>o,firstLoginData:()=>a,firstLoginDataUrl:()=>r,recoverPassword:()=>b,recoverPasswordUrl:()=>f,recoveryPassword:()=>d,resendLink:()=>l,signin:()=>p,signinUrl:()=>u,signup:()=>m,signupUrl:()=>_,socialAuth:()=>w});var i=s(131890);const r="/accounts/first_login_data/";function n(e,t){return Object.entries(e).map((e=>new g(e[1].join("\n"),t,e[0])))}function o(e,t){return(0,i.fetch)(e,{method:"POST",credentials:"include",mode:"same-origin",body:t})}function a(e){return o(r,e).then((e=>e.ok?e.json():e.json().then((t=>{throw new y(n(t.errors,e.status))}))))}function l(){return o("/api/v1/users/anon/change-email/resend/").then((e=>e.ok?e.json():e.json().then((e=>{throw Error(e.error)}))))}
function h(e){return o("/api/v1/recover_password/check_phone_code/",e).then((e=>e.ok?e.json():e.json().then((e=>{throw Error(e.error)}))))}function d(e){return o("/api/v1/recover_password/",e).then((e=>e))}const u="/accounts/signin/";function c(e){return e.json().then((t=>{if("errors"in t&&Object.keys(t.errors).length)throw new y(n(t.errors,e.status));if("error"in t&&""!==t.error||"code"in t||!e.ok)throw new g(t.error||t.detail,e.status,t.code,t.confirm_auth_data,t.two_factor_types,function(e){if(e.signature)return{signature:e.signature,email:e.email||"",phone:e.phone||"",socials:[]};return}(t));return t}))}function p(e){return o(u,e).then(c)}const _="/accounts/signup/";function m(e){return o(_,e).then((e=>e.json().then((t=>{if("errors"in t&&""!==t.errors)throw new y(n(t.errors,e.status))}))))}class g extends Error{constructor(e,t,s,i,r,n){super(e),this.type=s,this.status=t,this.secondFactorTypes=r,this.socialConfirmData=i,this.resetPasswordData=n}}class y extends Error{constructor(e){super(e.map((e=>e.message)).join("\n")),this.errors=[],this.errors=e}}const f="/api/v1/recover_password/search/";function b(e){return o(f,e).then(c)}const S="/accounts/complete/android-jwt/",v={Accept:"application/json"};function w(e,t){const s=new URL(window.origin+S);return Object.entries(t).forEach((([e,t])=>t&&s.searchParams.append(e,t))),(0,i.fetch)(s.href,{method:"POST",body:e,headers:v}).then(c)}function x(e,t){const s=new URL(window.origin+`/accounts/complete/${e}/`),r=new FormData;return r.append("partial_token",t),(0,i.fetch)(s.href,{method:"POST",body:r,headers:v}).then(c)}},434612:(e,t,s)=>{"use strict";s.r(t),s.d(t,{QuoteTicker:()=>w});var i=s(359308),r=s(77357),n=s(385955),o=s(594461),a=s(651984),l=s(605434),h=s(760823),d=s(860904),u=s(235292),c=s(640156),p=s(606703),_=s(660101),m=s(615442),g=s(823268),y=s(522943),f=s(962672);const b=(0,r.getLogger)("QuoteTicker"),S={addDescriptionTitle:!0,changeDirectionDownClass:"down",changeDirectionUpClass:"up",changeDirectionNeutralClass:"neutral",changeInBrackets:!1,changePercentInBrackets:!1,lastPriceTimeInBrackets:!0,lastReleaseDateTimeInBrackets:!0,rtcTimeInBrackets:!0,clientName:"quote-ticker",dontDyePrice:!1,fallingBg:null,growingBg:null,lastFallingClass:"falling",lastGrowingClass:"growing",quoteSession:null,signNegative:!0,signPositive:!1,customPriceFormatter:null,customTimeFormatter:null,sessionStatusClassSuffix:"--for-ticker",dataModeClassSuffix:"--for-ticker",showInvalidSymbolStatus:!1,indicatorsTooltipType:"custom",lastPriceLastCharSup:!1,lastPriceHighlightDiffOnly:!1,initedHook:void 0,setStateHook:void 0,permissionDeniedHook:void 0,noSuchSymbolHook:void 0},v=/[KMBT]/;function w(e,t,s={}){this.enabled=!0,this._symbol=e,this._symbolOriginal=null,this._options=(0,i.deepExtend)({},S,s),!1!==this._options.signNegative&&!0!==this._options.signNegative&&delete this._options.signNegative,s.customPriceFormatter&&(this._customPriceFormatter=s.customPriceFormatter),
s.customTimeFormatter&&(void 0!==s.customTimeFormatter.lastPrice||void 0!==s.customTimeFormatter.rtc?this._timeFormatter=s.customTimeFormatter:this._timeFormatter={lastPrice:s.customPriceFormatter,rtc:s.customPriceFormatter}),this._percentFormatter=new o.PercentageFormatter,this._defaultPriceFormatter=new l.PriceFormatter({priceScale:100}),this._priceFormatter=this._customPriceFormatter||this._defaultPriceFormatter,this._volumeFormatter=new h.VolumeFormatter({precision:2}),this._cache={},this._lastPrice=null,this._lastPriceFormatted="",this._lastMinMove=0,this._elements={},this._textNodes={},this._changeVolumeLetter=this._getChangeVolumeLetterCallback(),this._setElements(t),this._highlighters={},this._initHighlighters(),this._options.setStateHook&&this.setStateHook(this._options.setStateHook),this.quoteSession=this._options.quoteSession||(0,_.getQuoteSessionInstance)("simple"),this._quoteSessionEventHandler=this.onData.bind(this),this._connectTimeoutId=setTimeout(this.connect.bind(this),0)}function x(e){const t=e.search(v),s=t>=0?e.slice(t):"";return[t>0?e.substring(t,0):0===t?"":e,s]}function P(e,t,s,i,r){var n,o=null;function a(){if(n&&(clearTimeout(n),n=void 0),s||t)for(var o=0;o<e.length;o++)e[o].style.background="";if(!s||!t)for(o=0;o<e.length;o++)i&&e[o].classList.remove(i),r&&e[o].classList.remove(r)}return{show:function(l){var h=0;if(l!==o){if(null!==o&&null!==l&&(h=l-o),a(),n=setTimeout(a,750),0<h){if(t)for(var d=0;d<e.length;d++)e[d].style.background=t;else if(i)for(d=0;d<e.length;d++)e[d].classList.add(i)}else if(h<0)if(s)for(d=0;d<e.length;d++)e[d].style.background=s;else if(r)for(d=0;d<e.length;d++)e[d].classList.add(r);null!==l&&(o=l)}},hide:a}}w.prototype._setElements=function(e){this._container=e,this._elements.change=this._findElements(e,["js-symbol-change","symbol-change"]),this._elements.changeDirection=this._findElements(e,["js-symbol-change-direction","symbol-change-direction"]),this._elements.extHrsChangeDirection=this._findElements(e,["js-symbol-ext-hrs-change-direction"]),this._elements.changePercent=this._findElements(e,["js-symbol-change-pt","symbol-change-pt"]),this._elements.description=this._findElements(e,["js-symbol-description-name","symbol-description-name"]),this._elements.extHrsChange=this._findElements(e,"js-symbol-ext-hrs-change"),this._elements.extHrsChangePercent=this._findElements(e,"js-symbol-ext-hrs-change-pt"),this._elements.extHrsClose=this._findElements(e,"js-symbol-ext-hrs-close"),this._elements.industry=this._findElements(e,["js-symbol-industry","symbol-industry"]),this._elements.last=this._findElements(e,["js-symbol-last","symbol-last"]),this._elements.sector=this._findElements(e,["js-symbol-sector","symbol-sector"]),this._elements.sessionStatus=this._findElements(e,"js-symbol-session-status"),this._elements.shortName=this._findElements(e,["js-symbol-short-name","symbol-short-name"]),this._elements.updateMode=this._findElements(e,"js-data-mode"),this._elements.lastPeriod=this._findElements(e,"js-symbol-last-period"),
this._elements.updateMode.forEach((e=>e.classList.add("i-hidden"))),this._textNodes.change=this._getOrCreateTextNodes(this._elements.change),this._textNodes.changePercent=this._getOrCreateTextNodes(this._elements.changePercent),this._textNodes.extHrsChange=this._getOrCreateTextNodes(this._elements.extHrsChange),this._textNodes.extHrsChangePercent=this._getOrCreateTextNodes(this._elements.extHrsChangePercent),this._textNodes.extHrsClose=this._getOrCreateTextNodes(this._elements.extHrsClose),this._textNodes.last=this._getOrCreateTextNodes(this._elements.last),this._textNodes.open=this._findTextNodes(e,"js-symbol-open"),this._textNodes.eps=this._findTextNodes(e,"js-symbol-eps"),this._textNodes.marketCap=this._findTextNodes(e,"js-symbol-market-cap"),this._textNodes.prevClose=this._findTextNodes(e,"js-symbol-prev-close"),this._textNodes.dividends=this._findTextNodes(e,"js-symbol-dividends"),this._textNodes.priceEarnings=this._findTextNodes(e,"js-symbol-pe"),this._textNodes.volume=this._findTextNodes(e,"js-symbol-volume"),this._textNodes.high=this._findTextNodes(e,"js-symbol-high"),this._textNodes.low=this._findTextNodes(e,"js-symbol-low"),this._textNodes.currency=this._findTextNodes(e,"js-symbol-currency"),this._textNodes.lastPriceTime=this._findTextNodes(e,"js-symbol-lp-time"),this._textNodes.lastReleaseDate=this._findTextNodes(e,"js-symbol-last-release-date"),this._textNodes.rtcTime=this._findTextNodes(e,"js-symbol-rtc-time"),this._elements.lastHighlight=this._options.lastPriceHighlightDiffOnly?this._elements.last.map((e=>this._appendAndGetNewElement(e,"span"))):this._elements.last,this._textNodes.lastHighlight=this._getOrCreateTextNodes(this._elements.lastHighlight),this._elements.lastSup=this._options.lastPriceLastCharSup?this._elements.lastHighlight.map((e=>this._appendAndGetNewElement(e,"sup"))):[],this._textNodes.lastSup=this._getOrCreateTextNodes(this._elements.lastSup)},w.prototype._findElements=function(e,t){var s=(0,n.isArray)(t)?t:[t];return Array.prototype.concat.apply([],s.map((t=>Array.prototype.slice.call(e.getElementsByClassName(t)))))},w.prototype._findTextNodes=function(e,t){return this._getOrCreateTextNodes(this._findElements(e,t))},w.prototype._getOrCreateTextNodes=function(e){return e.map((e=>{var t=this._getFirstTextNode(e);return t||(t=e.ownerDocument.createTextNode(""),e.appendChild(t)),t}))},w.prototype._appendAndGetNewElement=function(e,t){const s=document.createElement(t);return e.appendChild(s),s},w.prototype._getFirstTextNode=function(e){for(var t=e.childNodes,s=t.length-1;s>=0;s--)if(3===t.item(s).nodeType)return t.item(s);return null},w.prototype.connect=function(e){this._subscribed||(this._subscribedSymbol=e||this._symbol,this.quoteSession.subscribe(this._options.clientName,this._subscribedSymbol,this._quoteSessionEventHandler),this._subscribed=!0)},w.prototype.disconnect=function(){clearTimeout(this._connectTimeoutId),this._subscribed&&(this.quoteSession.unsubscribe(this._options.clientName,this._subscribedSymbol,this._quoteSessionEventHandler),this._subscribed=!1)},
w.prototype.onData=function(e,t){this.enabled&&("ok"===e.status?this.successData(e,t):"permission_denied"===e.status?this.onPermissionDenied(e):"error"===e.status&&this.errorData(e))},w.prototype.successData=function(e,t){e.values&&this.setState(e.values,e,t)},w.prototype.onPermissionDenied=function(e){(0,f.isSfQuoteData)(e)||(0,y.isMcxQuoteData)(e)?this._options.permissionDeniedHook?this._options.permissionDeniedHook(e,this._symbolOriginal||this._symbol):this.errorData(e):this.downgradeData(e)},w.prototype.errorData=function(e){this._options.showInvalidSymbolStatus&&(this.setShortName(this._symbol),this._elements.sessionStatus.map((e=>new d.MarketStatusIndicator({classSuffix:this._options.sessionStatusClassSuffix,el:e,data:{values:{current_session:"invalid"}},tooltipType:this._options.indicatorsTooltipType})))),this._options.noSuchSymbolHook?(this._symbolOriginal&&this.setShortName(this._symbolOriginal),this._options.noSuchSymbolHook.call(this,e,this._symbolOriginal||this._symbol)):b.logWarn("No data for: "+this._symbol)},w.prototype.downgradeData=function(e){{const t=e&&e.values&&e.values.alternative,s=this._symbol===t;if(!(t&&-1!==t.indexOf(":"))||s)return void this.errorData(e);this._symbolOriginal=this._symbol,this._symbol=t,this._subscribed=!1,this.connect()}},w.prototype.setState=function(e,t,i){const r=i.values;this._isVolumeFormat="volume"===e.format,null==r.pricescale&&null==r.minmov&&null==r.fractional&&null==r.minmove2||(this._priceFormatter=this._customPriceFormatter||this._isVolumeFormat&&this._volumeFormatter||new l.PriceFormatter({priceScale:e.pricescale||100,minMove:e.minmov||1,fractional:e.fractional,minMove2:e.minmove2}));const n=this._options,o=this._percentFormatter,a=this._priceFormatter,_=this._defaultPriceFormatter,y=this._volumeFormatter,f=(e,t=!0)=>t?`(${e})`:e,S=void 0!==n.signPositiveChange?n.signPositiveChange:n.signPositive,v=e=>(0,m.quoteTickerFormatChange)(e,r,n),w=e=>{const t=o.format(e,{signPositive:S,signNegative:n.signNegative});return f(t,n.changePercentInBrackets)},x=a.format.bind(a),P=_.format.bind(_),C=y.format.bind(y),T=e=>null==e?h.PLACE_HOLDER:P(e);n.disableChange||(this._setNodesValue(this._textNodes.change,r.change,v),this._setNodesValue(this._textNodes.changePercent,r.change_percent,w),null!=r.change&&(n.dontDyePrice||this._setChangeFontColor([].concat(this._elements.change,this._elements.changePercent),r.change,n.changeUpFontColor,n.changeDownFontColor,n.changeNeutralFontColor),this._setChangeDirection(this._elements.changeDirection,r.change)),this._setNodesValue(this._textNodes.extHrsChange,r.rch,v),this._setNodesValue(this._textNodes.extHrsChangePercent,r.rchp,w),null!=r.rch&&(n.dontDyePrice||this._setChangeFontColor([].concat(this._elements.extHrsChange,this._elements.extHrsChangePercent),r.rch,n.changeUpFontColor,n.changeDownFontColor,n.changeNeutralFontColor),this._setChangeDirection(this._elements.extHrsChangeDirection,r.rch))),this._setNodesValue(this._textNodes.prevClose,r.prev_close_price,x),
this._setNodesValue(this._textNodes.dividends,e.dividends_yield,(e=>null==e?h.PLACE_HOLDER:o.format(e,{signPositive:n.signPositive,signNegative:n.signNegative})),!0);let V=(0,c.getTranslatedSymbolDescription)(r);if(V&&(V=this._prepareSymbolDescription(V),this._setTextsContent(this._elements.description,V),this._options.addDescriptionTitle))for(var A=0;A<this._elements.description.length;A++)this._elements.description[A].setAttribute("title",V);if((null!=r.short_name||null!=r.exchange)&&e.short_name){var D=e.short_name;"QUANDL"===e.exchange&&void 0!==e.short_name.split("/")[1]&&(D=e.short_name.split("/")[1]+", "+e.short_name.split("/")[0]),this.setShortName(D)}e["reference-last-period"]&&this._elements.lastPeriod.length&&Promise.all([s.e(23567),s.e(73688)]).then(s.bind(s,167428)).then((t=>{this._setTextsContent(this._elements.lastPeriod,t.periodFormatter(e["reference-last-period"]))})),this._elements.lastPeriod.length&&void 0===e["reference-last-period"]&&this._setTextsContent(this._elements.lastPeriod,"â€”"),this._setLastValue(r.last_price,r.minmove2,x),this._setNodesValue(this._textNodes.extHrsClose,r.rtc,x),r.rtc&&this._highlighters.extHrsClose.show(r.rtc),r.industry&&this._setTextsContent(this._elements.industry,e.industry,(e=>e)),r.sector&&this._setTextsContent(this._elements.sector,e.sector),this._elements.sessionStatus&&r.current_session&&(this._sessionStatusInstances?this._sessionStatusInstances.forEach((e=>e.setStatus(r.current_session))):this._sessionStatusInstances=this._elements.sessionStatus.map((t=>new d.MarketStatusIndicator({classSuffix:this._options.sessionStatusClassSuffix,el:t,short:!0,data:{values:r},quoteSession:this.quoteSession,symbol:e.original_name,manualUpdate:!0,tooltipType:this._options.indicatorsTooltipType,sessionStatusIcon:this._options.sessionStatusIcon})))),this._setNodesValue(this._textNodes.open,r.open_price,x),this._setNodesValue(this._textNodes.high,r.high_price,x),this._setNodesValue(this._textNodes.low,r.low_price,x),this._setNodesValue(this._textNodes.eps,e.earnings_per_share_basic_ttm,T,!0),this._setNodesValue(this._textNodes.priceEarnings,e.price_earnings_ttm,T,!0),this._setNodesValue(this._textNodes.marketCap,e.market_cap_basic,C,!0),this._setNodesValue(this._textNodes.volume,e.volume,C,!0);const I=(0,p.prepareCurrencyValue)(r);if(I&&this._setNodesValue(this._textNodes.currency,I,g.quoteTickerFormatCurrency,!0),(r.lp_time||e.lp_time)&&this._textNodes.lastPriceTime.length&&(this._timeFormatter&&this._timeFormatter.lastPrice?this._setNodesValue(this._textNodes.lastPriceTime,f(this._timeFormatter.lastPrice(e.lp_time,e.current_session),this._options.lastPriceTimeInBrackets)):b.logError("last price time field requested with no formatter provided")),
(r.last_release_date||e.last_release_date)&&this._textNodes.lastReleaseDate.length&&(this._timeFormatter&&this._timeFormatter.lastReleaseDate?this._setNodesValue(this._textNodes.lastReleaseDate,f(this._timeFormatter.lastReleaseDate(e.last_release_date,e.current_session),this._options.lastReleaseDateTimeInBrackets)):b.logError("lastReleaseDate time field requested with no formatter provided")),(r.rtc_time||e.rtc_time)&&this._textNodes.rtcTime.length&&(this._timeFormatter&&this._timeFormatter.rtc?this._setNodesValue(this._textNodes.rtcTime,f(this._timeFormatter.rtc(e.rtc_time,e.current_session),this._options.rtcTimeInBrackets)):b.logError("rtc time field requested with no formatter provided")),null!=r.last_price)for(A=0;A<this._elements.updateMode.length;A++)this._elements.updateMode[A].classList.remove("i-hidden");this._elements.updateMode&&(r.update_mode||r.update_mode_seconds)&&(this._updateModeInstances?this._updateModeInstances.forEach((t=>t.update({values:e}))):this._updateModeInstances=this._elements.updateMode.map((t=>new u.DataModeIndicator({classSuffix:this._options.dataModeClassSuffix,el:t,data:{values:e},modeInterval:e.update_mode_seconds,short:!0,tooltipType:this._options.indicatorsTooltipType})))),this._setStateHook&&this._setStateHook(t.values,i.values,t.complete,this.getOptions()),this._lastPrice?this._highlighters.last.show(e.last_price):null===this._lastPrice&&(this._container.classList.add("quote-ticker-inited"),"function"==typeof this._options.initedHook&&this._options.initedHook("last_price"in e)),this._lastPrice=e.last_price},w.prototype._setNodesValue=function(e,t,s,i){if(null!=t||i)for(var r="function"==typeof s?s(t):t,n=0;n<e.length;n++)e[n].nodeValue=r},w.prototype._setTextsContent=function(e,t,s){if(e&&e.length&&t)for(var i="function"==typeof s?s(t):t,r=0;r<e.length;r++)e[r].textContent=i},w.prototype._setLastValue=function(e,t,s){if(null==e)return;const i="function"==typeof s?s(e):String(e);if(i===this._lastPriceFormatted)return;const[r,n,o]=this._options.lastPriceHighlightDiffOnly?this._getLastValueStringDiff(this._lastPriceFormatted,i):["",i,""],a=r,l=this._calculatePipetteDigits(t),[h,d]=this._options.lastPriceLastCharSup&&l?[n.slice(0,-l),n.slice(-l)]:[n,""];this._options.lastPriceHighlightDiffOnly&&(this._isVolumeFormat&&this._changeVolumeLetter.call(this,o),this._setNodesValue(this._textNodes.last,a)),this._setNodesValue(this._textNodes.lastHighlight,h),this._setNodesValue(this._textNodes.lastSup,d),this._lastPriceFormatted=i},w.prototype._getChangeVolumeLetterCallback=function(){let e;return function(t){t!==e&&(e=t,this._elements.last.forEach((t=>{3!==t.childNodes.length?t.appendChild(document.createTextNode(e)):t.childNodes[2].nodeValue=e})))}},w.prototype._getLastValueStringDiff=function(e,t){if(e===t){const[e,s]=x(t);return[e,"",s]}let s=0;for(;e[s]===t[s];)s++;const[i,r]=x(t.slice(s));return[t.slice(0,s),i,r]},w.prototype._calculatePipetteDigits=function(e){return e&&e!==this._lastMinMove&&(this._lastMinMove=e),this._lastMinMove?(""+this._lastMinMove).length-1:0},
w.prototype._setChangeFontColor=function(e,t,s,i,r){for(var n=a.PriceColorer.formatSign(t,{up:s,down:i,neutral:r}),o=0;o<e.length;o++)e[o].style.color=n},w.prototype._setChangeDirection=function(e,t){for(var s=0;s<e.length;s++){var i=e[s].classList;i.toggle(this._options.changeDirectionUpClass,t>0),i.toggle(this._options.changeDirectionDownClass,t<0),i.toggle(this._options.changeDirectionNeutralClass,0===t)}},w.prototype.setShortName=function(e=""){this._setTextsContent(this._elements.shortName,e)},w.prototype._prepareSymbolDescription=function(e){var t=this._getCache("symbol-description:"+e);return t||(t=e,this._setCache("symbol-description:"+e,t),t)},w.prototype._initHighlighters=function(){this._highlighters.last=new P(this._elements.lastHighlight,this._options.growingBg,this._options.fallingBg,this._options.lastGrowingClass,this._options.lastFallingClass),this._highlighters.extHrsClose=new P(this._elements.extHrsClose,this._options.growingBg,this._options.fallingBg,this._options.lastGrowingClass,this._options.lastFallingClass)},w.prototype.disable=function(){this.enabled=!1,this.disconnect()},w.prototype.enable=function(){this.enabled=!0,this.connect()},w.prototype.setStateHook=function(e){null===e&&this._setStateHook?delete this._setStateHook:"function"==typeof e&&(this._setStateHook=e)},w.prototype._setCache=function(e,t){null==t?delete this._cache[e]:this._cache[e]=t},w.prototype._getCache=function(e){return this._cache&&this._cache[e]},w.prototype.getOptions=function(){return this._options}},708333:(e,t,s)=>{"use strict";s.d(t,{setNewBlackColor:()=>i});const i=(0,s(788312).isFeatureEnabled)("set_new_black_color")},733149:e=>{"use strict";var t={},s={XCBT:"CBOT",XNYM:"NYMEX",XCME:"CME",XCEC:"COMEX"};t.convertSymbolDataToTV=function(e,t,i){return i=2===i||"floor"===i||"pit"===i?"PIT":"GBX",t&&s[t]?{status:"ok",data:{symbol:e,exchange:s[t]+"_"+i}}:{status:"error",data:"Exchange `"+t+"` is not supported"}},e.exports=t},60554:(e,t,s)=>{"use strict";s.d(t,{getDayResolutionTimeFrameOptions:()=>u,getFromForDay:()=>l,getFromForMonthsAgo:()=>o,getFromForYearsAgo:()=>a,getMediumTimeFrameOptions:()=>c,getMiniTimeFrameOptions:()=>d,getStartOfTheYear:()=>h});var i=s(882619),r=s(501004);const n=Date.now();function o(e){const t=new Date(n);return t.setMonth(t.getMonth()-e),Math.trunc(t.valueOf()/1e3)}function a(e){const t=new Date(n);return t.setFullYear(t.getFullYear()-e),Math.trunc(t.valueOf()/1e3)}function l(e){const t=new Date(n);return t.setDate(t.getDate()-e),Math.trunc(t.valueOf()/1e3)}function h(){return Math.trunc((0,i.resetToYearStart)(new Date(n)).valueOf()/1e3)}function d(e){const t=(0,r.getTimeFrames)();return[{...t[e?"lastsession":"1d"]},{...t["1m"],targetResolution:"1D",from:o(1)},{...t["3m"],targetResolution:"1D",from:o(3)},{...t["12m"],from:a(1)},{...t["60m"],targetResolution:"1M",from:a(5)},{...t.all}]}function u(e){const t=(0,r.getTimeFrames)();return[{...t[e?"lastsession":"1d"]},{...t["1m"],targetResolution:"1D",from:o(1)},{...t["3m"],targetResolution:"1D",from:o(3)},{...t["6m"],targetResolution:"1D",
from:o(6)},{...t.ytd,targetResolution:"1D",from:o(6)},{...t["12m"],from:a(1)}]}function c(e){const t=(0,r.getTimeFrames)(),s=[];return 1!==e&&s.push({...t.lastsession}),0!==e&&s.push({...t["1d"]}),[...s,{...t["1m"],targetResolution:"60",from:o(1)},{...t["3m"],targetResolution:"120",from:o(3)},{...t["12m"],from:a(1)},{...t["60m"],targetResolution:"1W",from:a(5)},{...t.all}]}},501004:(e,t,s)=>{"use strict";s.d(t,{getTimeFrames:()=>n});var i=s(729193),r=s(870754);function n(e){return{"1d":{text:i.t(null,void 0,s(938100)),value:{value:"1D",type:"period-back"},targetResolution:e?.["1D"]??(0,r.stringAsResolution)("1"),description:(0,r.daysStringLiteral)(1)},"5d":{text:i.t(null,void 0,s(82855)),value:{value:"5D",type:"period-back"},targetResolution:e?.["5D"]??(0,r.stringAsResolution)("5"),description:(0,r.daysStringLiteral)(5)},"1w":{text:i.t(null,void 0,s(492135)),value:{value:"7D",type:"period-back"},targetResolution:e?.["5W"]??(0,r.stringAsResolution)("15"),description:(0,r.weeksStringLiteral)(1)},"1m":{text:i.t(null,void 0,s(832733)),value:{value:"1M",type:"period-back"},targetResolution:e?.["1M"]??(0,r.stringAsResolution)("30"),description:(0,r.monthsStringLiteral)(1)},"3m":{text:i.t(null,void 0,s(819078)),value:{value:"3M",type:"period-back"},targetResolution:e?.["3M"]??(0,r.stringAsResolution)("60"),description:(0,r.monthsStringLiteral)(3)},"6m":{text:i.t(null,void 0,s(68076)),value:{value:"6M",type:"period-back"},targetResolution:e?.["6M"]??(0,r.stringAsResolution)("120"),description:(0,r.monthsStringLiteral)(6)},"12m":{text:i.t(null,void 0,s(770303)),value:{value:"12M",type:"period-back"},targetResolution:e?.["12M"]??(0,r.stringAsResolution)("1D"),description:(0,r.yearsStringLiteral)(1)},"24m":{text:i.t(null,void 0,s(934777)),value:{value:"24M",type:"period-back"},targetResolution:e?.["24M"]??(0,r.stringAsResolution)("1W"),description:(0,r.yearsStringLiteral)(2)},"36m":{text:i.t(null,void 0,s(272098)),value:{value:"36M",type:"period-back"},targetResolution:e?.["36M"]??(0,r.stringAsResolution)("1W"),description:(0,r.yearsStringLiteral)(3)},"60m":{text:i.t(null,void 0,s(446560)),value:{value:"60M",type:"period-back"},targetResolution:e?.["60M"]??(0,r.stringAsResolution)("1W"),description:(0,r.yearsStringLiteral)(5)},"120m":{text:i.t(null,void 0,s(995066)),value:{value:"120M",type:"period-back"},targetResolution:e?.["120M"]??(0,r.stringAsResolution)("1M"),description:(0,r.yearsStringLiteral)(10)},ytd:{text:i.t(null,void 0,s(422369)),value:{value:"YTD",type:"period-back"},targetResolution:e?.YTD??(0,r.stringAsResolution)("1D"),description:i.t(null,void 0,s(485420))},all:{text:i.t(null,void 0,s(233690)),value:{value:"ALL",type:"period-back"},targetResolution:e?.ALL??(0,r.stringAsResolution)("1M")},lastsession:{text:i.t(null,void 0,s(938100)),value:{value:"LASTSESSION",type:"period-back"},targetResolution:e?.LASTSESSION??(0,r.stringAsResolution)("1"),description:(0,r.daysStringLiteral)(1)}}}},870754:(e,t,s)=>{"use strict";s.d(t,{daysStringLiteral:()=>o,hoursStringLiteral:()=>n,minutesStringLiteral:()=>r,
monthsStringLiteral:()=>l,stringAsResolution:()=>d,weeksStringLiteral:()=>a,yearsStringLiteral:()=>h});var i=s(729193);const r=e=>i.t(null,{plural:"{str} minutes",count:e,replace:{str:`${e}`}},s(4390)),n=e=>i.t(null,{plural:"{str} hours",count:e,replace:{str:`${e}`}},s(210574)),o=e=>i.t(null,{plural:"{str} days",count:e,replace:{str:`${e}`}},s(103030)),a=e=>i.t(null,{plural:"{str} weeks",count:e,replace:{str:`${e}`}},s(644625)),l=e=>i.t(null,{plural:"{str} months",count:e,replace:{str:`${e}`}},s(694617)),h=e=>i.t(null,{plural:"{str} years",count:e,replace:{str:`${e}`}},s(216402)),d=e=>e},501434:(e,t,s)=>{"use strict";s.d(t,{timeFrames:()=>i});const i=(0,s(501004).getTimeFrames)()},244007:(e,t,s)=>{"use strict";function i(e){if(void 0===e)return"";if(e instanceof Error){let t=e.message;return e.stack&&(t+=" "+e.stack),t}return"string"==typeof e?e.toString():JSON.stringify(e)}s.d(t,{errorToString:()=>i})},798534:(e,t,s)=>{"use strict";function i(e,t){t||(t={}),"function"==typeof t&&(t={cmp:t});var s=t.space||"";"number"==typeof s&&(s=Array(s+1).join(" "));var i,o="boolean"==typeof t.cycles&&t.cycles,a=t.replacer||function(e,t){return t},l=t.cmp&&(i=t.cmp,function(e){return function(t,s){var r={key:t,value:e[t]},n={key:s,value:e[s]};return i(r,n)}}),h=[];return function e(t,i,d,u){var c=s?"\n"+new Array(u+1).join(s):"",p=s?": ":":";if(d&&d.toJSON&&"function"==typeof d.toJSON&&(d=d.toJSON()),void 0!==(d=a.call(t,i,d))){if("object"!=typeof d||null===d)return JSON.stringify(d);if(r(d)){for(var _=[],m=0;m<d.length;m++){var g=e(d,m,d[m],u+1)||JSON.stringify(null);_.push(c+s+g)}return"["+_.join(",")+c+"]"}if(-1!==h.indexOf(d)){if(o)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}h.push(d);var y=n(d).sort(l&&l(d));for(_=[],m=0;m<y.length;m++){var f=e(d,i=y[m],d[i],u+1);if(f){var b=JSON.stringify(i)+p+f;_.push(c+s+b)}}return h.splice(h.indexOf(d),1),"{"+_.join(",")+c+"}"}}({"":e},"",e,0)}s.d(t,{sortedStringify:()=>i});var r=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e)},n=Object.keys||function(e){var t=Object.prototype.hasOwnProperty||function(){return!0},s=[];for(var i in e)t.call(e,i)&&s.push(i);return s}},606703:(e,t,s)=>{"use strict";s.d(t,{prepareCurrencyValue:()=>r});var i=s(729193);function r(e){let t=[];const r=function(e){switch(e){case"PCT":return"%";case"PCTPAR":return i.t(null,{context:"_max_len_9"},s(468460));case"PCTGDP":return i.t(null,{context:"_max_len_9"},s(558412));default:return e}}(e.currency_code||e.value_unit_id||"");switch(e.measure){case"price":case"unit":t=[r,e.unit_id];break;default:t=[r]}return t.filter(Boolean).join("â€‰/â€‰")}},503699:e=>{
e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 44 44" width="44" height="44"><path fill="currentColor" fill-rule="evenodd" d="M29.48 15.32c-.16-.14-.4-.07-.48.13a6.05 6.05 0 0 1-2.38 3.13 6.16 6.16 0 0 1-.8.42c-.06.03-.14-.03-.13-.1a19.45 19.45 0 0 0 .08-.9v-.1c.38-5.91-2.43-9.13-4.59-10.41a7.4 7.4 0 0 0-.79-.4c-.1-.05-.21.13-.2.24a5.7 5.7 0 0 1-.04.73v.01c-.27 2.49-2.22 4.29-4.21 6.14-1.63 1.5-3.29 3.05-4.11 5.02a10.48 10.48 0 0 0-.83 4.06A10.9 10.9 0 0 0 20.17 34c.95-.59 1.34-1.82 1.33-3.04 0-.35-.04-.7-.11-1.03.28 0 .68.14 1.07.41A3.36 3.36 0 0 1 23.83 34 10.89 10.89 0 0 0 33 23.29c0-3.15-1.36-5.98-3.52-7.97Zm-4.56 17.4c4.1-1.23 7.08-5 7.08-9.43 0-2.5-.94-4.78-2.5-6.52a6.43 6.43 0 0 1-3.27 3.14m-1.3 12.81a4.3 4.3 0 0 0-2.2-3.39c-.4-.23-.88-.4-1.34-.4h-1.22l.24 1.2c.13.62.12 1.3-.03 1.86-.1.41-.27.73-.48.94A9.9 9.9 0 0 1 12 23.3c0-1.3.27-2.53.75-3.67.42-1 1.1-1.91 1.95-2.81.6-.64 1.23-1.23 1.9-1.84l.87-.82c1.57-1.5 3.2-3.22 3.61-5.54 1.9 1.34 4.29 4.44 3.61 10.16-.09.78.7 1.52 1.55 1.14"/></svg>'},145619:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 44 44" width="44" height="44"><path fill="currentColor" d="M28 16H16v1h12v-1ZM28 20H16v1h12v-1ZM16 24h12v1H16v-1Z"/><path fill="currentColor" fill-rule="evenodd" d="m22 30-10 4V12a1 1 0 0 1 1-1h18a1 1 0 0 1 1 1v22l-10-4Zm-9 2.52V12h18v20.52l-9-3.6-9 3.6Z"/></svg>'},490353:e=>{"use strict"
;e.exports=JSON.parse('{"dur":"350ms","dur-fast":"60ms","ease-in-like":"cubic-bezier(0.33, 0, 0.11, 1)","ease-out-like":"cubic-bezier(0.89, 0, 0.67, 1)","size-feed-item-width":"480px","size-feed-hident":"20px","size-feed-vident":"20px","size-base-indent":"4px","size-layout-small-horzpadding":"12px","size-layout-horzpadding":"20px","size-drawings-toolbar-item-height":"38px","size-header-linkindent":"15px","size-header-height":"64px","size-nav-header-height":"58px","size-sticky-symbol-header-height":"64px","size-dialog-fixed-header-height":"72px","size-site-widget-padding":"20px","size-site-widget-padding-tablet":"12px","size-collapse-tabs-height":"56px","size-no-scroll-choicer-height":"56px","size-main-chart-area-indent":"4px","size-main-chart-area-radius":"0","size-searchbar-height":"80px","size-searchbar-height-tablet":"54px","size-searchbar-btn-width-tablet":"66px","size-content-top-vindent":"48px","size-layout-width":"1020px","size-layout-width-wide":"1520px","size-checkbox-side":"18px","size-checkbox-click-expand":"10px","size-control-input-height--xsmall":"19px","size-control-input-height--small":"27px","size-control-input-height":"34px","size-control-input-height--large":"48px","size-control-input-padding-horz":"12px","size-tabs-horz-indent":"16px","size-avatar-border-radius":"3px","size-chart-view-spacing":"25px","size-chart-view-spacing-tablet":"20px","radius-embed-widget-wrapper":"3px","typography-platform-regular-16px-line-height":"24px","typography-platform-regular-18px-line-height":"28px","media-notebook":"all and (max-width: 1530px)","media-tablet":"all and (max-width: 1019px)","media-phone":"all and (max-width: 767px)","media-phone-vertical":"all and (max-width: 479px)","media-extreme-thin":"all and (max-width: 329px)","media-show-drawer":"all and (max-width: 567px)","media-mf-legacy-phone-vertical":"all and (min-width: 330px)","media-mf-legacy-phone":"all and (min-width: 480px)","media-mf-legacy-notebook":"all and (min-width: 1020px)","media-mf-legacy-desktop-medium":"all and (min-width: 1480px)","media-mf-legacy-desktop":"all and (min-width: 1531px)","media-mf-phone-vertical":"all and (min-width: 320px)","media-mf-phone-landscape":"all and (min-width: 568px)","media-mf-tablet-vertical":"all and (min-width: 768px)","media-mf-tablet-landscape":"all and (min-width: 1024px)","media-mf-laptop":"all and (min-width: 1280px)","media-mf-desktop-medium":"all and (min-width: 1440px)","media-mf-desktop-large":"all and (min-width: 1920px)","media-mf-desktop-extra-large":"all and (min-width: 2560px)","container-tablet":"(max-width: 1019px)","container-phone":"(max-width: 767px)","container-phone-vertical":"(max-width: 479px)","container-mf-phone-vertical":"(min-width: 300px)","container-mf-phone-landscape":"(min-width: 548px)","container-mf-tablet-vertical":"(min-width: 702px)","container-mf-tablet-landscape":"(min-width: 958px)","container-mf-laptop":"(min-width: 1214px)","container-mf-desktop-medium":"(min-width: 1374px)","container-mf-desktop-large":"(min-width: 1854px)","container-mf-desktop-extra-large":"(min-width: 2494px)","media-laptop":"all and (min-width: 1280px) and (max-width: 1439px)","media-laptop-and-desktop-medium":"all and (min-width: 1280px) and (max-width: 1919px)","media-landscape":"all and (min-device-width: 375px) and (max-device-height: 812px) and (orientation: landscape)","media-phone-landscape":"all and (max-height: 440px) and (orientation: landscape)","media-widgetbar-breakpoint":"all and (max-width: 1064px)","z-index-content-page":1,"z-index-chart-legend":6,"z-index-chart-right-corner-controls":7,"z-index-loading-screen":8,"z-index-dropdown":99,"z-index-toolbar-popup-menu":100,"z-index-tooltip":1000,"z-index-user-link-popup":900,"z-index-sticky-search-bar":101,"z-index-resizable-drawer":800,"disabled-state-opacity":0.5,"size-gap-minimum":"20px","size-gap-medium":"40px","size-gap-maximum":"100px"}')
}},e=>{e.O(0,[77038],(()=>{[16073,36295,26395,3535,8106,71319].map(e.E)}),5);e.O(0,[70165,88062,6784,23038,47139,52682,66920,68120,49135,97523,61178,20431,29936,70224,79306,47405,1103,89738,30411,79171,79575,99827,4645,4998,99395,88471,30734,65758,55736,82688,10443,70438,49894,60802,40760,40482,41494,23664,30402,12014,77998,82426,92384,53701,71677,44408,90009,43508,77435,34112,47728,83227,19052,10973,44365,27985],(()=>{return t=315709,e(e.s=t);var t}));e.O()}]);