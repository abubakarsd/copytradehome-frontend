"use strict";(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[60802],{781680:(t,e,i)=>{function s(t,e,i){const s=t.get(e);return void 0!==s?s:(t.set(e,i),i)}function r(t,e,i){const s=t.get(e);if(void 0!==s)return s;const r=i();return t.set(e,r),r}function o(t,e,i,r){const o=s(t,e,new Map);return s(o,i,r)}function n(t,e,i,o){return r(s(t,e,new Map),i,o)}function a(t,e,i,r,o){const n=s(t,e,new Map),a=s(n,i,new Map);return s(a,r,o)}i.d(e,{AbstractMapContainer:()=>l,getDefault2:()=>o,getDefault2Lazy:()=>n,getDefault3:()=>a});class l{constructor(){this._map=new Map,this._size=0}size(){return this._size}clear(){this._map.clear(),this._size=0}}},482498:(t,e,i)=>{i.d(e,{getTranslatedInputTitle:()=>o});var s=i(729193);const r={PercentageLTP:"Percentage LTP",Labels:"Pane labels",LineFills:"Line fills"};function o(t){return s.t(r[t]??t,{context:"input"},i(325118))}},350204:(t,e,i)=>{i.d(e,{AbstractBarColorer:()=>s});class s{constructor(){this._backColorers=[]}barStyle(t,e,i){const s={};for(const r of this._backColorers)r.applyBarStyle(t,e,s,i);return this.applyBarStyle(t,e,s,i),s}pushBackBarColorer(t){this._backColorers.unshift(t)}firstColoredBar(t){return null}}},508836:(t,e,i)=>{i.d(e,{ConflatedChunksBuilder:()=>n});var s=i(185842),r=i(188485);const o=[{barsToMerge:10,forBarspacingLargerThen:.03},{barsToMerge:30,forBarspacingLargerThen:.01},{barsToMerge:100,forBarspacingLargerThen:.003},{barsToMerge:500,forBarspacingLargerThen:0}];class n{constructor(t,e){this._plots=t,this._state={chunks:new Map,priceSource:null,priceSourcesProvider:e},this._setEmptyConflatedChunks()}conflatedChunks(t,e){if(e!==this._state.priceSource){this._state.priceSource=e;const t=this._plots.first();t&&(this._setEmptyConflatedChunks(),this._rebuildConflatedChunks(t))}const i=(0,s.ensureDefined)(o.find((e=>e.forBarspacingLargerThen<=t)));return(0,s.ensureDefined)(this._state.chunks.get(i.barsToMerge))}mergeData(t){const e=this._plots.size(),i=this._plots.merge(t);return i&&null!==this._state.priceSource&&(e===this._plots.size()&&i.index===this._plots.lastIndex()?this._updateLatestChunks():this._rebuildConflatedChunks(i)),i}moveData(t){this._plots.move(t),this._plots.size()>0&&this._clearState()}clearData(){this._plots.clear(),this._clearState()}_rebuildConflatedChunks(t){const e=this._state.priceSource;if(null===e)return;const i=t.index,n=this._state.priceSourcesProvider(e),a=(t,e,i)=>{let s=null;for(const r of t){const t=n(r.value);s&&r.index-s.startTime>=i.barsToMerge&&(e.push(s),s=null),s?(s.endTime=r.index,s.high=Math.max(s.high,t),s.low=Math.min(s.low,t),s.close=t):s={startTime:r.index,endTime:r.index,open:t,high:t,low:t,close:t}}s&&e.push(s)};o.forEach((t=>{const e=(0,s.ensureDefined)(this._state.chunks.get(t.barsToMerge)),o=(0,r.lowerbound)(e,i,((t,e)=>t.endTime<e));if(0===o&&e.length>0){const i=e[0].startTime-1,r=(0,s.ensureNotNull)(this._plots.firstIndex()),o=this._plots.rangeIterator(r,i),n=[];a(o,n,t);const l=n.concat(e);this._state.chunks.set(t.barsToMerge,l)}else{const i=(0,s.ensureNotNull)(this._plots.lastIndex())
;e.splice(o);let r=(0,s.ensureNotNull)(this._plots.firstIndex());e.length&&(r=e[e.length-1].endTime+1);const n=this._plots.rangeIterator(r,i);a(n,e,t)}}))}_updateLatestChunks(){const t=(0,s.ensureNotNull)(this._plots.last()),e=this._state.priceSourcesProvider("close");o.forEach((i=>{const r=(0,s.ensureDefined)(this._state.chunks.get(i.barsToMerge)),o=e(t.value),n=r[r.length-1];n.high=Math.max(n.high,o),n.low=Math.min(n.low,o),n.close=o,n.endTime=t.index}))}_setEmptyConflatedChunks(){o.forEach((t=>this._state.chunks.set(t.barsToMerge,[])))}_clearState(){this._state.chunks.clear(),this._state.priceSource=null}}},570442:(t,e,i)=>{i.d(e,{actualCurrencyUnitMetricVisibility:()=>l,currencyUnitMetricVisibilityOptions:()=>n,currencyUnitMetricVisibilityProperty:()=>o,migrateShowCurrencyAndShowUnitProperties:()=>u,restoreCurrencyUnitMetricVisibilitySettingsValue:()=>a});var s=i(5109),r=i(950808);const{property:o,availableValues:n,restoreDefaultValue:a,actualBehavior:l}=(0,s.createVisibilityController)("PriceAxisCurrencyAndUnit.visibility");let h=!1;function u(t,e){h||(h=!0,void 0===r.default.getValue("PriceAxisCurrencyAndUnit.visibility")&&o().setValue(t||e?"alwaysOn":"alwaysOff"))}},719456:(t,e,i)=>{i.d(e,{DataWindowItem:()=>s,DataWindowView:()=>r});class s{constructor(t,e,i,s=!1){this._visible=!0,this._id=t,this._title=e,this._value=i,this._unimportant=s}id(){return this._id}title(){return this._title}setTitle(t){this._title=t}text(){return this._value}value(){return this._value}setValue(t){this._value=t}visible(){return this._visible}setVisible(t){this._visible=t}color(){return this._color}setColor(t){this._color=t}unimportant(){return this._unimportant}}class r{constructor(){this._items=[],this._header="",this._title=""}header(){return this._header}title(){return this._title}items(){return this._items}canShowItems(){return!0}update(t){}}},866641:(t,e,i)=>{i.d(e,{FormattersSerializer:()=>h});var s=i(185842),r=i(605434),o=i(760823),n=i(594461),a=i(680949);const l={price:r.PriceFormatter,volume:o.VolumeFormatter,percentage:n.PercentageFormatter,quoteSessionPrice:a.QuoteSessionPriceFormatter};var h;!function(t){function e(t){return(0,s.ensureDefined)(l[t.type]).deserialize(t.state)}t.serialize=function(t){const e=(0,s.ensureDefined)(l[t.type]);return{type:t.type,state:e.serialize(t)}},t.isSerializable=function(t){return"string"==typeof t.type&&t.type in l},t.deserialize=e,t.safeDeserialize=function(t){try{return e(t)}catch(t){return null}}}(h||(h={}))},680949:(t,e,i)=>{i.d(e,{QuoteSessionPriceFormatter:()=>r});var s=i(605434);class r{constructor(t){this.type="quoteSessionPrice",this.reset(t)}state(){return this._priceFormatter.state()}reset(t){this._priceFormatter=t||new s.PriceFormatter({priceScale:100,minMove:1,fractional:!1})}update(t,e){const i=null!=e.pricescale||null!=e.minmov||null!=e.fractional||null!=e.minmove2,r=null!=t.pricescale&&null!=t.minmov&&null!=t.fractional&&null!=t.minmove2;i&&r&&(this._priceFormatter=new s.PriceFormatter({priceScale:t.pricescale,minMove:t.minmov,fractional:t.fractional||!1,
minMove2:t.minmove2}))}format(t,e){return this._priceFormatter.format(t,e)}hasForexAdditionalPrecision(){return this._priceFormatter.hasForexAdditionalPrecision()}static serialize(t){return t.state()}static deserialize(t){const e=new s.PriceFormatter(t);return new r(e)}}},744940:(t,e,i)=>{i.d(e,{getPriceValueFormatterForSource:()=>l,getPriceValueFormatterForStudy:()=>h,shouldBeFormattedAsIndexedTo100:()=>n,shouldBeFormattedAsPercent:()=>o});var s=i(70346),r=i(461592);function o(t){const e=t.priceScale();return!(null===e||!e.isPercentage())&&(!(0,r.isActingAsSymbolSource)(t)||(0,s.isPriceSourceStyle)(t.style()))}function n(t){const e=t.priceScale();return!(null===e||!e.isIndexedTo100())&&(!(0,r.isActingAsSymbolSource)(t)||(0,s.isPriceSourceStyle)(t.style()))}function a(t){const e=t.priceScale();return n(t)&&null!==e?(i,s)=>e.formatPriceIndexedTo100(i,t.firstValue()??100,s):o(t)&&null!==e?(i,s)=>e.formatPricePercentage(i,t.firstValue()??100,s):null}function l(t){const e=a(t);if(e)return e;const i=t.formatter();return i.format.bind(i)}function h(t,e){const i=a(t);if(i)return i;const s=t.plotFormatter(e);return s.format.bind(s)}},786775:(t,e,i)=>{i.d(e,{HorizontalLinePaneView:()=>o});var s=i(807708),r=i(515834);class o{constructor(){this._lineRendererData={y:0,color:"rgba(0, 0, 0, 0)",linewidth:1,linestyle:r.LINESTYLE_SOLID,visible:!1},this._lineRenderer=new s.HorizontalLineRenderer,this._invalidated=!0,this._lineRenderer.setData(this._lineRendererData)}update(t){this._invalidated=!0}renderer(){return this._invalidated&&(this._updateImpl(),this._invalidated=!1),this._lineRenderer}}},75336:(t,e,i)=>{i.d(e,{notAvailable:()=>s});i(729193),i(266150);const s="âˆ…"},807211:(t,e,i)=>{i.d(e,{getNumericFormatter:()=>u,getPercentageFormatter:()=>c,getPipFormatter:()=>p,getVolumeFormatter:()=>d});var s=i(148544),r=i(594461),o=i(3135),n=i(605434);class a extends n.PriceFormatter{constructor(t){const{priceScale:e,minMove:i=1,type:s,typespecs:r,minMove2:n,ignoreLocaleNumberFormat:a}=t;("forex"===s||(0,o.isCFDSymbol)(s,r))&&n?(super({priceScale:n,ignoreLocaleNumberFormat:a}),this._isForex=!0):(super({priceScale:1,ignoreLocaleNumberFormat:a}),this._isForex=!1),this._pipPriceScale=e,this._pipMinMove=i,this._pipMinMove2=n}format(t,e={}){const{signPositive:i,tailSize:s,ignoreLocaleNumberFormat:r,noExponentialForm:o}=e;let n=this._isForex?this._pipMinMove2:this._pipMinMove;return void 0===n&&(n=NaN),super.format(t*this._pipPriceScale/n,{signPositive:i,tailSize:s,ignoreLocaleNumberFormat:r,noExponentialForm:o})}}var l=i(760823),h=i(513433);const u=(0,h.numDependencyFormatter)((t=>new s.NumericFormatter({precision:t}))),c=(0,h.numDependencyFormatter)((t=>new r.PercentageFormatter({priceScale:Math.pow(10,t??2),minMove:1}))),d=(0,h.numDependencyFormatter)((t=>new l.VolumeFormatter({precision:t}))),_=new WeakMap;function p(t){let e=_.get(t);return e||(e=new a({priceScale:t.pricescale,minMove:t.minmov,minMove2:t.minmove2,type:t.type,typespecs:t.typespecs}),_.set(t,e)),e}},324111:(t,e,i)=>{i.d(e,{AreaBackgroundItem:()=>l,
AreaBackgroundItemsGroup:()=>n,AreaBackgroundRenderer:()=>h,CachedMap:()=>a});var s=i(185842),r=i(550837),o=i(481756);class n extends o.CachedContainer{constructor(t){super(),this.color=t}}class a{constructor(){this._map=new Map,this._usedKeys=new Set,this._invalidations=0}invalidateCache(){this._invalidations+=1,50===this._invalidations&&(this._deleteUnused(),this._invalidations=0),this._usedKeys.clear(),this._map.forEach(((t,e)=>t.invalidateCache()))}get(t){const e=this._map.get(t);return void 0!==e&&this._usedKeys.add(t),e}set(t,e){this._usedKeys.add(t),this._map.set(t,e)}[Symbol.iterator](){const t=Array.from(this._usedKeys)[Symbol.iterator]();return{[Symbol.iterator](){return this},next:()=>{const e=t.next();return e.value?{value:[e.value,(0,s.ensureDefined)(this._map.get(e.value))],done:!1}:{value:void 0,done:!0}}}}forEach(t){this._map.forEach(((e,i)=>{this._usedKeys.has(i)&&t(e,i)}))}delete(t){const e=this._map.get(t);void 0!==e&&e.invalidateCache(),this._usedKeys.delete(t)}_deleteUnused(){const t=[];this._map.forEach(((e,i)=>{this._usedKeys.has(i)||t.push(i)}));for(const e of t)this._map.delete(e)}}class l extends o.CachedContainer{constructor(){super(),this.points1=new o.CachedContainer,this.points2=new o.CachedContainer,this.push(this.points1),this.push(this.points2)}addPoints1Point(t,e){let i=this.points1.newItem();null!==i?(i.x=t,i.y=e):i={x:t,y:e},this.points1.push(i)}addPoints2Point(t,e){let i=this.points2.newItem();null!==i?(i.x=t,i.y=e):i={x:t,y:e},this.points2.push(i)}invalidateCache(){this.points1.invalidateCache(),this.points2.invalidateCache()}}class h extends r.BitmapCoordinatesPaneRenderer{constructor(t){super(),this._data=null,this._data=t??null}setData(t){this._data=t}hitTest(t){return null}_drawImpl(t){if(null===this._data)return;const{context:e,horizontalPixelRatio:i,verticalPixelRatio:s}=t,r=.25*this._data.barSpacing;for(const[,t]of this._data.colorAreas){e.beginPath();for(let o=0;o<t.length();o++){const n=t.at(o);if(n.points1.isEmpty()||n.points2.isEmpty())continue;const a=n.points1.at(0).x,l=n.points1.at(0).y;if(e.moveTo(Math.round(a*i),l*s),1!==n.points1.length()&&1!==n.points2.length()){for(const t of n.points1.iterator(1))e.lineTo(Math.round(t.x*i),t.y*s);for(const t of n.points2.iterator(n.points2.length()-1,!0))e.lineTo(Math.round(t.x*i),t.y*s)}else{const t=n.points2.at(0).x,o=n.points2.at(0).y;e.lineTo(Math.round((a+r)*i),l*s),e.lineTo(Math.round((t+r)*i),o*s),e.lineTo(Math.round((t-r)*i),o*s),e.lineTo(Math.round((a-r)*i),l*s)}}if(e.closePath(),0===t.color.type)e.fillStyle=t.color.color;else{const i=e.createLinearGradient(0,t.color.coordinate1*s,0,t.color.coordinate2*s);i.addColorStop(0,t.color.color1??"transparent"),i.addColorStop(1,t.color.color2??"transparent"),e.fillStyle=i}e.fill()}}}},807708:(t,e,i)=>{i.d(e,{HorizontalLineRenderer:()=>l});var s=i(141463),r=i(138264),o=i(515338),n=i(550837),a=i(320093);class l extends n.BitmapCoordinatesPaneRenderer{constructor(){super(...arguments),this._data=null,this._hitTest=new s.HitTestResult(s.HitTarget.Regular)}setData(t){this._data=t}
setHitTest(t){this._hitTest=t}hitTest(t){if(null===this._data||!1===this._data.visible||null===this._hitTest)return null;const e=(0,o.interactionTolerance)().line,i=Math.abs(t.y-this._data.y)<=e+this._data.linewidth/2,s=void 0===this._data.left||this._data.left-t.x<=e,r=void 0===this._data.right||t.x-this._data.right<=e;return i&&s&&r?this._hitTest:null}_drawImpl(t){if(null===this._data||!1===this._data.visible)return;const{context:e,horizontalPixelRatio:i,verticalPixelRatio:s,mediaSize:o}=t;if(this._data.y<-this._data.linewidth/2||this._data.y>o.height+this._data.linewidth/2)return;e.lineCap="butt",e.strokeStyle=this._data.color,e.lineWidth=Math.max(1,Math.floor(this._data.linewidth*i)),void 0!==this._data.linestyle&&(0,r.setLineStyle)(e,this._data.linestyle);const n=void 0!==this._data.left?Math.max(this._data.left,0):0,l=void 0!==this._data.right?Math.min(this._data.right,o.width):o.width,h=Math.round(this._data.y*s),u=Math.round(n*i),c=Math.round(l*i),d=this._data.excludeBoundaries;void 0!==d&&(0,a.addExclusionAreaByScope)(t,d),(0,r.drawHorizontalLine)(e,h,u,c)}}},481756:(t,e,i)=>{i.d(e,{CachedContainer:()=>r,ObjectValuesCache:()=>o});class s{constructor(t,e,i,s){this._items=t,this._actualLength=e,this._step=s?-1:1,this._currentIndex=i-this._step}[Symbol.iterator](){return this}next(){return this._currentIndex+=this._step,this._currentIndex>=this._actualLength||this._currentIndex<0?{value:void 0,done:!0}:{done:!1,value:this._items[this._currentIndex]}}}class r{constructor(){this._items=[],this._actualLength=0,this._invalidations=0}push(t){this._items.length===this._actualLength?this._items.push(t):this._items[this._actualLength]!==t&&(this._items[this._actualLength]=t),this._actualLength+=1}newItem(){const t=this._items.length>this._actualLength?this._items[this._actualLength]:null;return null!==t&&Boolean(t.invalidateCache)&&t.invalidateCache(),t}invalidateCache(){this._invalidations+=1,3e3===this._invalidations&&(this._items.splice(this._actualLength),this._invalidations=0),this._actualLength=0}at(t){return this._items[t]}data(){return this._items}length(){return this._actualLength}isEmpty(){return 0===this._actualLength}iterator(t,e){return new s(this._items,this._actualLength,t,e)}}class o extends r{constructor(){super(...arguments),this._startIndex=0}setStartIndex(t){this._startIndex=t}isValidIndex(t){return t>=this._startIndex}at(t){const e=t-this._startIndex;for(;e>=this._actualLength;)this._items.length<=e?this._items.push(this._newObject()):this._clearObject(this._items[this._actualLength]),this._actualLength+=1;return this._items[e]}}},15474:(t,e,i)=>{i.d(e,{PriceLineAxisView:()=>l,SeriesPriceLineAxisView:()=>h,StudyPriceLineAxisView:()=>u});var s=i(816570),r=i(185842),o=i(515834),n=i(138264);class a{constructor(t,e){this.setData(t,e)}setData(t,e){this._data=t,this._commonData=e}draw(t,e,i,s,a){if(!this._data.visible)return;const{bitmapSize:l,verticalPixelRatio:h}=e,u=this._commonData.fixedCoordinate??this._commonData.coordinate;t.lineWidth=Math.max(1,Math.floor((0,
r.ensureDefined)(this._data.linewidth)*h)),t.lineCap="butt",(0,n.setLineStyle)(t,void 0===this._data.linestyle?o.LINESTYLE_DOTTED:this._data.linestyle),t.strokeStyle=this._commonData.textColor,(0,n.drawHorizontalLine)(t,Math.round(u*h),0,l.width)}topBottomTotalHeight(t){return{top:0,bottom:0,total:0}}}class l extends s.PriceAxisView{constructor(t){super(t||a)}ignoreAlignment(){return!0}_updateRendererData(t,e,i){if(e.visible=!1,t.visible=!1,!this._isVisible())return;const s=this._value();s.noData||(i.background="",i.textColor=this._priceLineColor(s.color),i.coordinate=s.coordinate,t.linewidth=this._lineWidth(),t.linestyle=this._lineStyle(),t.backgroundAreaVisible=this._backgroundAreaVisible(),t.backgroundAreaColor=this._backgroundAreaColor(),t.backgroundAreaHeight=this._backgroundAreaHeight(),t.visible=!0)}_lineStyle(){return o.LINESTYLE_DOTTED}_backgroundAreaVisible(){return!1}_backgroundAreaColor(){return""}_backgroundAreaHeight(){return 0}}class h extends l{constructor(t){super(),this._series=t}_value(){return this._series.lastValueData(void 0,!0)}_priceLineColor(t){return this._series.priceLineColor(t)}_lineWidth(){return this._series.properties().childs().priceLineWidth.value()}_isVisible(){const t=this._series.model().properties().childs().scalesProperties.childs().showSeriesLastValue.value();return this._series.properties().childs().showPriceLine.value()&&t}}class u extends l{constructor(t,e){super(),this._study=t,this._plotname=e}update(t){"hover-change"!==t.type&&super.update(t)}_value(){return this._study.lastValueData(this._plotname,!0)}_lineWidth(){return this._study.properties().childs().styles.childs()[this._plotname].childs().linewidth.value()}_lineStyle(){return o.LINESTYLE_DOTTED}_priceLineColor(t){return t}_isVisible(){const t=this._study.model().properties().childs().scalesProperties.childs().showStudyLastValue.value(),e=this._study.isPlotVisibleAt(this._plotname,1);return this._study.properties().childs().styles.childs()[this._plotname].childs().trackPrice.value()&&t&&e}}},855714:(t,e,i)=>{i.d(e,{PaneRendererBars:()=>o});var s=i(515338),r=i(379980);class o extends r.PaneRendererSeriesBase{constructor(t){super(),this._bars=t.bars,this._dontDrawOpen=t.dontDrawOpen,this._thinBars=t.thinBars}_drawImpl(t){const{context:e,horizontalPixelRatio:i,verticalPixelRatio:s}=t;e.save();let r=null;for(const t of this._bars){let o=this._calcRealBarWidth(t.right-t.left,i);if(o>=2){Math.max(1,Math.floor(i))%2!=o%2&&o--}const n=this._thinBars?Math.min(o,Math.floor(i)):o,a=n<=o&&t.right-t.left>=Math.floor(1.5*i);r!==t.color&&(e.fillStyle=t.color,r=t.color);const l=Math.floor(.5*n),h=Math.round(t.center*i),u=h-l,c=n,d=u+c-1,_=Math.min(t.high,t.low),p=Math.max(t.high,t.low),f=Math.round(_*s)-l,m=Math.round(p*s)+l,v=Math.max(m-f,n);e.fillRect(u,f,c,v);const y=Math.ceil(1.5*o);if(a){const i=h-y,r=h+y,o=Math.min(u-i,r-d);if(!this._dontDrawOpen){let r=Math.max(f,Math.round(t.open*s)-l),n=r+c-1;n>f+v-1&&(n=f+v-1,r=n-c+1),e.fillRect(i,r,o,n-r+1)}let n=Math.max(f,Math.round(t.close*s)-l),a=n+c-1;a>f+v-1&&(a=f+v-1,n=a-c+1),
e.fillRect(d+1,n,o,a-n+1)}}e.restore()}_getTolerance(){return(0,s.interactionTolerance)().series}_calcRealBarWidth(t,e){const i=Math.floor(e);return Math.max(i,Math.floor((0,s.optimalBarWidth)(t,e)))}}},379980:(t,e,i)=>{i.d(e,{PaneRendererSeriesBase:()=>o});var s=i(141463),r=i(550837);class o extends r.BitmapCoordinatesPaneRenderer{constructor(){super(...arguments),this._bars=[]}hitTest(t){const e=this._bars;if(0===e.length)return null;const i=this._getTolerance(),s=e[0],r=e[e.length-1];if(t.x<s.left-i)return null;if(t.x>r.right+i)return null;let o=0,n=e.length-1,a=-1;for(;o<=n;){const i=Math.floor((o+n)/2),s=e[i];if(t.x>=s.left&&t.x<=s.right){a=i;break}t.x>s.right?o=i+1:n=i-1}if(-1===a)return null;if(this._isPointAtBar(e[a],t.y,i))return this._getHitTest();let l=a;for(;l>=1&&t.x-e[l-1].right<i;)l--;let h=a;for(;h<=e.length-2&&e[h+1].left-t.x<i;)h++;const u=Math.max(0,l),c=Math.min(e.length-1,h);for(let s=u;s<=c;s++)if(s!==a&&this._isPointAtBar(e[s],t.y,i))return this._getHitTest();return null}_getHitTest(){return new s.HitTestResult(s.HitTarget.Regular)}_isPointAtBar(t,e,i){const s=Math.min(t.high,t.low),r=Math.max(t.high,t.low);return s-i<=e&&e<=r+i}}},426820:(t,e,i)=>{i.d(e,{PaneRendererCandles:()=>h});var s=i(185842),r=i(141463),o=i(138264),n=i(515338),a=i(379980);function l(t,e,i,s){const r=Math.floor(e);return t.map((t=>{let o=(0,n.optimalCandlestickWidth)((t.right-t.left)*s,e);o>=2&&r%2!=o%2&&o--;const a=Math.floor(.5*o),l=function(t,e){let i=Math.floor(1*e);t<=2*i&&(i=Math.floor(.5*(t-1)));const s=Math.max(Math.floor(e),i);if(t<=2*s)return Math.max(Math.floor(e),Math.floor(1*e));return s}(o,e),h=Math.round(t.center*e),u=h-a,c=u+o-1,d=Math.abs(Math.max(t.open,t.close)-Math.min(t.open,t.close))*i,_=Math.round(Math.min(t.open,t.close)*i),p=Math.round(Math.max(t.open,t.close)*i);let f=Math.min(Math.floor(e),Math.floor(o*e));f=Math.max(Math.floor(e),Math.min(f,o));const m=Math.floor(.5*f);return{rawBodyHeight:d,top:_,bottom:p,center:h,left:u,right:c,candleWidth:o,high:Math.round(t.high*i),low:Math.round(t.low*i),wickWidth:f,wickOffset:m,borderWidth:l}}))}class h extends a.PaneRendererSeriesBase{constructor(t){super(),this._scaleCoeff=1,this._borderVisible=!1,this._wickVisible=!1,this._bodyVisible=!0,this._borderColor=void 0,this._wickColor=void 0,this._hittest=void 0,this._isPriceScaleInverted=!1,t&&this.setData(t)}setData(t){this._bars=t.bars,this._scaleCoeff=t.scaleCoeff??1,this._borderVisible=t.borderVisible,this._bodyVisible=t.bodyVisible,this._wickVisible=t.wickVisible,this._borderColor=t.borderColor,this._wickColor=t.wickColor,this._hittest=t.hittest,this._isPriceScaleInverted=t.isPriceScaleInverted}hitTest(t){return this._wickVisible||this._borderVisible||this._bodyVisible?super.hitTest(t):null}_drawImpl(t){const{context:e,horizontalPixelRatio:i,verticalPixelRatio:s}=t;if(0===this._bars.length)return;const r=l(this._bars,i,s,this._scaleCoeff);this._wickVisible&&this._drawWicks(e,r),this._borderVisible&&this._drawBorder(e,r),this._bodyVisible&&this._drawCandles(e,r)}_getTolerance(){return(0,
n.interactionTolerance)().series}_getHitTest(){return this._hittest||new r.HitTestResult(r.HitTarget.Regular)}_isPointAtBar(t,e,i){const s=this._bodyVisible||this._borderVisible,r=this._wickVisible;if(!s&&!r)return!1;if(s){const s=r?Math.min(t.high,t.low):Math.min(t.open,t.close),o=r?Math.max(t.high,t.low):Math.max(t.open,t.close);return s-i<=e&&e<=o+i}{const s=Math.min(t.open,t.close),r=Math.max(t.open,t.close);return t.high-i<=e&&e<=s+i||r-i<=e&&e<=t.low+i}}_drawWicks(t,e){let i="",r=null;this._bars.forEach(((o,n)=>{const a=o.wickColor?o.wickColor:(0,s.ensureDefined)(this._wickColor);a!==i&&(t.fillStyle=a,i=a);let{top:l,bottom:h}=e[n];const{rawBodyHeight:u,borderWidth:c,center:d,high:_,low:p,wickWidth:f,wickOffset:m}=e[n];this._isPriceScaleInverted&&([h,l]=[l,h]);let v=d-m;const y=v+f-1;null!==r&&(v=Math.max(r+1,v),v=Math.min(v,y));const g=y-v+1;u<=c&&(l!==_&&(l=Math.round(l-.5*c)),h=h!==p?Math.round(l-.5*c)+c-1:p-1),l!==_&&t.fillRect(v,_,g,l-_),p-h-1&&t.fillRect(v,h+1,g,p-h-1),r=y}))}_drawBorder(t,e){let i="",r=null;this._bars.forEach(((n,a)=>{if(n.borderColor!==i&&(t.fillStyle=n.borderColor?n.borderColor:(0,s.ensureDefined)(this._borderColor),i=n.borderColor),this._bodyVisible&&n.hollow)return;let{left:l}=e[a];const{rawBodyHeight:h,top:u,bottom:c,right:d,borderWidth:_}=e[a];null!==r&&(l=Math.max(r+1,l),l=Math.min(l,d));const p=d-l+1;h<=_?t.fillRect(l,Math.round(u-.5*_),p,_):p>2*_?(0,o.fillRectInnerBorder)(t,l,u,d-l+1,c-u+1,_):t.fillRect(l,u,p,c-u+1),r=d}))}_drawCandles(t,e){let i="";this._bars.forEach(((s,r)=>{let{top:n,bottom:a,left:l,right:h}=e[r];const{rawBodyHeight:u,borderWidth:c,candleWidth:d}=e[r];if(!(this._borderVisible&&d<=2*c)||s.hollow){if(s.color!==i){const e=s.color;t.fillStyle=e,i=e}if(s.hollow)t.fillStyle=s.color,u<=c?t.fillRect(l,Math.round(n-.5*c),d,c):(0,o.fillRectInnerBorder)(t,l,n,h-l+1,a-n+1,c);else{if(!this._borderVisible&&u<=c)return void t.fillRect(l,Math.round(n-.5*c),d,c);if(this._borderVisible&&(l+=c,n+=c,h-=c,a-=c),n>a)return;t.fillRect(l,n,h-l+1,a-n+1)}}}))}}},19322:(t,e,i)=>{i.d(e,{HHistBasedValuesProvider:()=>f});var s=i(197486),r=i(185842),o=i(376596),n=i(115676),a=i(49833),l=i(807211),h=i(742912),u=i(187614),c=i(75336);function d(t,e="",i=""){return{id:e,index:t,orderIndex:t,title:i,value:"",visible:!1}}const _=o.CheckMobile.any(),p=(0,l.getVolumeFormatter)();class f{constructor(t,e,i=!1){this._emptyValues=[],this._study=t,this._model=e,this._emptyTitles=i,void 0!==this._study.metaInfo().graphics.hhists&&this._emptyValues.push(d(0),d(1),d(2))}getItems(){return this._emptyValues}getValues(t){const e=this._emptyValues.map((t=>({...t})));e.forEach((t=>{t.visible=this._study.isVisible(),t.value=c.notAvailable}));const i=this._study.properties().childs().inputs.childs().volume.value();switch(i){case h.HHistVolumeMode.UpDown:this._emptyTitles||(e[0].title="Up",e[1].title="Down",e[2].title="Total");break;case h.HHistVolumeMode.Total:this._emptyTitles||(e[0].title="Total"),e[1].visible=!1,e[2].visible=!1;break;case h.HHistVolumeMode.Delta:this._emptyTitles||(e[0].title="Delta",
e[1].title="Max(Up, Down)",e[2].title="Total")}const o=this._study.priceScale(),a=this._model.timeScale();if(null===o||o.isEmpty()||a.isEmpty()||this._hideValues())return e;if(null===t||!isFinite(t)){const i=this._study.data().last();if(null===i)return e;t=i.index}const l=this._model.crosshairSource(),u=l.price;if(!isFinite(l.y)&&null===(t=function(t,e){const i=t.visibleBarsStrictRange()?.lastBar();if(!i)return null;const s=e.data().search(i,n.PlotRowSearchMode.NearestLeft);return s?s.index:null}(this._model.timeScale(),this._model.mainSeries())))return e;const d=function(t,e,i,s){if(0===t.size)return null;if(!i){const t=(0,r.ensureNotNull)(s.data().valueAt(e));i=s.barFunction()(t)}const o=function(t,e){let i=null;return t.forEach(((t,s)=>{null!==s&&s<=e&&(null===i||s>i)&&(i=s)})),i}(t,e);if(null===o)return null;const n=t.get(o);if(!n||0===n.size)return null;return function(t,e){let i=null;return t.forEach((t=>{t.priceLow<=e&&e<t.priceHigh&&(i=t)})),i}(n,i)}(this._study.graphics().hhistsByTimePointIndex(),t,u,this._model.mainSeries());if(null===d)return e.forEach((t=>{t.value="0"})),e;const _=this._study.metaInfo().graphics.hhists;if(void 0===_)return e;if(void 0===_[d.styleId])return e;const f=this._study.properties().childs().graphics.childs().hhists?.childs()[d.styleId]?.childs(),m=t=>(0,s.isNumber)(t)?p.format(t):"";if(i!==h.HHistVolumeMode.Delta){if(d.rate.forEach(((t,i)=>{e[i].value=m(t),e[i].color=(0,r.ensureDefined)(f).colors[i].value()})),i===h.HHistVolumeMode.UpDown){const t=d.rate[0]+d.rate[1];e[2].value=m(t),e[2].color=(0,r.ensureDefined)(f).valuesColor.value()}}else{const t=d.rate[0]>d.rate[1]?0:1,i=(0,r.ensureDefined)(f).colors[t].value(),s=d.rate[0]+d.rate[1];[2*d.rate[t]-s,d.rate[t],s].forEach(((t,s)=>{e[s].value=m(t),e[s].color=i}))}return e}_hideValues(){return _&&(null===this._model.crosshairSource().pane||(0,u.isLineToolName)(a.tool.value())||null!==this._model.lineBeingEdited())}}},740608:(t,e,i)=>{i.d(e,{StudyDataWindowValuesProvider:()=>o});var s=i(590969),r=i(19322);class o{constructor(t,e){this._study=t,this._model=e,this._hhistBasedStudy=void 0!==t.metaInfo().graphics.hhists,this._valuesProvider=this._createValuesProvider(t,e)}getItems(){return this._valuesProvider.getItems()}getValues(t){const e=this._valuesProvider.getValues(t),i=t=>!!this._hhistBasedStudy||this._study.isPlotVisibleAt(t,2);for(const t of e)t.visible=t.visible&&i(t.id);return e}_createValuesProvider(t,e){return this._hhistBasedStudy?new r.HHistBasedValuesProvider(t,e):new s.StudyValuesProvider(t,e)}}},460137:(t,e,i)=>{i.d(e,{StudyLegendValuesProvider:()=>o});var s=i(590969),r=i(19322);class o{constructor(t,e,i,s){this._study=t,this._model=e,this._showStudyValues=s??e.properties().childs().paneProperties.childs().legendProperties.childs().showStudyValues,this._hhistBasedStudy=void 0!==t.metaInfo().graphics.hhists,this._valuesProvider=this._createValuesProvider(t,e,i)}getItems(){return this._valuesProvider.getItems()}getValues(t){
const e=this._valuesProvider.getValues(t),i=this._study.properties(),s=this._showStudyValues.value()&&i.childs().showLegendValues.value(),r=t=>!!this._hhistBasedStudy||this._study.isPlotVisibleAt(t,8);for(const t of e)t.visible=t.visible&&s&&r(t.id);return e}_createValuesProvider(t,e,i){return this._hhistBasedStudy?new r.HHistBasedValuesProvider(t,e,i):new s.StudyValuesProvider(t,e,i)}}},396691:(t,e,i)=>{i.d(e,{studyAvailablePriceSources:()=>s});const s=["open","high","low","close","hl2","hlc3","ohlc4","hlcc4"]},132618:(t,e,i)=>{i.d(e,{StudyTableViewValuesProvider:()=>o});var s=i(185842),r=i(590969);class o{constructor(t,e){this._study=t,this._valuesProvider=new r.StudyValuesProvider(t,e,!1,!1)}getItems(){const t=this._study.properties().childs(),e=this._valuesProvider.getItems();for(const i of e){const e=i.id,r=(0,s.ensureDefined)(t.styles.childs()[e]).childs().display.value();i.visible=0!==r}return e}getValues(t){const e=this._valuesProvider.getValues(t),i=this._study.plots().lastIndex(),s=this._study.plots().firstIndex();if(null===i||null===s)return null;for(const r of e){const e=t-this._study.offset(r.id);(e>i||e<s)&&(r.value="")}return e}}},590969:(t,e,i)=>{i.d(e,{StudyValuesProvider:()=>b});var s=i(197486),r=i(266150),o=i(376596),n=i(275925),a=i(115676),l=i(187614),h=i(49833),u=i(321582),c=i(710704),d=i(292188),_=i(744940),p=i(185842),f=i(75336),m=i(870720);const v=o.CheckMobile.any(),y=(0,r.isFeaturesetEnabled)("hide_last_na_study_output"),g=(0,r.isFeaturesetEnabled)("always_show_legend_values_on_mobile");class b{constructor(t,e,i,s=!0){this._emptyValues=[],this._colorProviders=new Map,this._study=t,this._model=e,this._searchNearestLeft=s,this._studyMetaInfo=this._study.metaInfo(),this._studyProperties=this._study.properties().childs(),this._isFundamental=(0,d.isFundamentalStudyMetaInfo)(this._studyMetaInfo);const r=this._studyMetaInfo.plots;if(!r)return;let o=0;r.forEach(((t,e)=>{if((0,u.isPlotWithTechnicalValues)(t))return;const s=t.id;this._emptyValues.push(function(t,e,i="",s=""){return{id:i,index:t,orderIndex:e,title:s,value:"",visible:!1}}(e,o++,s,i?"":this._study.guiPlotName(m.TitleDisplayTarget.StatusLine,s)));const r=(0,u.isOhlcPlot)(t)?t.target:s;this._colorProviders.set(r,(0,c.createStudyPlotColorProvider)(this._studyMetaInfo,this._study.properties(),r))}))}getItems(){return this._emptyValues}getPlotColor(t,e){const i=e[t+1];if(!(0,s.isNumber)(i))return"";const r=i>0;let o;const n=this._studyMetaInfo.plots[t];let a=n.id;const l=this._studyProperties;if((0,u.isOhlcPlot)(n))a=n.target||a,o=(0,p.ensureDefined)(l.ohlcPlots.childs()[a].childs().color).value();else if((0,u.isArrowsPlot)(n)){const t=(0,p.ensureDefined)(l.styles.childs()[a]);o=r?t.childs().colorup.value():t.childs().colordown.value()}else o=(0,p.ensureDefined)(l.styles.childs()[a]?.child("color")).value();let h=o;const c=this._colorProviders.get(a),d=c&&c.getPlotPointStyle(e);return d&&((0,u.isArrowsPlot)(n)?(r&&void 0!==d.colors[5]&&(h=d.colors[5]),r||void 0===d.colors[6]||(h=d.colors[6])):void 0!==d.colors[0]&&(h=d.colors[0])),
"transparent"===h&&(h=o),h}getValues(t){const e=this._emptyValues.map((t=>({...t})));let i=null;const r=this._study.data().lastIndex(),o=this._studyProperties;if(null!==r){const t=this._searchNearestLeft?a.PlotRowSearchMode.NearestLeft:a.PlotRowSearchMode.Exact;for(const s of e){const e=o.styles.childs()[s.id]?.childs().display.value();if(0===e)continue;const n=this._study.nearestIndex(r,t,s.index+1);if(void 0===n)continue;const a=n+this._study.offset(s.id);i=null!==i?Math.max(a,i):a}}(null===t||null!==i&&t>i)&&(t=i);const l=this._hideValues(),h=this._study.isVisible()&&!l?f.notAvailable:"";for(const t of e)t.value=h;if(l)return e;y&&e.length&&(e[e.length-1].value="");const c=this._study.priceScale();if(!this._study.isVisible()||null===t||null===c||c.isEmpty()||this._model.timeScale().isEmpty())return e;const d={};for(const i of e){const e=i.id,l=(0,_.getPriceValueFormatterForStudy)(this._study,e),h=(0,p.ensureDefined)(o.styles.childs()[e]),c=h.childs().display.value();if(i.visible=0!==c,!i.visible)continue;const f=h.hasChild("plottype")?h.child("plottype")?.value():null,m=this._searchNearestLeft&&this._isFundamental&&(f===u.LineStudyPlotStyle.StepLine||f===u.LineStudyPlotStyle.StepLineWithDiamonds),v=i.index,y=t-this._study.offset(e),g=m||null!==r&&y>r?a.PlotRowSearchMode.NearestLeft:a.PlotRowSearchMode.Exact,b=this._study.nearestIndex(y,g);if(void 0===b)continue;let w=d[e];if(void 0===w&&(w=this._study.getMinFirstBarIndexForPlot(e),Number.isFinite(w)&&(d[e]=w)),w>b)continue;const M=this._study.data().last(),S=this._study.data().valueAt(b)||(null!==M?M.value:null);if(null===S)continue;const P=S[v+1];(0,s.isNumber)(P)&&(i.value=l(P),i.color=(0,n.resetTransparency)(this.getPlotColor(v,S)))}return e}_hideValues(){return g?(0,l.isLineToolName)(h.tool.value())||null!==this._model.lineBeingEdited():v&&(null===this._model.crosshairSource().pane||(0,l.isLineToolName)(h.tool.value())||null!==this._model.lineBeingEdited())}}},123081:(t,e,i)=>{i.d(e,{EXCLUDED_FOR_ALERT_ID_INPUTS:()=>v,collectDepsForAlert:()=>b,plotsForAlert:()=>g});var s=i(532153),r=i(185842),o=i(396691),n=i(532180),a=i(77357),l=i(87837),h=i(127985),u=i(635978),c=i(321582);const d=(0,a.getLogger)("Chart.Study"),_="$";function p(t,e,i){void 0!==i&&i.forEach((i=>{const s=t[i];"string"==typeof s?t[i]=f(s,e):(0,n.isExtendedInput)(s)&&(0,n.isExtendedInputSource)(s)?s.v=f((0,n.getInputValue)(s),e):d.logError(`Cannot patch source input, its type is not source: ${JSON.stringify(s)}`)}))}function f(t,e){const[i,s]=m(t),r=e.get(i);return r?r+(void 0===s?"":_+s):t}function m(t){return t.split(_)}const v=["text","pineFeatures"];function y(t){return(0,s.default)(t,v)}function g(t,e){const i=[c.isLinePlot,c.isShapesPlot,c.isCharsPlot,c.isArrowsPlot,c.isOhlcPlot,c.isAlertConditionPlot];return t.plots.map(((t,e)=>({...t,pinePlotIndex:e}))).filter((t=>i.some((e=>e(t))))).map((i=>{const s={id:i.id,type:i.type,pinePlotIndex:i.pinePlotIndex,offset:e(i.id)};if(t.styles&&void 0!==t.styles[i.id]){const e=(0,r.ensureDefined)((0,r.ensureDefined)(t.styles)[i.id]);s.title=e.title||"",
s.text=e.text||""}return(0,c.isOhlcPlot)(i)&&i.target&&t.ohlcPlots&&t.ohlcPlots[i.target]&&(s.ohlcTitle=(0,r.ensureDefined)((0,r.ensureDefined)(t.ohlcPlots)[i.target]).title),s}))}function b(t,e){try{t=function(t){const e=new Map;for(const i of t)e.set(i.id(),w(i));const i=new Map;function s(t,r=new Set){const o=i.get(t);if(void 0!==o)return o;if(r.has(t))throw new Error(`Dependency cycle detected at source id ${t}`);r.add(t);const n=e.get(t)??[],a=0===n.length?0:1+Math.max(...n.map((t=>s(t,r))));return r.delete(t),i.set(t,a),a}for(const t of e.keys())s(t);return[...t].sort(((t,e)=>(i.get(e.id())??0)-(i.get(t.id())??0)))}(t)}catch(t){d.logError(`Failed to normalize the owner sources array: ${t}`)}const i=[],s=new Map;let o;for(let r=t.length-1;r>=0;r--){const n=t[r],a=(0,l.extractStudyId)(n.metaInfo().id),c=h.StudyMetaInfo.getStudyIdWithLatestVersion(n.metaInfo());o=n.inputsForAlertState();p(o,s,n.metaInfo().inputs.filter((t=>"source"===t.type)).map((t=>t.id)));const d=n.metaInfo().isTVScript?y(o):o,_=(0,u.getStudyIdForAlert)(a,d,e);i.push({id:_,study:c,inputs:o}),s.set(n.id(),_)}const n=i.reverse();return{idForAlert:(0,r.ensureDefined)(n[0].id),inputsForAlert:(0,r.ensureDefined)(o),studyDependencies:n}}function w(t){const e=t.inputsForAlertState(),i=[];for(const t of Object.values(e)){if(!(0,n.isExtendedInput)(t)||!(0,n.isExtendedInputSource)(t))continue;const e=t.v;if(!!o.studyAvailablePriceSources.includes(e))continue;const[s]=m(e);i.push(s)}return i}},5109:(t,e,i)=>{i.d(e,{createVisibilityController:()=>h});var s=i(729193),r=i(952375),o=i(8914),n=i(950808);const a="visibleOnMouseOver";function l(t){return"alwaysOn"===t||"alwaysOff"===t?t:a}function h(t,e){let h,u;function c(){if(!h){h=(0,o.createPrimitiveProperty)();let i=n.getValue(t);void 0===i&&void 0!==e&&(i=n.getValue(e)),h.setValue(l(i)),h.subscribe(h,(e=>{n.setValue(t,l(e.value()))}))}return h}return{property:c,availableValues:function(){return[{id:"visibleOnMouseOver",value:"visibleOnMouseOver",title:r.mobiletouch?s.t(null,void 0,i(524795)):s.t(null,void 0,i(215671))},{id:"alwaysOn",value:"alwaysOn",title:s.t(null,void 0,i(356842))},{id:"alwaysOff",value:"alwaysOff",title:s.t(null,void 0,i(616375))}]},actualBehavior:function(){if(!u){u=(0,o.createPrimitiveProperty)();const t=c(),e=()=>{const e=function(t){switch(t){case"alwaysOn":return"alwaysOn";case"alwaysOff":return"alwaysOff";case"visibleOnMouseOver":return r.mobiletouch?"visibleOnTapSelection":"visibleOnMouseOver";default:throw new Error(`Unknown visibility type: ${t}`)}}(t.value());u&&u.setValue(e)};t.subscribe(u,e),e()}return u},restoreDefaultValue:function(){c().setValue(a),n.remove(t)}}}},475120:(t,e,i)=>{var s,r;i.d(e,{AlertChartDisplayTarget:()=>r,AlertStopReason:()=>s}),function(t){t[t.Auto=0]="Auto",t[t.Manual=1]="Manual",t[t.Expired=2]="Expired",t[t.Created=3]="Created"}(s||(s={})),function(t){t[t.Label=0]="Label",t[t.StatusView=1]="StatusView"}(r||(r={}))},635978:(t,e,i)=>{i.d(e,{getSeriesIdForAlert:()=>n,getStudyIdForAlert:()=>a});var s=i(200982),r=i(798534),o=i(357966);function n(t,e){
return(0,s.hash)(t+o.Interval.normalize(e)).toString()}function a(t,e,i){return(0,s.hash)(t+(0,r.sortedStringify)(e)+(i??"")).toString()}},174582:(t,e,i)=>{var s;i.d(e,{DataSourceDangerReason:()=>s}),function(t){t.Spread="spread",t.PineRepainting="pine-repainting",t.CryptoCap="cryptocap"}(s||(s={}))},813915:(t,e,i)=>{i.d(e,{showTooManyStudiesNotice:()=>o});var s=i(729193),r=i(474422);function o(t){(0,r.showWarning)({title:s.t(null,void 0,i(937017)),text:s.t(null,{replace:{number:`${t}`}},i(992362))})}},200982:(t,e,i)=>{function s(t){let e,i=0;if(0===t.length)return i;for(var s=0;s<t.length;s++)e=t.charCodeAt(s),i=(i<<5)-i+e,i|=0;return i}i.d(e,{hash:()=>s})}}]);