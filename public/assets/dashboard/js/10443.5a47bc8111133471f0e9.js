"use strict";(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[10443],{110443:(e,t,i)=>{i.d(t,{linking:()=>f});var s=i(88434),n=i(185842),r=i(77357),o=(i(266150),i(168509)),a=i(357966),l=i(70346),u=i(18107),h=i(592893);var c=i(950808),d=i(598944),b=i(599730),y=i(940043),m=i(446087),_=i(637581);var p=i(934101),S=i(507982),g=i(589589);const v=(0,r.getLogger)("Linking");class w{constructor(e,t,i){this.watchedSymbols=new o.WatchedValue([]),this.watchedSymbol=new o.WatchedValue,this.seriesShortSymbol=new o.WatchedValue,this.proSymbol=new o.WatchedValue,this.ensuredProSymbol=new o.WatchedValue,this.watchedInterval=new o.WatchedValue,this.watchedIntraday=new o.WatchedValue,this.watchedSeconds=new o.WatchedValue,this.watchedTicks=new o.WatchedValue,this.watchedDataFrequencyResolution=new o.WatchedValue,this.watchedRange=new o.WatchedValue,this.watchedSupportedResolutions=new o.WatchedValue,this.watchedSupportedChartStyles=new o.WatchedValue,this.symbolNamesList=new o.WatchedValue,this._chartWidgetCollection=null,this._chartWidgetBindingState=0,this._activeChartWidget=null,this._linkingGroupCharts=null,this._boundChartWidget=null,this._watchedSymbolListenerBound=this._watchedSymbolListener.bind(this),this._watchedIntervalListenerBound=this._watchedIntervalListener.bind(this),this._setGroupSymbolCancellationToken={cancelled:!1},this._muted=!1,this.updateBoundChartWidget=()=>{const e=this._chartToBind();e!==this._boundChartWidget&&(null===e?this.unbindFromChartWidget():this.bindToChartWidget(e))},this._updateAllGroupChartWidgets=()=>{this._destroySymbolIntervalPropertySubscriptions?.();const e=(0,n.ensureNotNull)(this._linkingGroupCharts).value(),t=[],i=[];for(const s of e){const e=s.symbolWV().spawn(),n=s.resolutionWV().spawn();e.subscribe(this._updateSymbolByProperty.bind(this,s)),n.subscribe(this._updateIntervalByProperty.bind(this,s)),t.push(e),i.push(n)}this._destroySymbolIntervalPropertySubscriptions=()=>{t.forEach((e=>e.destroy())),i.forEach((e=>e.destroy())),this._destroySymbolIntervalPropertySubscriptions=void 0};const s=this.watchedSymbol.value();e.length>1&&this._needApplySymbol(s)&&!this._muted&&this._setGroupSymbol(s);const r=this.watchedInterval.value();e.length>1&&this._needApplyInterval(r)&&!this._muted&&this._setGroupInterval(r),this.updateBoundChartWidget()},this._groupIndex=e;const s=(e,t)=>{e.subscribe((e=>{i()===this&&t.setValue(e)}),{callWithLast:!0})};s(this.watchedSymbols,t.watchedSymbols),s(this.watchedSymbol,t.watchedSymbol),s(this.seriesShortSymbol,t.seriesShortSymbol),s(this.proSymbol,t.proSymbol),s(this.ensuredProSymbol,t.ensuredProSymbol),s(this.watchedInterval,t.watchedInterval),s(this.watchedIntraday,t.watchedIntraday),s(this.watchedSeconds,t.watchedSeconds),s(this.watchedTicks,t.watchedTicks),s(this.watchedDataFrequencyResolution,t.watchedDataFrequencyResolution),s(this.watchedRange,t.watchedRange),s(this.watchedSupportedResolutions,t.watchedSupportedResolutions),s(this.watchedSupportedChartStyles,t.watchedSupportedChartStyles),s(this.symbolNamesList,t.symbolNamesList),
this.watchedSymbol.subscribe((e=>{this._boundChartWidget&&this._boundChartWidget.hasModel()&&this.mainSeries().symbolSameAsCurrent(e)||this.proSymbol.setValue(e)}),{callWithLast:!0})}mute(e){this._muted=e}bindToChartWidgetCollection(e){this.unbindFromChartWidgetCollection(),this._chartWidgetCollection=e,this._activeChartWidget=e.activeChartWidget.spawn(),this._activeChartWidget.subscribe(this.updateBoundChartWidget),this._linkingGroupCharts=e.linkingGroupsCharts(this._groupIndex).spawn(),this._linkingGroupCharts.subscribe(this._updateAllGroupChartWidgets),this.updateBoundChartWidget(),this._updateAllGroupChartWidgets();const t=function(e){const t=(0,u.combine)((()=>e.getAll().filter((e=>e.isVisible()&&e.hasModel())).map((e=>(0,h.createWVFromGetterAndSubscription)((()=>e.model().mainSeries().symbol()),e.model().mainSeries().symbolResolved()).ownership()))),e.chartModels().weakReference(),e.layout.weakReference());return(0,u.accumulate)((e=>e),t.ownership())}(e);t.subscribe((e=>{this.watchedSymbols.setValue(e)})),this.watchedSymbols.setValue(t.value())}unbindFromChartWidgetCollection(){this.unbindFromChartWidget(),this._chartWidgetCollection=null,this._activeChartWidget?.destroy(),this._activeChartWidget=null,this._linkingGroupCharts?.destroy(),this._linkingGroupCharts=null,this._destroySymbolIntervalPropertySubscriptions?.()}bindToChartWidget(e){if(this.unbindFromChartWidget(),this._boundChartWidget=e,e.hasModel())return void this._onChartModelCreated(e.model());e.modelCreated().subscribe(this,this._onChartModelCreated,!0),this._chartWidgetBindingState=1;const t=e.mainSeriesProperties().childs();this.watchedSymbol.setValue(t.symbol.value()),this.watchedInterval.setValue(t.interval.value()),this._boundChartWidget.linkingGroupIndex().subscribe(this.updateBoundChartWidget)}unbindFromChartWidget(){const e=this._boundChartWidget;if(null!==e){switch(this._chartWidgetBindingState){case 1:e.modelCreated().unsubscribeAll(this);break;case 2:this.watchedSymbol.unsubscribe(this._watchedSymbolListenerBound);const t=this.mainSeries().dataEvents();t.symbolResolved().unsubscribeAll(this),t.symbolError().unsubscribeAll(this),this.mainSeries().onIntervalChanged().unsubscribeAll(this),this.watchedInterval.unsubscribe(this._watchedIntervalListenerBound),delete this.watchedSymbol.writeLock}e.linkingGroupIndex().unsubscribe(this.updateBoundChartWidget),this._boundChartWidget=null,this._chartWidgetBindingState=0}}boundChartWidget(){return this._boundChartWidget}mainSeries(){if(!this._boundChartWidget)throw new Error("ChartWidget is undefined");return this._boundChartWidget.model().mainSeries()}_watchedSymbolListener(e){this._needApplySymbol(e)&&!this._muted&&this._setGroupSymbol(e)}_updateSymbolByProperty(e,t){const i=this._symbolLock();i&&this._needApplySymbol(t)&&!this._muted&&this._setGroupSymbol(t),(i||e===this._boundChartWidget)&&this.watchedSymbol.setValue(t)}_watchedIntervalListener(e){const t=a.Interval.normalize(e);t&&this._needApplyInterval(t)&&!this._muted&&this._setGroupInterval(t)}_updateIntervalByProperty(e,t){
const i=this._intervalLock(),s=a.Interval.normalize(t);i&&s&&this._needApplyInterval(s)&&!this._muted&&this._setGroupInterval(s),(i||e===this._boundChartWidget)&&this.watchedInterval.setValue(s??t)}_updateSeriesSymbolInfo(){this.seriesShortSymbol.setValue((0,n.ensureNotNull)(this._boundChartWidget).getSymbol(!0));const e=this.mainSeries().symbolInfo();if(e){const t=e.pro_name||!1;this.proSymbol.setValue(t||this.watchedSymbol.value()),this.ensuredProSymbol.setValue(this.proSymbol.value()),e.aliases&&this.symbolNamesList.setValue(e.aliases);let i=(0,S.allChartStyles)();((0,l.isCloseBasedSymbol)(e)||this.mainSeries().intervalObj().value().is1Tick())&&(i=i.filter((e=>(0,l.isSingleValueBasedStyle)(e)))),"hlc"===e.visible_plots_set&&(i=i.filter((e=>(0,l.isHLCBasedStyle)(e)||(0,l.isSingleValueBasedStyle)(e)))),this.watchedSupportedChartStyles.setValue(i),this.watchedIntraday.setValue(!!e.has_intraday),this.watchedSeconds.setValue(!!e.has_seconds),this.watchedTicks.setValue(!(0,l.isCloseBasedSymbol)(e)&&!!e["is-tickbars-available"]),this.watchedRange.setValue(!(0,l.isCloseBasedSymbol)(e));const s=e.data_frequency?e.data_frequency:void 0;this.watchedDataFrequencyResolution.setValue(s)}else this.watchedIntraday.setValue(!1),this.watchedSeconds.setValue(!1),this.watchedTicks.setValue(!1),this.watchedRange.setValue(!1),this.mainSeries().isFailed()&&this.ensuredProSymbol.setValue(this.proSymbol.value())}_onChartModelCreated(e){if(!this._boundChartWidget)throw new Error("ChartWidget is undefined");this._chartWidgetBindingState=2,this.watchedSymbol.setValue(this._boundChartWidget.symbolWV().value()),this.watchedSymbol.subscribe(this._watchedSymbolListenerBound);const t=e.mainSeries().dataEvents();t.symbolResolved().subscribe(this,this._updateSeriesSymbolInfo),t.symbolError().subscribe(this,this._updateSeriesSymbolInfo),e.mainSeries().onIntervalChanged().subscribe(this,this._updateSeriesSymbolInfo),this._updateSeriesSymbolInfo(),this.watchedInterval.setValue(this._boundChartWidget.resolutionWV().value()),this.watchedInterval.subscribe(this._watchedIntervalListenerBound),this._boundChartWidget.readOnly()&&(this.watchedSymbol.writeLock=!0)}_chartToBind(){const e=this._chartWidgetCollection;return null===e?null:e.activeChartWidget.value().linkingGroupIndex().value()===this._groupIndex?e.activeChartWidget.value():null!==this._boundChartWidget&&this._boundChartWidget.linkingGroupIndex().value()===this._groupIndex?this._boundChartWidget:e.getAll().find((e=>e.linkingGroupIndex().value()===this._groupIndex))??null}_symbolLock(){return!!this._chartWidgetCollection?.lock.symbol.value()}_intervalLock(){return!!this._chartWidgetCollection?.lock.interval.value()}_chartsForLock(e){return(0===e?this._symbolLock():this._intervalLock())?(0,n.ensureNotNull)(this._linkingGroupCharts).value():this._boundChartWidget?[this._boundChartWidget]:[]}_setGroupSymbol(e){this.mute(!0),this._setGroupSymbolCancellationToken.cancelled=!0;const t=this._setGroupSymbolCancellationToken={cancelled:!1};(0,
n.ensureNotNull)(this._chartWidgetCollection).setSymbol(e,this._groupIndex,(0,n.ensureNotNull)(this._boundChartWidget)).finally((()=>{if(this._boundChartWidget&&!t.cancelled){const t=this._boundChartWidget.model().mainSeries();t.symbolSameAsCurrent(e)||(this.watchedSymbol.setValue(t.symbol()),this.proSymbol.setValue(t.proSymbol()))}})),this.mute(!1)}_needApplySymbol(e){const t=this._chartsForLock(0),i=t.find((t=>t.hasModel()&&t.model().mainSeries().symbolInfo()&&t.model().mainSeries().symbolSameAsResolved(e)));if(i){const e=i.model().mainSeries();if(t.every((t=>e.symbolSameAsResolved(t.symbolWV().value()))))return!1}return t.some((t=>t.symbolWV().value()!==e))}_setGroupInterval(e){this.mute(!0),(0,n.ensureNotNull)(this._chartWidgetCollection).setResolution(e,this._groupIndex).finally((()=>{if(this._boundChartWidget){const t=this._boundChartWidget.resolutionWV().value();a.Interval.isEqual(t,e)||this.watchedInterval.setValue(t)}})),this.mute(!1)}_needApplyInterval(e){return this._chartsForLock(1).some((t=>!a.Interval.isEqual(t.resolutionWV().value(),e)))}}const f=new class{constructor(){this._watchedSymbols=new o.WatchedValue([]),this._watchedSymbol=new o.WatchedValue,this._seriesShortSymbol=new o.WatchedValue,this._proSymbol=new o.WatchedValue,this._ensuredProSymbol=new o.WatchedValue,this._watchedInterval=new o.WatchedValue,this._watchedIntraday=new o.WatchedValue,this._watchedSeconds=new o.WatchedValue,this._watchedTicks=new o.WatchedValue,this._watchedDataFrequencyResolution=new o.WatchedValue,this._watchedRange=new o.WatchedValue,this._watchedSupportedResolutions=new o.WatchedValue,this._watchedSupportedChartStyles=new o.WatchedValue([]),this._symbolNamesList=new o.WatchedValue,this._chartWidgetCollection=null,this._onSymbolLinkBound=this._onSymbolLink.bind(this),this._searchCharts=null,this._searchChartsLoadDebounced=null,this._selfEmit=!1,this._preventFeedBySymbol=!1,this._feedBySymbolDebounceCounter=0,this._linkingGroups=new Map,this._activeLinkingGroup=new o.WatchedValue,this._activeLinkingGroupIndex=null,this._updateLinkingGroups=()=>{(0,n.ensureNotNull)(this._chartWidgetCollection).allLinkingGroups().value().forEach((e=>this._linkingGroup(e))),this._linkingGroups.forEach((e=>e.updateBoundChartWidget()))},this._activeLinkingGroup.setValue(this._linkingGroup(null));const e=(e,t)=>{e.subscribe((e=>t().setValue(e)),{callWithLast:!0})};e(this._watchedSymbols,(()=>this._activeLinkingGroup.value().watchedSymbols)),e(this._watchedSymbol,(()=>this._activeLinkingGroup.value().watchedSymbol)),e(this._seriesShortSymbol,(()=>this._activeLinkingGroup.value().seriesShortSymbol)),e(this._proSymbol,(()=>this._activeLinkingGroup.value().proSymbol)),e(this._ensuredProSymbol,(()=>this._activeLinkingGroup.value().ensuredProSymbol)),e(this._watchedInterval,(()=>this._activeLinkingGroup.value().watchedInterval)),e(this._watchedIntraday,(()=>this._activeLinkingGroup.value().watchedIntraday)),e(this._watchedSeconds,(()=>this._activeLinkingGroup.value().watchedSeconds)),
e(this._watchedTicks,(()=>this._activeLinkingGroup.value().watchedTicks)),e(this._watchedDataFrequencyResolution,(()=>this._activeLinkingGroup.value().watchedDataFrequencyResolution)),e(this._watchedRange,(()=>this._activeLinkingGroup.value().watchedRange)),e(this._watchedSupportedResolutions,(()=>this._activeLinkingGroup.value().watchedSupportedResolutions)),e(this._watchedSupportedChartStyles,(()=>this._activeLinkingGroup.value().watchedSupportedChartStyles)),e(this._symbolNamesList,(()=>this._activeLinkingGroup.value().symbolNamesList));const t=e=>{this._watchedSymbol.setValue(e.watchedSymbol.value()),this._seriesShortSymbol.setValue(e.seriesShortSymbol.value()),this._proSymbol.setValue(e.proSymbol.value()),this._ensuredProSymbol.setValue(e.ensuredProSymbol.value()),this._watchedInterval.setValue(e.watchedInterval.value()),this._watchedIntraday.setValue(e.watchedIntraday.value()),this._watchedSeconds.setValue(e.watchedSeconds.value()),this._watchedTicks.setValue(e.watchedTicks.value()),this._watchedDataFrequencyResolution.setValue(e.watchedDataFrequencyResolution.value()),this._watchedRange.setValue(e.watchedRange.value()),this._watchedSupportedResolutions.setValue(e.watchedSupportedResolutions.value()),this._watchedSupportedChartStyles.setValue(e.watchedSupportedChartStyles.value()),this._symbolNamesList.setValue(e.symbolNamesList.value())};this._activeLinkingGroup.subscribe(t),t(this._activeLinkingGroup.value()),(0,g.setMuteLinkingGroup)(((e,t)=>{"all"===e?this._linkingGroups.forEach((e=>e.mute(t))):this._linkingGroup(e).mute(t)}))}get symbols(){return this._watchedSymbols}get symbol(){return this._watchedSymbol}get proSymbol(){return this._proSymbol.readonly()}get ensuredProSymbol(){return this._ensuredProSymbol.readonly()}get symbolNamesList(){return this._symbolNamesList.readonly()}get seriesShortSymbol(){return this._seriesShortSymbol.readonly()}get interval(){return this._watchedInterval}get intraday(){return this._watchedIntraday.readonly()}get seconds(){return this._watchedSeconds.readonly()}get ticks(){return this._watchedTicks.readonly()}get range(){return this._watchedRange.readonly()}get supportedResolutions(){return this._watchedSupportedResolutions.readonly()}get supportedChartStyles(){return this._watchedSupportedChartStyles.readonly()}get preventFeedBySymbol(){return this._preventFeedBySymbol}get dataFrequencyResolution(){return this._watchedDataFrequencyResolution.readonly()}activeLinkingGroup(){return this._activeLinkingGroup.readonly()}getChartWidget(){return this.activeLinkingGroup().value().boundChartWidget()}bindToChartWidgetCollection(e){this._chartWidgetCollection?.onAboutToBeDestroyed.unsubscribeAll(this),this._unbindFromChartWidgetCollection(),this._chartWidgetCollection=e,this._chartWidgetCollection.onAboutToBeDestroyed.subscribe(this,this._unbindFromChartWidgetCollection),this._chartWidgetCollection.allLinkingGroups().subscribe(this._updateLinkingGroups),this._updateLinkingGroups(),this._activeLinkingGroupIndex=e.activeLinkingGroup().spawn(),
this._activeLinkingGroupIndex.subscribe((e=>{this._activeLinkingGroup.setValue(this._linkingGroup(e))}),{callWithLast:!0}),this._linkingGroups.forEach((t=>t.bindToChartWidgetCollection(e)))}bindToSearchCharts(e){this.unbindFromSearchCharts(),this._searchCharts=e,e.onSearchBySymbol.subscribe(this,this._onSearchBySymbol),e.loadingSymbol.subscribe((e=>{!1===e&&(this._feedBySymbolDebounceCounter=0)})),this._watchedSymbol.subscribe(this._onSymbolLinkBound)}unbindFromSearchCharts(){this._searchCharts&&(this._searchCharts.onSearchBySymbol.unsubscribe(this,this._onSearchBySymbol),this._watchedSymbol.unsubscribe(this._onSymbolLinkBound),this._searchCharts=null)}setPreventFeedBySymbol(e){this._preventFeedBySymbol=e}setSymbolAndLogInitiator(e,t,i,s=!1){var n,r,o,a;(this.symbol.value()!==e||i)&&(v.logInfo(`Change linking symbol to ${e}, initiator: ${t}`),this.symbol.setValue(e,i),s||null===this._chartWidgetCollection||(n=this.activeLinkingGroup().value().mainSeries(),r=this._chartWidgetCollection.layout.value(),o=this._chartWidgetCollection.metaInfo.uid.value()||"",a=t,window.user.do_not_track||n.symbolResolvingActive().subscribe((e=>{if(e)return;const t=n.symbolInfo();t&&(0,_.getTracker)().then((e=>{null!==e&&e.trackChartSymbols({symbolName:t.pro_name,symbolType:t.type,resolution:n.interval(),layoutType:r,chartId:o,chartStyles:b.STYLE_SHORT_NAMES[n.style()],openSource:a,platform:(0,y.getPlatform)(),isExpert:window.user.declared_status===m.UserStatus.Pro})}))}),{once:!0})))}setIntervalAndLogInitiator(e,t){a.Interval.isEqual(this.interval.value(),e)||((0,p.trackIntervalChanging)(e,t),this.interval.setValue(e))}_onSearchBySymbol(e){if(!e.resolved_symbol)throw new Error("no resolved_symbol");this._selfEmit=!0,this._watchedSymbol.setValue(e.resolved_symbol),this._selfEmit=!1}_onSymbolLink(e){if(!this._selfEmit){if(!this._searchCharts){const e="No search charts defined";throw v.logError(e),new Error(e)}this._preventFeedBySymbol||this._loadSearchCharts(e)}}_loadSearchCharts(e){if(!this._searchCharts){const e="No search charts defined";throw v.logError(e),new Error(e)}if(this._searchChartsLoadDebounced)return void(this._feedBySymbolDebounceCounter<100&&(this._feedBySymbolDebounceCounter++,this._searchChartsLoadDebounced(e)));const t=e=>this._searchCharts?(!0===this._searchCharts.loadingSymbol.value()?this._feedBySymbolDebounceCounter<100&&(this._feedBySymbolDebounceCounter++,this._searchChartsLoadDebounced=(0,s.default)(t,2e3),this._searchChartsLoadDebounced(e)):this._searchChartsLoadDebounced=null,this._searchCharts.feedBySymbol.call(this._searchCharts,e)):()=>{};!0===this._searchCharts.loadingSymbol.value()?this._feedBySymbolDebounceCounter<100&&(this._feedBySymbolDebounceCounter++,this._searchChartsLoadDebounced=(0,s.default)(t,2e3),this._searchChartsLoadDebounced(e)):this._searchCharts.feedBySymbol(e)}_linkingGroup(e){let t=this._linkingGroups.get(e);if(void 0===t){const i={watchedSymbols:this._watchedSymbols,watchedSymbol:this._watchedSymbol,seriesShortSymbol:this._seriesShortSymbol,proSymbol:this._proSymbol,
ensuredProSymbol:this._ensuredProSymbol,watchedInterval:this._watchedInterval,watchedIntraday:this._watchedIntraday,watchedSeconds:this._watchedSeconds,watchedTicks:this._watchedTicks,watchedDataFrequencyResolution:this._watchedDataFrequencyResolution,watchedRange:this._watchedRange,watchedSupportedResolutions:this._watchedSupportedResolutions,watchedSupportedChartStyles:this._watchedSupportedChartStyles,symbolNamesList:this._symbolNamesList};t=new w(e,i,(()=>this._activeLinkingGroup.value())),this._linkingGroups.set(e,t),this._chartWidgetCollection&&t.bindToChartWidgetCollection(this._chartWidgetCollection)}return t}_unbindFromChartWidgetCollection(){null!==this._chartWidgetCollection&&(this._activeLinkingGroupIndex?.destroy(),this._activeLinkingGroupIndex=null,this._linkingGroups.forEach((e=>e.unbindFromChartWidgetCollection())),this._chartWidgetCollection.allLinkingGroups().unsubscribe(this._updateLinkingGroups),this._chartWidgetCollection=null)}};{const e=(0,d.getFreshInitData)().symbolInfo,t=e?e.pro_symbol:c.getValue("editchart.model.symbol",window.DEFAULT_SYMBOL);f.setSymbolAndLogInitiator(t,"initial data",!1,!0)}window.TradingViewApi||(window.TradingViewApi={linking:f})},589589:(e,t,i)=>{let s;function n(e,t){s?.(e,t)}function r(e){s=e}i.d(t,{muteLinkingGroup:()=>n,setMuteLinkingGroup:()=>r})},654049:(e,t,i)=>{i.d(t,{sparseUsersTrackingCoefficient:()=>a});var s=i(724226);const n="sparseUsersTrackingCoefficient",r=(0,i(133674).isProd)()?null:s.TVLocalStorage.getItem(n);let o=null!==r?parseFloat(r):null;null!==o&&(!Number.isFinite(o)||o<0||o>1)&&(o=null,s.TVLocalStorage.removeItem(n));const a=o??.1},934101:(e,t,i)=>{i.d(t,{trackIntervalChanging:()=>a});var s=i(276978),n=i(637581),r=i(654049);const o="IntervalChanging";function a(e,t){window.user.do_not_track||(0,s.shouldAffectUser)(o,r.sparseUsersTrackingCoefficient)&&(0,n.getTracker)().then((i=>{null!==i&&i.trackChartIntervalChanging(e,t)}))}},18107:(e,t,i)=>{i.d(t,{accumulate:()=>a,combine:()=>o,combineWithFilteredUpdate:()=>r});var s=i(654233);function n(e,t,...i){let n=null;const r=(...t)=>e(...t.map((e=>e.value())),n?.value()),o=n=new s.WatchedValue(r(...i)),a=()=>{const e=i.map(((e,t)=>e.value()));t(...e)&&o.setValue(r(...i))},l=i.map((e=>e.spawn()));for(const e of l)e.subscribe(a);return o.readonly().spawn((()=>{l.forEach((e=>e.destroy())),i.forEach((e=>e.release()))}))}function r(e,t,...i){return n(e,t,...i)}function o(e,...t){return n(e,(()=>!0),...t)}function a(e,t,...i){let n=null;const r=o(((...e)=>(e.splice(-1),e)),...i),a=t.spawn(),l=(t,...i)=>{const s=t.map((e=>e.value()));return e(s,...i,n?.value())},u=n=new s.WatchedValue(l(a.value(),...r.value()));let h=[];const c=()=>{u.setValue(l(h,...r.value()))},d=e=>{h.forEach((e=>e.destroy())),h=e.map((e=>e.spawn())),h.forEach((e=>e.subscribe(c))),c()};d(a.value()),a.subscribe(d),r.subscribe(c);return u.readonly().spawn((()=>{h.forEach((e=>e.destroy())),a.destroy(),r.destroy(),t.release()}))}},3135:(e,t,i)=>{i.d(t,{isCFDSymbol:()=>s,isStockSymbol:()=>n});function s(e,t){
return Boolean(t?.includes("cfd"))&&["commodity","futures","index","stock","fund"].includes(e)}function n(e,t){return"stock"===e&&void 0!==t&&!t.includes("cfd")&&!t.includes("ndf")}},507982:(e,t,i)=>{i.d(t,{allChartStyles:()=>r});var s=i(266150);const n=(0,i(376596).onWidget)();function r(){return function(){const e=[0,1,9,13,2,14,15,3,16,10];return e.push(12),n||e.push(17),n||e.push(18),n||e.push(20),n||e.push(19),e}().concat(function(){const e=[8];return(0,s.isFeaturesetEnabled)("japanese_chart_styles")&&(e.push(4,7,5,6),e.push(11)),e}())}},976078:(e,t,i)=>{i.d(t,{extractSymbolNameFromSymbolInfo:()=>l});var s=i(266150);const n=(0,s.isFeaturesetEnabled)("pay_attention_to_ticker_not_symbol"),r=(0,s.isFeaturesetEnabled)("charting_library_single_symbol_request"),o=(0,s.isFeaturesetEnabled)("use_ticker_on_symbol_info_update"),a=(0,s.isFeaturesetEnabled)("uppercase_instrument_names");function l(e,t,i,s){let l=e&&(i&&e.pro_name||e.full_name||e.name);return r&&t?l=t:(o||!s&&n)&&e&&e.ticker&&(l=e.ticker),a&&l&&(l=l.toUpperCase()),l}},22667:(e,t,i)=>{i.d(t,{combineProperty:()=>n});var s=i(8914);function n(e,...t){const i=()=>e(...t.map((e=>e.value()))),n=(0,s.createPrimitiveProperty)(i()),r=()=>n.setValue(i()),o={};for(const e of t)e.subscribe(o,r);return n.destroy=()=>{t.forEach((e=>e.unsubscribeAll(o))),t.forEach((e=>e.release()))},n}},960096:(e,t,i)=>{i.d(t,{combineProperty:()=>o.combineProperty,createWVFromGetterAndSubscription:()=>s.createWVFromGetterAndSubscription,createWVFromGetterAndSubscriptions:()=>n.createWVFromGetterAndSubscriptions,createWVFromProperty:()=>r.createWVFromProperty});var s=i(592893),n=i(391640),r=i(698589);i(8914);var o=i(22667)},592893:(e,t,i)=>{i.d(t,{createWVFromGetterAndSubscription:()=>n});var s=i(168509);function n(e,t){const i=new s.WatchedValue(e()),n={};t.subscribe(n,(()=>{i.setValue(e(i.value()))}));return i.readonly().spawn((()=>t.unsubscribeAll(n)))}},391640:(e,t,i)=>{i.d(t,{createWVFromGetterAndSubscriptions:()=>n});var s=i(168509);function n(e,t){const i=new s.WatchedValue(e()),n={};t.forEach((t=>t.subscribe(n,(()=>{i.setValue(e())}))));return i.readonly().spawn((()=>t.forEach((e=>e.unsubscribeAll(n)))))}},698589:(e,t,i)=>{i.d(t,{createWVFromProperty:()=>n});var s=i(592893);function n(e){return(0,s.createWVFromGetterAndSubscription)((()=>e.value()),e)}},70346:(e,t,i)=>{i.d(t,{actualSymbol:()=>pe,chartStyleStudyId:()=>U,createSeriesFormatter:()=>$,displayedSymbolExchange:()=>_e,displayedSymbolName:()=>me,extractLineToolSymbolFromSymbolInfo:()=>he,getChartStyleByResolution:()=>N,getDefaultStyle:()=>M,getLastUsedRawDataStyle:()=>x,getLastUsedSingleValueBasedStyle:()=>P,getLastUsedStyle:()=>D,getSeriesDisplayErrorWV:()=>Fe,getSeriesPriceFormattingState:()=>H,getSourceForEconomySymbol:()=>be,getSymbolDelaySeconds:()=>Be,getSymbolListedExchange:()=>Ve,getSymbolTradedExchange:()=>Ie,getTranslatedChartStyleName:()=>C,hasVolume:()=>Ce,isCloseBasedSymbol:()=>ve,isConvertedToOtherCurrency:()=>K,isConvertedToOtherMetric:()=>se,isConvertedToOtherUnit:()=>ie,isEconomicSymbol:()=>We,
isFutureContinuousSymbolWithBackajustment:()=>Le,isFuturesContractSymbol:()=>Ge,isHLCBasedStyle:()=>R,isMeasureUnitSymbol:()=>we,isMetricActive:()=>ne,isPriceSourceStyle:()=>O,isRangeBasedStyle:()=>k,isRangeStyle:()=>I,isRawDataStyle:()=>E,isRegularSessionId:()=>ge,isRequiringRestartSeriesStyles:()=>W,isSingleValueBasedStyle:()=>B,isSpreadSymbolWithManyLegs:()=>ke,isStyleSupportedForReplay:()=>G,isTimeBasedStyle:()=>L,isValidStyle:()=>F,measureUnitId:()=>fe,preparePriceAxisProperties:()=>q,proSymbol:()=>Se,setLastUsedRawDataStyle:()=>A,setLastUsedStyle:()=>T,styleChangeRequiresRestart:()=>V,symbolBaseCurrency:()=>J,symbolCurrency:()=>z,symbolCurrencyConvertible:()=>j,symbolHasEconomicEvents:()=>ue,symbolHasElectronicSession:()=>ae,symbolHasPreOrPostMarket:()=>oe,symbolHasSeveralSessions:()=>le,symbolMetric:()=>ee,symbolOriginalCurrency:()=>Y,symbolOriginalMetric:()=>te,symbolOriginalUnit:()=>Z,symbolTitle:()=>ye,symbolTitleSeparator:()=>de,symbolToSaveInState:()=>ce,symbolUnit:()=>X,symbolUnitConvertibleGroupsIfExist:()=>re});var s=i(729193),n=i(266150),r=i(950808),o=i(376596),a=i(298147),l=i(599730),u=i(357966),h=i(605434),c=i(760823),d=i(594461),b=i(3135),y=i(18107),m=i(960096),_=i(976078);const p=(0,n.isFeaturesetEnabled)("uppercase_instrument_names"),S=(0,n.isFeaturesetEnabled)("hide_object_tree_and_price_scale_exchange_label"),g=[4,5,6,7,8],v=[4,5,6,7,11],w=[0,1,9,19,2,14,15,3,16,21,10,8,12,13,18,17,20],f=[2,14,15,10,3,13,18];function C(e){return{0:s.t(null,void 0,i(125962)),1:s.t(null,void 0,i(918e3)),2:s.t(null,void 0,i(527912)),14:s.t(null,void 0,i(23222)),15:s.t(null,void 0,i(253759)),3:s.t(null,void 0,i(845086)),16:s.t(null,void 0,i(178424)),9:s.t(null,void 0,i(596829)),10:s.t(null,void 0,i(665782)),12:s.t(null,void 0,i(154183)),13:s.t(null,void 0,i(162639)),4:s.t(null,void 0,i(88999)),7:s.t(null,void 0,i(549219)),5:s.t(null,void 0,i(909224)),6:s.t(null,void 0,i(188528)),11:s.t(null,void 0,i(990213)),8:s.t(null,void 0,i(748182)),17:s.t(null,void 0,i(487242)),18:s.t(null,void 0,i(982423)),19:s.t(null,void 0,i(452541)),20:s.t(null,void 0,i(186296)),21:s.t(null,void 0,i(239093))}[e]}function W(e){return-1!==g.indexOf(e)}function k(e){return-1!==v.indexOf(e)}function V(e,t){return!I(e)&&!I(t)&&!(e===t||!W(e)&&!W(t))}function I(e){return 11===e}function L(e){return-1!==w.indexOf(e)}function G(e){return 17!==e&&18!==e&&20!==e&&L(e)}function F(e){return k(e)||L(e)}function B(e){switch(e){case 3:case 10:case 2:case 14:case 15:case 13:return!0;default:return!1}}function R(e){switch(e){case 16:case 21:return!0;default:return!1}}function E(e){return!l.SYMBOL_STRING_DATA[e]}function T(e,t){F(e)&&(11!==e&&r.setValue("chart.lastUsedStyle",e),E(e)&&A(e),ve(t)&&B(e)&&r.setValue("chart.lastUsedSingleValueBasedStyle",e))}function A(e){r.setValue("chart.rawDataStyle",e)}function D(){const e=r.getInt("chart.lastUsedStyle");return void 0===e?1:e}function P(){const e=r.getInt("chart.lastUsedSingleValueBasedStyle");return void 0===e?14:e}function x(){return r.getInt("chart.rawDataStyle",1)}function M(e){return e?11:1}
function N(e,t){const i=I(t),s=u.Interval.isRange(e);return!i&&s?M(!0):i&&!s?M(!1):t}function U(e,t,i){const s=l.SYMBOL_STRING_DATA[e];if(void 0===s)return null;const n=(0,l.isChartStyleStudyInfoComplex)(s)?s.selector(i??{}):s;return t?`${n.type}-${n.basicStudyVersion}`:n.type}function q(e){const t=e.priceAxisProperties,i=t.lockScale.value(),s=6===e.style.value();(s||i)&&(t.log.setValue(!1),t.percentage.setValue(!1)),t.logDisabled.setValue(!(!s&&!i)),t.percentageDisabled.setValue(!(!s&&!i))}function O(e){return f.includes(e)}function H(e,t="default",i=!1){let s,n,r,o,a=100,l=1;if("default"===t)null!=e&&(({pricescale:a,minmov:l,minmove2:n,fractional:s}=e),r=e.variable_tick_size||void 0);else{let e=t.split(",");3!==e.length&&(e=["100","1","false"]),a=parseInt(e[0]),l=parseInt(e[1]),s="true"===e[2],o=!0}return i&&(l=1),{priceScale:a,minMove:l,fractional:s,minMove2:n,variableMinTick:r,ignoreMinMove:i,noExponentialForm:o}}function $(e,t,i=!1){const{priceScale:s,minMove:n,fractional:r,minMove2:o,variableMinTick:a,noExponentialForm:l}=H(e,t,i);if(null!=e){const l=e.format;if("default"===t&&"volume"===l)return new c.VolumeFormatter({precision:2});if("percent"===l)return new d.PercentageFormatter({priceScale:s,minMove:n,fractional:r,minMove2:o,variableMinTick:a,ignoreMinMove:i})}return new h.PriceFormatter({priceScale:s,minMove:n,fractional:r,minMove2:o,variableMinTick:a,ignoreMinMove:i,noExponentialForm:l})}function j(e){return null!==e&&!(0,a.isSpread)(e.type)}function z(e,t,i){if(null===e)return null;const s=!t||i?e.currency_id:e.currency_code;return void 0===s||""===s||"pct"===s?null:s}function Y(e,t){const i=t?e.original_currency_code:e.original_currency_id;return"pct"===i?null:i??z(e,t)}function J(e){return e.base_currency_id||null}function K(e){if(null===e||!j(e))return!1;const t=Y(e);return null!==t&&t!==z(e)}function Q(e,t){return t&&null!==e&&!(0,a.isSpread)(e.type)}function X(e,t){if(null===e||!t)return null;const i=e.unit_id;return void 0===i||""===i?null:i}function Z(e,t){return t?e.original_unit_id||X(e,t):null}function ee(e,t){return t&&e.metrics?.current||null}function te(e,t){return t?e.metrics?.default||ee(e,t):null}function ie(e,t){return!(null===e||!Q(e,t))&&(void 0!==e.original_unit_id&&e.original_unit_id!==e.unit_id)}function se(e,t){return!(null===e||!t)&&(void 0!==e?.metrics?.default&&e?.metrics?.default!==e?.metrics?.current)}function ne(e){return Boolean(e?.metrics?.current&&"price"!==e.metrics.current)}function re(e,t){return null!==e&&Q(e,t)?e.unit_conversion_types||null:[]}function oe(e){return null!==e&&void 0!==e.subsessions&&e.subsessions.some((e=>"premarket"===e.id||"postmarket"===e.id))}function ae(e){return null!==e&&void 0!==e.subsessions&&(e.subsessions.some((e=>"regular"===e.id))&&e.subsessions.some((e=>"us_regular"===e.id)))}function le(e){return null!==e&&void 0!==e.subsessions&&e.subsessions.filter((e=>!e.private)).length>1}function ue(e){return null!==e&&((0,a.isForexSymbol)(e.type)||(0,b.isCFDSymbol)(e.type,e.typespecs)||(0,a.hasCryptoTypespec)(e.typespecs||[]))}function he(e,t){
return(0,_.extractSymbolNameFromSymbolInfo)(e,null,!0,!0)||t}function ce(e,t){return e?e.ticker??e.pro_name??t:t}const de="Â·";function be(e,t){return We(e)?e.source2?.description??null:null}function ye(e,t){const i=Ve(e);return t||S?e.name:`${e.name} ${de} ${i}`}function me(e){let t=e&&(function(e){return(0,a.isFutures)(e.type)&&e.front_contract||null}(e)||e.name)||"";return t.length>40&&(t=t.substring(0,37)+"..."),t.trim()}function _e(e){const t=e?e.exchange:"";return p?t.toUpperCase():t}function pe(e,t){return null!==e?e.full_name:t}function Se(e,t){return e?.pro_name??t}function ge(e,t){return["stock","fund","index","dr"].includes(t.type)&&"regular"===e||(0,a.isFutures)(t.type)&&"us_regular"===e}function ve(e){return"c"===e?.visible_plots_set}function we(e){return null!==e&&("unit"===e.measure&&null!==fe(e))}function fe(e){return e?.value_unit_id??null}function Ce(e){return"ohlcv"===e.visible_plots_set}function We(e){return null!==e&&(0,a.isEconomicSymbol)(e.type)}function ke(e){return function(e){return null!==e&&(0,a.isSpread)(e.type)}(e)&&(e?.legs??[]).length>1}function Ve(e){const t=be(e);if(null!==t)return t;return(0,o.onWidget)()||(0,a.isForexSymbol)(e.type)?e.exchange:e.exchange_listed_name??e.exchange}function Ie(e){return e.exchange}function Le(e){return null!==e&&(0,a.isFutures)(e.type)&&Boolean(e.has_backadjustment&&e.typespecs?.includes("continuous"))}function Ge(e){return null!==e&&(0,a.isFutures)(e.type)&&!Boolean(e.typespecs?.includes("continuous"))}function Fe(e){return(0,y.combine)(((t,i,s)=>{switch(t){case 4:{const t=e.seriesErrorMessage();return null!==t&&("resolution_not_entitled"===t||"custom_resolution"===t||"seconds_not_entitled"===t||"ticks_not_entitled"===t||t.startsWith("study_not_auth:"))?null:{type:"invalid_symbol"}}case 13:{const t=e.seriesErrorMessage();return null===t?null:{type:"calculations_error",errorMessage:t}}case 14:{const t=e.unsupportedResolutionState().value();return null===t?null:{type:"unsupported_resolution",reason:t.reason}}case 1:case 2:return null;default:if(i&&null!==s)return s?{type:"ipo_priced"}:{type:"no_data"}}return null}),e.statusWV().weakReference(),(0,m.createWVFromGetterAndSubscription)((()=>!e.bars().size()&&!e.nsBars().size()&&!e.isInReplay().value()),e.dataEvents().dataUpdated()).ownership(),(0,y.combine)(((e,t)=>t?"priced"===e?.ipo_offer_status:null),e.quotesProvider().quotes().weakReference(),e.quotesProvider().completed().weakReference()).ownership())}function Be(e){return Math.max(0,e?.delay??0)}}}]);